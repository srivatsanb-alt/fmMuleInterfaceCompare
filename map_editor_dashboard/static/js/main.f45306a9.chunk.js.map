{"version":3,"sources":["images/ati-logo.png","icons/person.svg","icons/gear.svg","icons/arrow-clockwise.svg","icons/arrow-counter-clockwise.svg","icons/icon-move.svg","icons/station.svg","icons/arrow-down.svg","components/remote-drive/icons/arrow.svg","resources/webui_map.png","common/ProfileButton.tsx","reducers/navReducer.tsx","common/AdminToolsButton.tsx","conf.tsx","components/dashboard/utilities/Constants.tsx","../../node_modules/tslib/tslib.es6.js","../../node_modules/style-inject/dist/style-inject.es.js","../../src/common/icons/Cancel.tsx","../../src/AlertComponent/icons/Warning.tsx","../../src/AlertComponent/icons/Danger.tsx","../../src/AlertComponent/icons/Info.tsx","../../src/AlertComponent/icons/Check.tsx","../../src/AlertComponent/sounds/success.wav","../../src/AlertComponent/sounds/info.wav","../../src/AlertComponent/sounds/warning.wav","../../src/AlertComponent/sounds/error.wav","../../src/AlertComponent/sounds/normal.wav","../../src/AlertComponent/AlertComponent.tsx","../../src/Spinners/Spinners.tsx","../../src/ButtonComponent/ButtonComponent.tsx","../../src/CardComponent/CardComponent.tsx","../../src/FormComponent/FormComponent.tsx","../../src/ModalComponent/ModalComponent.tsx","../../src/StripsComponent/StripsComponent.tsx","../../src/AxiosUtility/AxiosUtility.tsx","../../src/InputComponent/icons/Eye.tsx","../../src/InputComponent/icons/EyeSlash.tsx","../../src/InputComponent/InputComponent.tsx","../../src/ProgressComponent/ProgressComponent.tsx","common/Navbar.tsx","components/map-editor/map-editor-components/generate_smooth_path.js","components/map-editor/map-editor-components/utils.js","components/map-editor/map-editor-components/planner.js","utilities/genericFunctions.js","components/map-editor/map-editor-components/make_route.js","components/map-editor/map-editor-components/parse.js","components/map-editor/map-editor-components/calculate_curvature.js","components/map-editor/map-editor-components/check_valid_route_curva.js","components/map-editor/MapUtilities.js","components/map-editor/AlignMap.js","components/map-editor/RouteUtilities.js","components/map-editor/AddStations.js","common/constants.tsx","components/map-editor/map-editor-components/adjust_velocity_turn.js","components/map-editor/utils.tsx","components/map-editor/map-editor-components/calculate_inplace.js","components/map-editor/AddRoutes.js","components/map-editor/MapEditor.js","components/map-editor/MapEditorAPI.tsx","components/webctl/WebctlStationSelector.tsx","components/webctl/Webctl.tsx","components/remote-drive/VideoFeed.tsx","components/remote-drive/Joystick.tsx","components/remote-drive/LidarView.tsx","components/remote-drive/RemoteDrive.tsx","components/map-creator/MapCreator.tsx","components/map-editor/icons/Directory.tsx","components/map-editor/MapList.tsx","components/DeploymentUINavigation.tsx","components/login/DeploymentUILogin.tsx","components/login/AuthenticateRoute.tsx","components/map-editor/MapEditorFileUpload.js","App.tsx","serviceWorker.ts","reducers/stationInfoReducer.tsx","reducers/userReducer.tsx","reducers/confReducer.tsx","reducers/roleReducer.tsx","reducers/functionReducer.tsx","reducers/currentUserReducer.tsx","reducers/userFunctionReducer.tsx","reducers/rootReducer.tsx","components/map-creator/mocks/handlers.ts","components/webctl/tests/mocks/handlers.ts","resources/webui_map_vh.tsx","components/map-editor/mocks/handlers.ts","components/login/mocks/handlers.ts","index.tsx"],"names":["module","exports","ProfileButton","slice","createSlice","name","initialState","current_nav","to_show_sidebar","reducers","set_nav_state","state","action","console","log","payload","set_to_show_sidebar","actions","AdminToolsButton","api_url","window","location","hostname","protocol","AXIOS_HEADER","Authorization","localStorage","getItem","Accept","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","Cancel","color","className","rest","xmlns","width","height","fill","viewBox","d","Warning","Danger","Info","Check","AlertStore","Provider","success_alert","src","success_sound","info_alert","info_sound","warning_alert","warning_sound","error_alert","error_sound","normal_alert","normal_sound","children","alerts","callback","id","rest_payload","new_alerts","il","r","Array","k","a","j","jl","status","play","filter","alert","Error","dispatch","dispatch_add_alert","dispatch_remove_alert","key","store_memoized","useMemo","dispatch_event_memoized","add_alert","message","time","on_click","on_cancel","uuidv4","setTimeout","alerts_array","map","index","onClick","target","currentTarget","dataset","add_icon","pulse_spinner","AtiButton","props","loading","showLoadingAnimation","rows","ready","AtiForm","on_submit","inputs","utilities","warning","form_state","set_form_state","set_loading","is_mounted","current","on_change","persist","autoComplete","onSubmit","preventDefault","each_input","str_var","capitalize","lowerCase","String","onChange","required","show_inputs","useAtimodal","show","set_show","hide_modal","default_headers","url","method","headers","on_error","on_success","request_headers","request_body","request_method","with_credentials","defaults","withCredentials","axios_config","data","response","EyeSlash","TextInput","onError","minLength","maxLength","regex","password_show","set_password_show","toggle_password","validate_using_regex","str","test","event","Eye","options","option","prepare_options","progress","Navbar","history","useHistory","useAlerts","useState","show_navbar","set_show_navbar","useLocation","useEffect","pathname","useFetch","err","removeItem","logout_user","nav_links_data","link","alt","Logo","nav_link","idx","activeClassName","exact","to","get_point_at_length","point","direction","dist","c","Matrix","mul","add","dir_norm","line1","line2","diff","sub","div","norm","generate_smooth_path","wps","p1","p2","p3","new_wps","clone","n_rows","getRowVector","removeRow","addRow","np_abs","arr","Math","abs","np_diff","arr_length","return_arr","np_array_mul","b","element","np_array_exponential","exp","turn","u1","u2","rx","ry","temp_x","temp_y","pathres","p1m","columnVector","p2m","ts","theta_mat","_compute_theta","theta_cos","cos","theta_sin","sin","pathm","cumulativeSum","get","size","parseFloat","N","round","theta2","atan2","theta1","PI","theta","_turn_theta","theta_m","alpha","beta","start_value","stop_value","x","temp","pow","round_decimal","array","prec","toFixed","convert_to_radians","angle","precision","give_straight","path","to1DArray","give_turn","score_thresh","total","np_sum","_get_turn_speed_index","make_route","info","route","parse","concat","error","_get_path_curvature","xp","yp","xd","yd","xd2","yd2","nr","np_array_sub","dr","np_array_sum","get_p1_u1_p2_u2","r_p0","r_p1","r_p2","r_p3","current_selected_turn","check_curve_threshold","px","py","threshold","curva","max_curva","max","shift_coord_update_pos","offset_x","offset_y","rotate_point","check_if_point_in_on_the_line","x1","y1","x2","y2","point_on_line","distance_p1_p2","distance_between","distance_p_p1","distance_p_p2","sqrt","show_hide_selector_line","route_ref","route_id","values","forEach","line","hide","AlignMap","ROTATE_STEP_SIZE","useRef","image_loaded","set_image_loaded","map_angle","set_map_angle","imageObj","Image","set_map_angle_input","map_image","rotation","isMounted","pivot_image","onload","enabled","keys","icon_list","draggable","stage","station_coord","pivot_ref","Konva","image","offset","dragBoundFunc","pos","new_y","new_x","stage_width","stage_height","on","attrs","pivot","draw_pivot","layer","draw","change_pivot","destroy","change_step_size","adjust_map_position","map_cord","batchDraw","compute_map_corner_pos","anti_clockwise","tmp","rotate_map","rotate","update_icon_pos","redraw_all_routes","circle_hide_tool_tip","grid_state","clear_grid","draw_grid","reset_zindex","set_map_image_rotation","step_size","absolute_angle","placeholder","title","arrowClockwise","arrowCounterClockwise","remove_node_id_references","tmp_route_details","node_ref","tmp_node_details","node_id","parseInt","node","splice","get_connected_post_process_points","node_id_removed","post_process_points","connected_node_found","some","post_process","remove_connected_post_process_points","pp_points","AddStations","circle","icon_group","map_x","set_x","map_y","set_y","current_id_ref","set_current_station_id","name_input_ref","edit_name_warning","edit_name_input_ref","edit_angle_input_ref","post_process_ref","edit_station_tags_ref","inplace_input_ref","charging_input_ref","hide_station_ref","inplace_clockwise_ref","mode","mode_state","set_mode_state","edit_mode","image_on_click","station_image","draw_saved_stations","reset_map_scale","off","enable_disable_station_event_listeners","unhighlight_stations","reset_selection","is_station_selected","set_inputs","icon_name","text","update_station_angle_name_charging","enable","add_event_listeners_to_stations","remove_event_listeners_to_stations","undefined","station_name_exists","station_name_length_check","stageLocation","getStage","getPointerPosition","station_id","add_station","innerHTML","station_tags","toString","station","circle_on_tap_dragstart","station_on_drag","reset_tmp_route_node_path","Boolean","station_angle_input_value","new_id","station_id_list","get_new_station_id","group","Group","Circle","radius","opacity","Text","Y_OFFSET_NAME","fontSize","fontFamily","listening","get_untransformed_coordinates","x_untrans","y_untrans","inplace","checked","clockwise","charging","hidden","inplace_clockwise_button_status","set_x_y","set_current_id","highlight_stations","add_tooltip_event_listener_to","draw_station","x_pix","y_pix","get_map_coordinate","update_inputs_in_edit_mode","update_x_y","get_transformed_coordinates","x_trans","y_trans","update_inplace_input","redraw_route_on_drag","from_station","to_station","load_temp_route","draw_route","save_temp_route","update_tooltip","remove_station_post_process_points","route_details","node_list","node_details","first_node","last_node","post_process_id","inplace_change_handler","charging_station_change_handler","change_station_hide_handler","inplace_clockwise_handler","x_map","y_map","exists","name_on_change","hide_inputs_if_name","update_name_on_change_classname","class_name","inner_html","edit_station_coordinates","x_value","y_value","edit_station_coordinates_x_y_draw","post_process_handler","x_coord","y_coord","get_pixel_coordinate","x_transform","y_transform","station_x_y","post_process_required","defaultChecked","station_rotation_direction","inplace_rotation_button_text","get_name_by_id","get_rotation_by_id","get_station_tags_by_id","edit_station_name_on_focus","edit_station_name","station_theta","min","onFocus","delete_station","delete_path","tooltip","switch_edit_mode_button","onKeyUp","add_stations_tab","rad_to_deg","adjust_velocity_slight_turns","routes","max_yaw_change","new_routes","mod_p","yaw1","yaw2","check_webui_json_file","reader_result","maps","scale","origin","map_name","check_waypoints_map_editor","map_editor","object","isArray","check_array","entries","check_object","object_num","Number","isFinite","num_value","num","normalize_angle","calculate_inplace","line_point","path_direction","start","line_vec","val","path_angle","station_angle_rad","inplace_angle","add_offset","AddRoutes","station_1","set_station_1","station_2","set_station_2","is_station_2_selected","route_mode","set_route_mode","set_path","set_radius","input_to_selected","set_input_selected","selected_route_id","download_button_ref","to_station_id","from_station_id","test_line","webui_stations_data","DownloadModal","show_download_modal","hide_download_modal","download_option","webui_map_json","stations_csv","stations_attributes_json","waypoints_json","station_attributes_maping","current_alert_id_ref","trip_type_ref","current_trip_type","trip_type","remove_line_and_image_event_listener","add_delete_mode","remove_node_delete_event_handler","remove_event_listeners_of_line_not_selected","attach_add_node_event_listener","attach_node_delete_event_listeners","get_node_id_index","reset_post_process_pos","add_node_event_listener","node_index","get_node_index","connecting_node_id","overlap","req_node_idx","cp_x_y","tmp_cp_details","remove_control_points","remove_invalid_turns","set_current_route_invalid","check_valid_route","attach_event_listener_after_draw_route","set_add_delete_mode","invalid","new_line","route_selected","highlight_current_line","target_on_click","icon","station_selected","station_name","highlight_to_input","is_from_to_inputs_valid","is_valid","route_toggle_ref","edit_complete","reset_station_selection","turnoff_route_selected_events","saved_route_loaded","route_toggle_button_on","route_toggle_button_ref","display","route_editor","route_points","node_idx","post_process_count","points_to_add","candidate_index","new_node_indexes","insert_pos","Infinity","get_valid_index","floor","is_route_selected","node_index_object","temp_node_index","temp_distance","node_index_to_return","dist_diff","draw_node","on_line","get_id","tmp_circle","get_circle","tmp_station_name","is_from_to_selected","add_node","redraw_route","reattach_event_listeners_after_add_node","check_route","current_from","current_to","route_from","route_to","already_a_route","from","is_route_already_present","draw_return_route","ref_route","nodes","draw_straight_route","ref_node","add_route","route_select_dropdown","route_selection_handler","remove_current_route_node_icon","unhighlight_current_line","stroke","strokeWidth","reset_unsaved_route","cloneDeep","reference_route_ref","invalid_route","reset_station_inputs","get_route_id","set_route_added","add_nodes_to_route","draw_control_points","node_ref_clone","node_ref_temp_save","remove_invalid","node_detail","remove_node_redraw_route","add_node_at_x_y","pp_added","check_route_post_process","add_route_input_selected","utils","get_common_dispatch_station","common_dispatch_station","every","get_empty_trolley_station","empty_trolley_station","current_dispatch_station","current_empty_trolley_station","textAlign","defaultValue","disabled","set_common_dispatch_station","set_empty_trolley_station","download_button","download_files_popup","update_download_files_state","file","checkbox_inputs","file_type","data-file","download","generate_stations_csv_file","download_file","JSON","stringify","generate_station_attributes_data","generate_webui_map_json_stations","generate_waypoints_file","disable","download_files","invalid_routes_list","check_routes","radius_change_handler","path_type","edit_route_div","edit_route_display","background","readOnly","arrow_down","delete_existing_route_div","stations","confirm","remove_path_event_listeners","delete_path_event_callback","station_attributes","maps_object","file_name","viewbox","station_value","is_charging","split","station_object","station_tags_mod","replace","webui_json_object","0","station_key","station_info","generate_waypoints_data","map_route_wps","route_info","wps_matrix","gen_path","route_array","route_segment","post_process_added","route_station_id","route_data","route_segment_data","get_route_segments","start_inplace","segment_idx","end_inplace","station_data","tx_st_data","route_info_to_save","new_route_ref","item","station_coord_to_save","node_ref_to_save","waypoints_stations_data","new_waypoints_stations_object","web_key","map_data","ver","filename","Blob","href","URL","createObjectURL","click","switch_button","join","add_route_content","MapEditor","mule_image","pan_offset","angle_offset","map_scale","cp_ref","stage_ruler","current_tab","set_current_tab","map_div_ref","grid_group_lines","grid_group_texts","grid_on_off","set_grid_on_off","layer_ruler","count","reference_route_copy_ref","invalid_route_ref","drawn_invalid_route_ref","zooming","get_current_x_y","preprocess_v1","map_editor_data","x_dashed","y_dashed","map_corner","preprocess_v2","load_routes_and_stations_data","preprocess_map_editor_data","map_rotation","route_ids","copy_tmp_cp_master_cp","Stage","container","offsetWidth","offsetHeight","Layer","map_image_show_tooltip","enable_pan_map_image","enable_map_zoom","waypoints_data","load_map","round_step","scaleX","on_image","set_tooltip_direction","save_node_references","key_node","load_node_references","node_object","update_node_pos","tmp_route_details_copy","tmp_node_details_copy","tmp_cp_details_copy","route_id_tmp","line_tmp","redraw_all","line_drawn","points","prepare_line_points","pointerWidth","pointerHeight","pointerDirection","draw_grid_line_and_text","draw_line","stroke_width","vertical","tan","grid_line","Line","lineCap","text_value_to_show","get_untransformed_map_coordinates","ruler_x_width","ruler_y_width","align","padding","drawBorder","y_span","x_span","y_start","x_start","draw_lines","new_x_corner","new_y_corner","clear_lines","child","clear_draw_grid","initialize_tooltip","Label","Tag","lineJoin","set_tooltip_text","show_tool_tip","set_tooltip_x_y","circle_show_tool_tip","stage_x","stage_y","outer_circle","x_pos","y_pos","no_of_coord","update_ref_route","invalid_turn","Arrow","dashEnabled","dash","tension","draw_transparent_line","line_group","show_all_routes_pan_zoom","hide_all_routes_pan_zoom","delete_all_routes","throttle","evt","old_scale","pointer","mouse_point_to","new_scale","deltaY","newPos","position","debounce","update_map_corner_pos","clear_tmp","tmp_cp","from_station_coord","to_station_coord","invalid_points","invalid_routes","invalid_trans_point","tmp_x","tmp_y","check_valid_route_curva","draw_invalid_turns","update_station_panned_pos","update_node_pan_pos","load_master_route_tmp_route","load_master_node_tmp_node","load_master_cp_tmp_cp","iterate_array_get_transformed_coordinates","map_coord_array","transformed_array","pixel_coordinates","transformed_coordinates","prepare_route_line_points","map_coordinates_points_array","route_radius","points_array","mat_points","smooth_path","flatten","to2DArray","invalid_line","show_control_points","copy_tmp_route_master_route","highlight_circle","strokeEnabled","remove_line_and_nodes","control_point","route_exception_id","details","moveToTop","each_cp","each_node","parent","tabs","change_current_tab","allign_map_component","route_toggle_button","route_toggle_button_off","backgroundColor","tab_button","route_component","current_tab_content","MapEditorAPI","map_editor_load","set_map_editor_load","set_image","set_data","set_waypoints_data","useParams","fetch_files","webui_map_image","waypoints","load_map_editor","rect_shape_placeholder","minWidth","text_placeholder","WebctlStationSelector","select_station_and_set_status","set_stations","fetch_stations","stations_loading","data-testid","stations_list","data-id","data-type","station_button","show_stations","status_placeholder","Webctl","sherpa_status","set_sherpa_status","StationModal","show_station_modal","hide_station_modal","set_mode","spinner_div","fetch_initial_mode","on_fetch_mode_success","initial_mode_loading","remote_post","remote_loading","dual_shock_post","dual_shock_loading","shutdown_post","shutdown_loading","args","select_station","auto_button_loading","status_button_onclick","VideoFeed","video_feed","video_ref","video","srcObject","autoPlay","playsInline","Joystick","set_direction","joystick_ref","joystick_layer","outlines_layer","buttons_layer","direction_ref","buttons_ref","keys_pressed","arrow_image","update_buttons_highlight","button","set_direction_vector_from_direction","joystick_container","arrow","ctx","center_x","center_y","outer_circle_radius","outest_radius","buttons","icon_rotation","angle_rad","each_angle","each_segment","each_angle_rad","icon_angle_rad","icon_radius","icon_x","icon_y","closed","draw_buttons","c_x","c_y","angle_deg","draw_joystick","inner_circle","outest_circle","draw_center_and_outer_circle","addEventListener","keyCode","repeat","keys_pressed_object","LidarView","RemoteDrive","velocity","set_velocity","set_video_feed","spectator","set_spectator","data_channel_ref","connect_websocket","socket","WebSocket","binaryType","onopen","onerror","start_video","signaling","peer_connection","RTCPeerConnection","sdpSemantics","iceServers","urls","track","kind","streams","addTransceiver","onicecandidate","candidate","send","message_type","content","RTCIceCandidate","addIceCandidate","setRemoteDescription","data_channel","createDataChannel","createOffer","offer","setLocalDescription","data_channel_curr","async_func","readyState","Float32Array","buffer","MapCreator","map_dir_options","set_map_dir_options","show_progress","set_show_progress","show_reroute","set_show_reroute","set_err","progress_data","map_id","dirs","fetch_dirs","dirs_loading","fetch_progress","post_map_creator_data","post_loading","func","progress_polling","handle_onchange","create_map_dir_select_options","dir","data-key","Directory","dimension","directoryName","MapList","directories","set_directories","fetch_directories","DeploymentUINavigation","match","Login","setItem","post_user","user_loading","request_object","AuthenticateRoute","Component","token","render","routeProps","MapEditorFileUpload","valid","set_valid","set_load_map_editor","individual_file_upload","set_individual_file_upload","check_map_valid","handleFileJSONChange","reader","FileReader","readAsText","handleFileWaypointsJSONChange","check_reader_result","handleFileImageChange","readAsDataURL","upload_multiple_files","files","file_extension","accept","cursor","webkitdirectory","mozdirectory","directory","to_render","App","set_station_info","users","set_users_state","users_object","delete_user","deleted_user_id","add_user","addedUser","user_object","update_user","updatedUser","userId","user_info","updatedUserInfo","user_roles","roles","set_conf_state","set_roles_state","roles_object","delete_role","deleted_role_id","add_role","addedRole","role_object","update_role","updatedRole","roleId","role_info","updatedRoleInfo","role_functions","functions","set_functions_state","set_current_users_state","user_function_list","rootReducer","combineReducers","stationInfoReducer","confReducer","usersReducer","rolesReducer","functionsReducer","currentUserReducer","userFunctionReducer","navReducer","post","req","res","delay","json","mule_data","uid","battery_percentage","error_zones","obstacle_zones","isStarting","isCharging","webui_map","user","createStore","ReactDOM","getElementById","navigator","serviceWorker","registration","unregister","catch"],"mappings":"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","file":"static/js/main.f45306a9.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/ati-logo.df8b7ac6.png\";","module.exports = __webpack_public_path__ + \"static/media/person.9ede6360.svg\";","module.exports = __webpack_public_path__ + \"static/media/gear.0444aa22.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow-clockwise.01f21af9.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow-counter-clockwise.75ffb11b.svg\";","module.exports = __webpack_public_path__ + \"static/media/icon-move.9064ef70.svg\";","module.exports = __webpack_public_path__ + \"static/media/station.dcd3b9f0.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow-down.3d5e35e3.svg\";","module.exports = __webpack_public_path__ + \"static/media/arrow.6990715c.svg\";","module.exports = __webpack_public_path__ + \"static/media/webui_map.bdd14664.png\";","import React from \"react\";\nimport logo from \"../icons/person.svg\";\n\nfunction ProfileButton() {\n  return <img className=\"utility-icon\" alt=\"utility-icon\" src={String(logo)}></img>;\n}\n\nexport default ProfileButton;\n","import { createSlice } from \"@reduxjs/toolkit\";\nconst default_nav_state = {\n  current_nav: \"dashboard\",\n  to_show_sidebar: false,\n};\n\nconst slice = createSlice({\n  name: \"navReducer\",\n  initialState: default_nav_state,\n  reducers: {\n    set_nav_state: (state, action) => {\n      console.log(\"action.payload\", action.payload);\n      state.current_nav = action.payload;\n    },\n    set_to_show_sidebar: (state, action) => {\n      console.log(\"set_to_show_sidebar\", action.payload);\n      state.to_show_sidebar = action.payload;\n    },\n  },\n});\n\nexport const { set_nav_state, set_to_show_sidebar } = slice.actions;\nexport const getNavData = (state) => state.navReducer;\nexport default slice.reducer;\n","import React from \"react\";\nimport logo from \"../icons/gear.svg\";\nimport { useDispatch } from \"react-redux\";\nimport { set_to_show_sidebar } from \"../reducers/navReducer\";\n\nfunction AdminToolsButton() {\n  const dispatch = useDispatch();\n  const toggle_sidebar = () => {\n    dispatch(set_to_show_sidebar(true));\n  };\n  return <img onClick={toggle_sidebar} className=\"utility-icon\" alt=\"utility-icon\" src={String(logo)} />;\n}\n\nexport default AdminToolsButton;\n","export let api_url = `http://${window.location.hostname}:5000`;\nexport let ws_url = `ws://${window.location.hostname}:5000`;\nexport let sio_url = `http://${window.location.hostname}:8075`;\nif (process.env.NODE_ENV === \"production\") {\n  const is_https = window.location.protocol === \"https:\";\n  if (is_https) {\n    api_url = `/api`;\n    ws_url = `wss://${window.location.hostname}:443/api/`;\n    sio_url = `wss://${window.location.hostname}:443`;\n  } else {\n    api_url = `http://${window.location.hostname}/api`;\n    ws_url = `ws://${window.location.hostname}/api/`;\n    sio_url = `ws://${window.location.hostname}`;\n  }\n}\n","export const AXIOS_HEADER = () =>  \n     { return {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n            \"Content-Type\": \"application/json\",\n            Accept: \"*/*\",\n        }\n    }\nexport const BATTERY_THRESHOLD = 20;\nexport const FUNCTIONS = {\n    ROLE_ADMIN:0,\n    READ_ROLE:6,\n    READ_USER:10,\n    CREATE_SCHEDULE:17,\n    READ_SCHEDULE:18,\n    UPDATE_SCHEDULE:19,\n    READ_MAP:26,\n    UPDATE_MULE:15,\n}","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React from \"react\";\n\nexport default function Cancel({\n  color = \"currentColor\",\n  className = \"\",\n  ...rest\n}) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n      className={`bi bi-x ${className && className}`}\n    >\n      <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />\n    </svg>\n  );\n}\n","import React from \"react\";\n\nexport default function Warning({\n  color = \"currentColor\",\n  className,\n  ...rest\n}) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n      className={`bi bi-exclamation-triangle ${className && className}`}\n    >\n      <path d=\"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z\" />\n      <path d=\"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z\" />\n    </svg>\n  );\n}\n","import React from \"react\";\n\nexport default function Danger({ color = \"currentColor\", className, ...rest }) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n      className={`bi bi-check-square ${className && className}`}\n    >\n      <path d=\"M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z\" />\n      <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />\n    </svg>\n  );\n}\n","import React from \"react\";\n\nexport default function Info({ color = \"currentColor\", className, ...rest }) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n      className={`bi bi-info-square ${className && className}`}\n    >\n      <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\" />\n      <path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\" />\n    </svg>\n  );\n}\n","import React from \"react\";\n\nexport default function Check({ color = \"currentColor\", className, ...rest }) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n      className={`bi bi-check-square ${className && className}`}\n    >\n      <path d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z\" />\n      <path d=\"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z\" />\n    </svg>\n  );\n}\n","export default \"assets/files/success-cb875012169b942931f25db283cb384b.wav\"","export default \"assets/files/info-93f7468c9b28221ca04245e61f337c51.wav\"","export default \"assets/files/warning-ad90b6f80ed25faa280afe1ed443151f.wav\"","export default \"assets/files/error-03792dc44aca6c771a5489e1e4578077.wav\"","export default \"assets/files/normal-3b45f51763c4d64be3c839218987da3d.wav\"","import React, { createContext, useReducer, useContext, useMemo } from \"react\";\nimport {\n  Alert,\n  InitialState,\n  AddAlert,\n  Action,\n  Reducer,\n  ContextType,\n} from \"./AlertComponent.types\";\nimport \"./AlertComponent.scss\";\nimport { v4 as uuidv4 } from \"uuid\";\n// import * as warning_icon from \"./icons/Warning.tsx\";\n// import * as danger_icon from \"./icons/Danger.tsx\";\n// import * as info_icon from \"./icons/Info.tsx\";\n// import * as success_icon from \"./icons/Check.tsx\";\n// import * as normal_icon from \"./icons/new_notification.svg\";\n// import * as cross from \"../common/icons/Cancel.tsx\";\nimport Cancel from \"../common/icons/Cancel\";\nimport Warning from \"./icons/Warning\";\nimport Danger from \"./icons/Danger\";\nimport Info from \"./icons/Info\";\nimport NewNotification from \"./icons/NewNotification\";\nimport Check from \"./icons/Check\";\n\nimport * as success_sound from \"./sounds/success.wav\";\nimport * as info_sound from \"./sounds/info.wav\";\nimport * as warning_sound from \"./sounds/warning.wav\";\nimport * as error_sound from \"./sounds/error.wav\";\nimport * as normal_sound from \"./sounds/normal.wav\";\n\nimport { Howl, Howler } from \"howler\";\n\nconst initialState = [];\nconst AlertStore = createContext<ContextType>(initialState as ContextType);\nconst { Provider } = AlertStore;\n\nconst DEFAULT_ALERT_TIME = 5;\n\nconst success_alert = new Howl({\n  src: [success_sound],\n});\nconst info_alert = new Howl({\n  src: [info_sound],\n});\nconst warning_alert = new Howl({\n  src: [warning_sound],\n});\nconst error_alert = new Howl({\n  src: [error_sound],\n});\nconst normal_alert = new Howl({\n  src: [normal_sound],\n});\n\nconst AlertsProvider = ({ children }) => {\n  console.log(\"AlertsProvider\");\n  const alerts_reducer = (state: InitialState, action: Action) => {\n    switch (action.type) {\n      case \"add_alert\": {\n        const alerts = state;\n        const { callback, id, ...rest_payload } = action.payload;\n        const new_alerts = [\n          {\n            id: id,\n            ...rest_payload,\n          },\n          ...alerts,\n        ];\n        switch (action.payload.status) {\n          case \"success\":\n            success_alert.play();\n            break;\n          case \"info\":\n            info_alert.play();\n            break;\n          case \"warning\":\n            warning_alert.play();\n            break;\n          case \"danger\":\n            error_alert.play();\n            break;\n          default:\n            normal_alert.play();\n        }\n        callback && callback(id);\n        return new_alerts;\n      }\n      case \"remove_alert\": {\n        const alerts = state;\n        console.log(\"alerts\", alerts, \"id\", action.payload.id);\n        const new_alerts = alerts.filter(\n          (alert: Alert) => alert.id != action.payload.id\n        );\n        return new_alerts;\n      }\n      default:\n        throw new Error();\n    }\n  };\n  const [state, dispatch] = useReducer(alerts_reducer, initialState);\n\n  const dispatch_add_alert = (payload) => {\n    dispatch({\n      type: \"add_alert\",\n      payload: payload,\n    });\n  };\n  const dispatch_remove_alert = (key) => {\n    dispatch({\n      type: \"remove_alert\",\n      payload: { id: key },\n    });\n  };\n\n  const store_memoized = React.useMemo(\n    () => ({ state, dispatch_add_alert, dispatch_remove_alert }),\n    [state]\n  );\n\n  const dispatch_event_memoized = React.useMemo(\n    () => ({ dispatch_add_alert, dispatch_remove_alert }),\n    []\n  );\n\n  return (\n    <>\n      <Provider value={store_memoized}>\n        <AtiAlerts />\n      </Provider>\n      <Provider value={dispatch_event_memoized}>{children}</Provider>\n    </>\n  );\n};\n\nconst useAlerts = () => {\n  const { dispatch_add_alert, dispatch_remove_alert } = useContext(AlertStore);\n\n  const add_alert = async ({\n    message,\n    status,\n    time = DEFAULT_ALERT_TIME,\n    on_click,\n    on_cancel,\n  }: AddAlert) => {\n    const id = uuidv4();\n    let payload = {\n      id: id,\n      message: message,\n      status: status,\n    };\n    if (on_click) payload[\"on_click\"] = on_click;\n    else\n      payload[\"callback\"] = async (id) => {\n        await new Promise((r) => setTimeout(r, time * 1000));\n        dispatch_remove_alert(id);\n      };\n    on_cancel && (payload[\"on_cancel\"] = on_cancel);\n    dispatch_add_alert(payload);\n    return id;\n  };\n  return { dispatch_add_alert, add_alert, dispatch_remove_alert };\n};\n\nconst AtiAlerts = () => {\n  const { state } = useContext(AlertStore);\n  const { dispatch_remove_alert } = useAlerts();\n  const alerts_array: Alert[] = state;\n\n  const add_icon = (status) => {\n    switch (status) {\n      case \"success\":\n        return <Check className=\"status-icon\" />;\n      case \"warning\":\n        return <Warning className=\"status-icon\" />;\n      case \"info\":\n        return <Info className=\"status-icon\" />;\n      case \"danger\":\n        return <Danger className=\"status-icon\" />;\n      default:\n        return <></>;\n    }\n  };\n  const render_alerts = (alerts: Alert[]) => {\n    return alerts.map(({ message, id, status, on_cancel, on_click }, index) => {\n      const cancel_on_click = (e) => {\n        if (on_cancel) {\n          on_cancel();\n        }\n        dispatch_remove_alert(e.target.dataset.index);\n      };\n      const body_on_click = (e) => {\n        if (e.target === e.currentTarget) {\n          if (on_click) {\n            on_click();\n            dispatch_remove_alert(e.target.dataset.index);\n          }\n        }\n      };\n      return (\n        <div\n          className={status ? `alert ${status}` : \"alert\"}\n          data-index={id}\n          onClick={body_on_click}\n          key={index}\n        >\n          {add_icon(status)}\n          <span className=\"message\">{message}</span>\n          <div\n            onClick={cancel_on_click}\n            className=\"cancel-button\"\n            data-index={id}\n          >\n            <div className=\"pointer-none\">\n              <Cancel />\n            </div>\n          </div>\n        </div>\n      );\n    });\n  };\n  return (\n    <div className=\"alerts-overlay\">\n      <div className=\"alerts-wrapper\" data-testid=\"alerts-wrapper\">\n        {render_alerts(alerts_array)}\n      </div>\n    </div>\n  );\n};\n\nexport { AlertStore, AlertsProvider, AtiAlerts, useAlerts };\n","import React from \"react\";\nimport \"./Spinners.scss\";\n\nexport const pulse_spinner = (\n  <div className=\"wrapper\">\n    <div className=\"loader\"></div>\n  </div>\n);\n","import React from \"react\";\nimport \"./ButtonComponent.scss\";\nimport { pulse_spinner } from \"../Spinners/Spinners\";\n\nexport function AtiButton(props) {\n  const { children, loading, className, ...rest } = props;\n  return (\n    <>\n      {loading ? (\n        pulse_spinner\n      ) : (\n        <button {...rest} className={`ati-button ${className && className}`}>\n          {children}\n        </button>\n      )}\n    </>\n  );\n}\nexport function UnderlinedButton(props) {\n  const { children, className, ...rest } = props;\n  return (\n    <button {...rest} className={`underlined-button ${className && className}`}>\n      {children}\n    </button>\n  );\n}\nexport function Pill(props) {\n  const { children, className, ...rest } = props;\n  return (\n    <button {...rest} className={`pill ${className && className}`}>\n      {children}\n    </button>\n  );\n}\n","import React, { PropsWithChildren } from \"react\";\nimport \"./CardComponent.scss\";\nimport * as mule_icon from \"../common/icons/truck.svg\";\nimport * as green_circle_icon from \"./icons/green-circle.svg\";\nimport * as grey_circle_icon from \"./icons/grey-circle.svg\";\nimport { MuleData, TripData } from \"./CardComponent.types\";\nimport { AtiButton } from \"../ButtonComponent/ButtonComponent\";\nimport ReactPlaceholder from \"react-placeholder\";\nimport \"react-placeholder/lib/reactPlaceholder.css\";\n\ntype placeholder_props = {\n  showLoadingAnimation: Boolean;\n  rows: Number;\n  ready: Boolean;\n};\nconst placeholder_props_1: PropsWithChildren<any> = {\n  showLoadingAnimation: true,\n  rows: 1,\n  ready: false,\n};\nconst placeholder_props_2: PropsWithChildren<any> = {\n  showLoadingAnimation: true,\n  rows: 2,\n  ready: false,\n};\nconst placeholder_props_4: PropsWithChildren<any> = {\n  showLoadingAnimation: true,\n  rows: 4,\n  ready: false,\n};\nconst placeholder_rows_1 = <ReactPlaceholder {...placeholder_props_1} />;\nconst placeholder_rows_2 = <ReactPlaceholder {...placeholder_props_2} />;\nconst placeholder_rows_4 = <ReactPlaceholder {...placeholder_props_4} />;\n\ninterface Props {\n  data: MuleData;\n  loading?: boolean;\n}\n\nconst AtiSanjayMuleCard = ({ data, loading }: Props) => {\n  const mule = data;\n  const loading_mule_card = () => (\n    <div data-testid=\"mule-card-loading\" className=\"custom-card\">\n      <div className=\"mule-name-status-div\">{placeholder_rows_2}</div>\n      <div className=\"card-btn\">{placeholder_rows_1}</div>\n      <div className=\"card-btn\">{placeholder_rows_2}</div>\n    </div>\n  );\n\n  const loaded_mule_card = (mule) => (\n    <div className=\"custom-card\" key={mule.id} data-testid=\"mule-card\">\n      <div className=\"mule-name-status-div\" data-testid=\"mule-card-name-status\">\n        <div className=\"mule-icon-name-container\" data-testid=\"mule-card-icon-name\">\n          <img src={String(mule_icon)} />\n          <span className=\"mule-name-container\"  data-testid=\"mule-card-mule-name\">\n            <b>{mule.name}</b>\n          </span>\n        </div>\n        <div className=\"online-status-main\" data-testid=\"mule-card-online\">\n          <span className=\"online-status-span\" data-testid=\"mule-card-online-status-span\">\n            {mule.online ? \"Online\" : \"Offline\"}\n          </span>\n          &nbsp;\n          {mule.online ? (\n            <img src={String(green_circle_icon)} />\n          ) : (\n            <img src={String(grey_circle_icon)} />\n          )}\n        </div>\n      </div>\n      <small>\n        <b>Sl. No:&nbsp;&nbsp;{mule.serial_number}</b>\n      </small>\n      <p>State: {mule.state} </p>\n      <p>Battery Status: {mule.battery_percentage}</p>\n      <div className=\"card-btn\" data-testid=\"mule-card-card-btn\">\n        <AtiButton onClick={mule.on_edit} data-testid=\"mule-card-edit-button\">Edit</AtiButton>\n        <AtiButton onClick={mule.on_delete} data-testid=\"mule-card-delete-button\">Delete</AtiButton>\n      </div>\n    </div>\n  );\n\n  return <>{loading ? loading_mule_card() : loaded_mule_card(mule)}</>;\n};\n\ninterface TripsProps {\n  data: { number_of_trips: number; mule_name: string }[];\n  loading?: boolean;\n}\n\nconst AtiSanjayDashboardCard = ({ data, loading }: TripsProps) => {\n  const loading_dashboard_card = () => (\n    <div data-testid=\"dashboard-card-loading\" className=\"dashboard-loading\">\n      <div className=\"dashboard-loading-1\">{placeholder_rows_2}</div>\n      <div className=\"dashboard-loading-2\">{placeholder_rows_4}</div>\n    </div>\n  );\n\n  const loaded_dashboard_card = (data) => {\n    let total_trips = data\n      .map((obj) => obj.number_of_trips)\n      .reduce((a, b) => a + b, 0);\n    return (\n      <div\n        data-testid=\"dashboard-card\"\n        className={\n          data.length >= 1\n            ? \"mule-distance-card\"\n            : \"mule-distance-card dashboard-no-data-container\"\n        }\n      >\n        <div className=\"mule-distance-card-header-container\" data-testid=\"mule-distance-card-header-main\">\n          <span\n            className=\"mule-distance-card-header\"\n            data-testid=\"mule-distance-card-header-1\"\n            style={data.length >= 1 ? {} : { display: \"none\" }}\n          >\n            Mule Trips\n          </span>\n          <span className={data.length >= 1 ? \"mule-distance-card-header\" : \"\"} data-testid=\"mule-distance-card-header-2\">\n            {data.length >= 1 ? (\n              total_trips\n            ) : (\n              <span className=\"no-data-card-text-span\">No Trips</span>\n            )}\n          </span>\n        </div>\n        <ul style={data.length >= 1 ? {} : { display: \"none\" }}>\n          {data.map((obj, index) => (\n            <li key={index + 1}>\n              <span>{obj.mule_name}</span>\n              <span>{obj.number_of_trips}</span>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  };\n\n  return (\n    <>{loading ? loading_dashboard_card() : loaded_dashboard_card(data)}</>\n  );\n};\n\nexport { AtiSanjayMuleCard, AtiSanjayDashboardCard, Props, TripsProps };\n","import React, {\n  FormEvent,\n  useRef,\n  FormEventHandler,\n  useState,\n  useEffect,\n  ChangeEventHandler,\n  ChangeEvent,\n  ReactElement,\n} from \"react\";\nimport lodash from \"lodash\";\nimport { AtiButton } from \"../ButtonComponent/ButtonComponent\";\nimport \"./FormComponent.scss\";\nimport \"../ButtonComponent/ButtonComponent.scss\";\nimport { EachInput } from \"./FormComponent.types\";\nimport { async } from \"q\";\nimport Cancel from \"../common/icons/Cancel\";\n\nexport type Props = {\n  inputs: EachInput[];\n  utilities?: Array<ReactElement | HTMLElement>;\n  on_submit: Function;\n  on_cancel?: Function;\n  warning?: String;\n};\n\nfunction AtiForm({ on_submit, on_cancel, inputs, utilities, warning }: Props) {\n  const form_submit_button = useRef(null);\n  const [form_state, set_form_state] = useState({});\n  const [loading, set_loading] = useState(false);\n  const is_mounted = useRef(false);\n\n  useEffect(() => {\n    is_mounted.current = true;\n    return () => {\n      is_mounted.current = false;\n    };\n  }, []);\n\n  const form_submit: FormEventHandler<HTMLFormElement> = async (\n    e: FormEvent<HTMLFormElement>\n  ) => {\n    e.preventDefault();\n    is_mounted.current && set_loading(true);\n    await on_submit(form_state);\n    is_mounted.current && set_loading(false);\n  };\n\n  const sentence_case = (str_var: String) => {\n    return lodash.capitalize(lodash.lowerCase(String(str_var)));\n  };\n\n  const on_change: ChangeEventHandler<HTMLInputElement> = (\n    e: ChangeEvent<HTMLInputElement>\n  ) => {\n    e.persist();\n    is_mounted.current && set_form_state((state) => {\n      return { ...state, [e.target.id]: e.target.value };\n    });\n  };\n\n  const show_inputs = (inputs: EachInput[]) => {\n    return inputs.map((each_input: EachInput, key) => (\n      <section key={`input-${key}`}>\n        <label>{sentence_case(each_input.id)}</label>\n        <input id={each_input.id} onChange={on_change} type={each_input.type} required/>\n      </section>\n    ));\n  };\n\n  return (\n    <form\n      data-testid=\"form\"\n      autoComplete=\"off\"\n      className=\"ati-form\"\n      onSubmit={form_submit}\n    >\n      {on_cancel && (\n        <>\n          <Cancel\n            className=\"cancel-button\"\n            data-testid=\"cancel-button\"\n            onClick={() => {\n              on_cancel && on_cancel();\n            }}\n          />\n          <div className=\"space-div\" />\n        </>\n      )}\n      <section data-testid=\"inputs\" className=\"inputs\">\n        {show_inputs(inputs)}\n      </section>\n      <section>{utilities}</section>\n      <AtiButton\n        loading={loading}\n        className=\"form-button\"\n        data-testid=\"submit-button\"\n        type=\"submit\"\n      >\n        Submit\n      </AtiButton>\n      {warning && (\n        <section data-testid=\"warning\" className=\"warning\">\n          {\" \"}\n          <span>{warning}</span>\n        </section>\n      )}\n    </form>\n  );\n}\n\nexport default AtiForm;\n","import React, { useState, useRef, useEffect } from \"react\";\nimport \"./ModalComponent.scss\";\n\nexport default function useAtimodal(): [React.FC, () => void, () => void] {\n  const [show, set_show] = useState(false);\n  const is_mounted = useRef(false);\n\n  useEffect(() => {\n    is_mounted.current = true;\n    return () => {\n      is_mounted.current = false;\n    }\n  }, [])\n\n  function Atimodal({ children }) {\n    const overlay_on_click = (e) => {\n      if (e.target === e.currentTarget) {\n        hide_modal();\n      }\n    };\n    return show ? (\n      <div className=\"overlay\" onClick={overlay_on_click}>\n        <div className=\"modal\">{children}</div>\n      </div>\n    ) : (\n      <></>\n    );\n  }\n\n  const show_modal = () => {\n    is_mounted.current && set_show(true);\n  };\n  const hide_modal = () => {\n    is_mounted.current && set_show(false);\n  };\n\n  return [Atimodal, show_modal, hide_modal];\n}\n","import React, {PropsWithChildren} from \"react\";\nimport { UserData, TripData } from \"./StripsComponent.types\";\nimport \"./StripsComponent.scss\";\n\nimport * as arrow_right_icon from \"./Icons/arrow-right-short.svg\";\nimport * as mule_icon from \"../common/icons/truck.svg\";\n\nimport moment from \"moment\";\n\nimport {\n  AtiButton,\n  Pill,\n  UnderlinedButton,\n} from \"../ButtonComponent/ButtonComponent\";\n\nimport ReactPlaceholder from \"react-placeholder\";\nimport \"react-placeholder/lib/reactPlaceholder.css\";\n\ntype placeholder_props = {\n  showLoadingAnimation: Boolean;\n  rows: Number;\n  ready: Boolean;\n};\n\nconst placeholder_props_3: PropsWithChildren<any> = {\n  showLoadingAnimation: true,\n  rows: 3,\n  ready: false,\n};\n\nconst placeholder_rows_3 = (\n  <ReactPlaceholder {...placeholder_props_3} />\n);\n\nconst loading_status_sanjay = () => (\n  <div className=\"loading-strip\" data-testid=\"loading-status-sanjay\">\n    <div className=\"loading-strip-1-sanjay\">{placeholder_rows_3}</div>\n    <div className=\"loading-strip-2-sanjay\">{placeholder_rows_3}</div>\n  </div>\n);\nconst loading_status_trips = () => (\n  <div className=\"loading-strip\"  data-testid=\"loading-status-booking\">\n    <div className=\"loading-strip-1-trips\">{placeholder_rows_3}</div>\n    <div className=\"loading-strip-2-trips\">{placeholder_rows_3}</div>\n  </div>\n);\ninterface UserProps {\n  user: UserData;\n  loading?: boolean;\n}\n\nconst AtiSanjayStripsComponent = ({ user, loading }: UserProps) => {\n  const loaded_sanjay_strips = () => (\n    <div className=\"custom-sanjay-strip\" data-testid=\"sanjay-strip\">\n      <div className=\"custom-sanjay-strip-container-1\" data-testid=\"sanjay-strip-1\">\n        <span className=\"custom-sanjay-strip-name-initial-container\" data-testid=\"sanjay-strip-1-span\">{`${user.firstname\n          .charAt(0)\n          .toUpperCase()}${user.lastname.charAt(0).toUpperCase()}`}</span>\n        <div className=\"custom-sanjay-strip-user-name-email-container\" data-testid=\"sanjay-strip-1-user-name-email\">\n          <span className=\"custom-sanjay-strip-name-container\" data-testid=\"sanjay-strip-1-strip-name\">{`${user.firstname} ${user.lastname}`}</span>\n          <span>{user.email}</span>\n        </div>\n        {user.is_superuser && <Pill>superuser</Pill>}\n      </div>\n\n      <div className=\"custom-sanjay-strip-container-2\" data-testid=\"sanjay-strip-2\">\n        <AtiButton onClick={user.on_edit} data-testid=\"sanjay-strip-edit\">Edit</AtiButton>\n        <AtiButton onClick={user.on_delete} data-testid=\"sanjay-strip-delete\">Delete</AtiButton>\n      </div>\n    </div>\n  );\n\n  return <>{loading ? loading_status_sanjay() : loaded_sanjay_strips()}</>;\n};\n\ninterface TripProps {\n  data: TripData;\n  loading?: boolean;\n}\n\nconst AtiBookingStripsComponent = ({ data, loading }: TripProps) => {\n\n  const TripStationName = ({ station_list }) => {\n    let no_stations = station_list.length;\n    let station_display = station_list.map((station, idx) => (\n      <React.Fragment key={idx}>\n        <span className=\"station-names\" data-testid=\"station-names\">{station}</span>\n        {idx != no_stations - 1 && <img src={String(arrow_right_icon)} />}\n      </React.Fragment>\n    ));\n    return <div className=\"station-name-containers\" data-testid=\"station-names-main\">{station_display}</div>;\n  };\n\n  const TripCompletedTimeInfo = ({ time }) => {\n    const time_len = time.length;\n    let start_end_time = time.map((timeinfo, idx) => (\n      <React.Fragment key={idx}>\n        {/* <TimeFormat time={timeinfo} /> */}\n        <span>{timeinfo}</span>\n        {idx !== time_len - 1 && <img src={String(arrow_right_icon)} />}\n      </React.Fragment>\n    ));\n    return <div className=\"time-containers\" data-testid=\"time-containers\">{start_end_time}</div>;\n  };\n\n  const TripCancel = ({ action }) => {\n    return (\n      <UnderlinedButton onClick={action} className=\"booking-strips\" >\n        CANCEL TRIP\n      </UnderlinedButton>\n    );\n  };\n\n  function TripReschedule({ action }) {\n    return (\n      <UnderlinedButton onClick={action} className=\"booking-strips\" data-testid=\"booking-button\">\n        USE AGAIN\n      </UnderlinedButton>\n    );\n  }\n\n  const TripTimeInfo = ({ status, time }) => {\n    switch (status) {\n      case \"FINISHED\":\n        return <TripCompletedTimeInfo time={time} />;\n      case \"SCHEDULED\":\n        return <TripScheduledTimeInfo time={time} />;\n      default:\n        return <></>;\n    }\n  };\n\n  function TripButton({ state, action }) {\n    switch (state) {\n      case \"FINISHED\":\n        return <TripReschedule action={action} />;\n      case \"SCHEDULED\":\n        return <TripCancel action={action} />;\n      default:\n        return <></>;\n    }\n  }\n\n  const TripOngoing = ({ time, progress }) => {\n    let start_end_time = time.map((timeinfo, idx) => (\n      <React.Fragment key={idx}>\n        <small>\n          <b>{idx === 0 && timeinfo}</b>\n        </small>\n        <small>\n          <b>{idx === 1 && timeinfo}</b>\n        </small>\n      </React.Fragment>\n    ));\n    return (\n      <div className=\"ongoing-trip-status-container\" data-testid=\"trip-ongoing-1\">\n        <div className=\"ongoing-trip-status-container-1\" data-testid=\"trip-ongoing-2\">\n          <img\n            className=\"mule-icon\"\n            data-testid=\"trip-ongoing-3\"\n            src={String(mule_icon)}\n            title=\"Mule\"\n            style={{ marginLeft: `calc(${progress}% - 18px)` }}\n          />\n          <div className=\"progress-wrapper\" data-testid=\"trip-ongoing-4\">\n            <div className=\"progress\" style={{ width: `${progress}%` }} data-testid=\"trip-ongoing-5\"/>\n          </div>\n        </div>\n        <div className=\"ongoing-trip-status-container-2\" data-testid=\"trip-ongoing-6\">{start_end_time}</div>\n      </div>\n    );\n  };\n\n  const TimeFormat = ({ time }) => {\n    return moment(time);\n  };\n\n  const TripOngoingTimeInfo = ({ time }) => {\n    return (\n      <section>\n        <small>\n          {/* <TimeFormat time={time_info.start_time} /> */}\n          <b>{time.start_time}</b>\n        </small>\n        <span key=\"info\">\n          <i>{time.tripInfo}</i>\n        </span>\n        <small>\n          {/* <TimeFormat time={time.eta} /> */}\n          <b>{time.eta}</b>\n        </small>\n      </section>\n    );\n  };\n\n  //TODO: eta time\n  const TripScheduledTimeInfo = ({ time }) => {\n    return <div className=\"time-containers\" data-testid=\"time-schedule-1\">in 10 minutes 0 seconds</div>;\n  };\n\n  const TripBookingInfo = ({ operator, trip_type }) => {\n    return (\n      <div className=\"booking-containers\" data-testid=\"trip-booking-info-1\">\n        <span>Booked by {operator}</span>\n        <b>{trip_type && \"(\" + trip_type + \")\"}</b>\n      </div>\n    );\n  };\n\n  const TripStatusStrip = ({\n    state,\n    station_list,\n    time,\n    operator,\n    trip_type,\n    button_action,\n    progress,\n  }) => {\n    return (\n      <div className=\"booking-custom-strips\" data-testid=\"booking-strip-main\">\n        <div className=\"booking-custom-strips-1\" data-testid=\"booking-strip-1\">\n          <TripStationName station_list={station_list} />\n          {state === \"ONGOING\" ? (\n            <></>\n          ) : (\n            <TripTimeInfo status={state} time={time} />\n          )}\n          <TripBookingInfo operator={operator} trip_type={trip_type} />\n        </div>\n        <div className=\"booking-custom-strips-2\"  data-testid=\"booking-strip-2\">\n          {state === \"ONGOING\" ? (\n            <TripOngoing time={time} progress={progress} />\n          ) : (\n            <TripButton state={state} action={button_action} />\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  //TODO: Trip cancelled\n  const trip_status = ({\n    state,\n    station_list,\n    time,\n    operator,\n    trip_type,\n    progress = 0,\n    button_action,\n  }: TripData) => {\n    switch (state) {\n      case \"FINISHED\":\n        return (\n          <TripStatusStrip\n            state={state}\n            station_list={station_list}\n            time={time}\n            operator={operator}\n            trip_type={trip_type}\n            button_action={button_action}\n            progress={progress}\n          />\n        );\n      case \"ONGOING\":\n        return (\n          <TripStatusStrip\n            state={state}\n            station_list={station_list}\n            time={time}\n            operator={operator}\n            trip_type={trip_type}\n            button_action={button_action}\n            progress={progress}\n          />\n        );\n      case \"SCHEDULED\":\n        return (\n          <TripStatusStrip\n            state={state}\n            station_list={station_list}\n            time={time}\n            operator={operator}\n            trip_type={trip_type}\n            button_action={button_action}\n            progress={progress}\n          />\n        );\n    }\n  };\n\n  return <>{loading ? loading_status_trips() : trip_status(data)}</>;\n};\n\nexport { AtiSanjayStripsComponent, AtiBookingStripsComponent, TripProps, UserProps };\n","import axios, { AxiosRequestConfig } from \"axios\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { Method } from \"./AxiosUtility.types\";\n\ntype Args = {\n  url: string;\n  method?: Method;\n  body?: {\n    [key: string]: any;\n  };\n  headers?: {\n    [key: string]: any;\n  };\n  on_error: Function;\n  on_success: Function;\n};\n\nconst default_headers = {\n  \"Content-Type\": \"application/json\",\n  Accept: \"*/*\",\n};\n\nexport const useFetch = ({\n  url,\n  method = \"get\",\n  headers = default_headers,\n  body,\n  on_error,\n  on_success,\n}: Args): [Function, boolean] => {\n  const [loading, set_loading] = useState<boolean>(false);\n  const is_mounted = useRef(false);\n  console.log(\"headers\", headers);\n\n  useEffect(() => {\n    is_mounted.current = true;\n    return () => {\n      is_mounted.current = false;\n    };\n  }, []);\n\n  const fetch = async (\n    {\n      request_headers = headers,\n      request_body = body,\n      request_method = method,\n      with_credentials = false,\n    } = {\n      request_headers: headers,\n      request_body: body,\n      request_method: method,\n      with_credentials: false,\n    }\n  ) => {\n    try {\n      is_mounted.current && set_loading(true);\n      with_credentials && (axios.defaults.withCredentials = true);\n      const axios_config: AxiosRequestConfig = {\n        url,\n        method: request_method,\n        headers: request_headers,\n        data: request_body,\n      };\n      const response = await axios(axios_config);\n      is_mounted.current && set_loading(false);\n      on_success(response);\n    } catch (err) {\n      set_loading(false);\n      on_error(err);\n    }\n  };\n\n  return [fetch, loading];\n};\n","import React from \"react\";\n\nexport default function EyeSlash({\n  color = \"currentColor\",\n  className,\n  ...rest\n}) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      className={`bi bi-eye ${className && className}`}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n    >\n      <path d=\"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z\" />\n      <path d=\"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z\" />\n    </svg>\n  );\n}\n","import React from \"react\";\n\nexport default function EyeSlash({\n  color = \"currentColor\",\n  className,\n  ...rest\n}) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      fill={color}\n      className={`bi bi-eye-slash ${className && className}`}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n    >\n      <path d=\"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z\" />\n      <path d=\"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z\" />\n      <path d=\"M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z\" />\n    </svg>\n  );\n}\n","import React, { useState, useEffect, useRef } from \"react\";\nimport \"./InputComponent.scss\";\nimport Eye from \"./icons/Eye\";\nimport EyeSlash from \"./icons/EyeSlash\";\n\nexport const CheckboxInput = (props) => {\n  const { label, ...rest } = props;\n\n  return (\n    <section className=\"checkbox-input\">\n      <input {...rest} type=\"checkbox\" />\n      {label && <label>{label}</label>}\n    </section>\n  );\n};\n\nexport const NumberInput = (props) => {\n  const { label, onChange, min, max, onError, ...rest } = props;\n\n  const on_change_handler = (e) => {\n    if ((min && e.target.value < min) || (max && e.target.value > max)) {\n      e.target.value = null;\n      onError &&\n        onError({\n          message: \"value exceeds the range given\",\n          key: \"range_exceeded\",\n          event: e,\n        });\n    }\n    onChange(e);\n  };\n\n  return (\n    <section className=\"number-input\">\n      {label && <label>{label}</label>}\n      <input\n        {...rest}\n        min={min}\n        max={max}\n        onChange={on_change_handler}\n        type=\"number\"\n      />\n    </section>\n  );\n};\n\nexport function TextInput(props) {\n  const { label, onChange, onError, minLength, maxLength, type, regex, ...rest } =\n    props;\n  const [password_show, set_password_show] = useState(true);\n  const is_mounted =  useRef(false);\n\n  useEffect(() => {\n    is_mounted.current = true;\n    type === \"password\" && set_password_show(false);\n    return () => {\n      is_mounted.current = false;\n    }\n  }, []);\n\n  const toggle_password = () => {\n    is_mounted.current && set_password_show(password_show ? false : true);\n  };\n  const on_change_handler = (e) => {\n    if (\n      (minLength && e.target.value.length < minLength) ||\n      (maxLength && e.target.value.length > maxLength)\n    ) {\n      onError && onError({ message: \"value exceeds the range given\", key: \"range_exceeded\", event: e });\n    }else if (regex && !validate_using_regex(e.target.value)) {\n      onError && onError({ message: \"Given string is not matching the regular expression\", key: \"regex_unmatch\", event: e });\n    } else\n      onChange(e);\n  };\n\n  const validate_using_regex = (str) => regex.test(str);\n\n  const show_hide_icon = () =>\n    password_show ? (\n      <EyeSlash className=\"password-icon\" onClick={toggle_password} />\n    ) : (\n      <Eye className=\"password-icon\" onClick={toggle_password} />\n    );\n\n  return (\n    <section className=\"text-input\">\n      {label.length > 0 && <label>{label}</label>}\n      <div className=\"password-container\">\n        <input\n          type={password_show ? \"text\" : \"password\"}\n          onChange={on_change_handler}\n          minLength={minLength}\n          maxLength={maxLength}\n          {...rest}\n        ></input>\n        {type === \"password\" && show_hide_icon()}\n      </div>\n    </section>\n  );\n}\nexport const DropdownInput = (props) => {\n  const { label, options, onChange, ...rest } = props;\n  const on_change_handler = (e) => {\n    onChange(e);\n  };\n\n  const prepare_options = (options) => {\n    return options.map((option, index) => (\n      <option key={index} value={option.value}>{option.name}</option>\n    ));\n  };\n\n  const select_with_options = () => (\n    <select {...rest} type=\"checkbox\">\n      {prepare_options(options)}\n    </select>\n  );\n  return (\n    <section onChange={on_change_handler} className=\"select-input\">\n      {label && <label>{label}</label>}\n      {options.length > 0 ? (\n        select_with_options()\n      ) : (\n        <span> no options available... </span>\n      )}\n    </section>\n  );\n};\n","import React from \"react\";\n\nconst AtiProgress = ({progress}) => {\n  return (\n    <div className=\"progress-wrapper\">\n      <div\n        className=\"progress\"\n        style={{ width: `${progress}%` }}\n      />\n    </div>\n  );\n};\n\nexport default AtiProgress;\n","import React, { useEffect, useState } from \"react\";\nimport { NavLink, useLocation } from \"react-router-dom\";\nimport Logo from \"../images/ati-logo.png\";\nimport \"./common.css\";\nimport EmergencyStopButtton from \"./EmergencyStopButtton\";\nimport ProfileButton from \"./ProfileButton\";\nimport AdminToolsButton from \"./AdminToolsButton\";\nimport { useFunctions } from \"../utilities/functionsHooks\";\n// import MuleStatus from \"../components/dashboard/sherpa/MuleStatus\";\nimport { getNavData } from \"../reducers/navReducer\";\nimport { useSelector } from \"react-redux\";\nimport { navLinks } from \"./constants\";\nimport { formatName } from \"../components/dashboard/utilities/DashboardGenericFn\";\nimport { api_url } from \"../../src/conf\";\nimport { useHistory } from \"react-router-dom\";\nimport { AXIOS_HEADER as headers } from \"../components/dashboard/utilities/Constants\";\n\nimport {\n  useAlerts,\n  AtiButton,\n  useFetch,\n  pulse_spinner,\n  useAtimodal,\n} from \"ati-ui\";\n\nfunction Navbar() {\n  const history = useHistory();\n  const { add_alert } = useAlerts();\n  const [show_navbar, set_show_navbar] = useState(true);\n\n  // const nav_data = useSelector(getNavData).current_nav;\n  let location = useLocation();\n  useEffect(() => {\n    console.log(location.pathname);\n    if (location.pathname === \"/map_editor\") set_show_navbar(false);\n    else set_show_navbar(true);\n  }, [location]);\n\n  const on_error = (err) => {\n    add_alert({\n      message: err.message,\n      status: \"danger\",\n    });\n  };\n\n  const [logout_user, user_loading] = useFetch({\n    url: `${api_url}/logout`,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      localStorage.removeItem(\"token\");\n      history.push(\"/\");\n    },\n  });\n\n  const nav_links_data = [\n    { name: \"Map Creator\", link: \"/map_creator\" },\n    { name: \"Map Editor\", link: \"/map_editor_\" },\n    { name: \"Sherpa Status\", link: \"/webctl\" },\n    // { name: \"Remote Drive\", link: \"/remote_drive\" },\n  ];\n\n  const nav_links = () => {\n    return nav_links_data.map((nav_link, idx) => (\n      <li key={idx}>\n        <NavLink\n          className=\"nav-link sherpa-nav-link\"\n          activeClassName=\"nav-link-active sherpa-nav-link\"\n          exact={idx === 0}\n          to={nav_link.link}\n        >\n          {nav_link.name}\n        </NavLink>\n      </li>\n    ));\n  };\n\n  const utility_icons = () => {\n    return (\n      <React.Fragment>\n        <EmergencyStopButtton />\n        <AdminToolsButton />\n        <ProfileButton />\n      </React.Fragment>\n    );\n  };\n\n  return (\n    <nav className=\"navbar\">\n      <img className=\"logo\" alt=\"logo\" src={String(Logo)} />\n      <ul className=\"nav-links\">\n        {show_navbar && nav_links()}\n        {show_navbar && <li className=\"nav-link logout-link\" onClick={() => logout_user({ request_headers: headers() })}>\n          Logout\n        </li>}\n      </ul>\n      {/* <div className=\"utility-icons\">{utility_icons()}</div> */}\n      {/* <MuleStatus /> */}\n    </nav>\n  );\n}\n\nexport default Navbar;\n","import { Matrix } from \"ml-matrix\";\n\nfunction get_point_at_length(point, direction, dist) {\n  if (direction && dist) {\n    let c = Matrix.mul(direction, dist);\n    return Matrix.add(point, c);\n  }\n}\n\nfunction dir_norm(line1, line2) {\n  let diff = Matrix.sub(line1, line2);\n  return Matrix.div(diff, diff.norm());\n}\n\nfunction generate_smooth_path(wps, r) {\n  let new_wps = wps.clone();\n  let i = 0;\n  let p1, p2, p3;\n  let n_rows = wps.rows;\n\n  while (i <= n_rows - 3) {\n    p1 = wps.getRowVector(i);\n    p2 = wps.getRowVector(i + 1);\n    p3 = wps.getRowVector(i + 2);\n    new_wps.removeRow(2 * i + 1);\n    new_wps.addRow(2 * i + 1, get_point_at_length(p2, dir_norm(p1, p2), r));\n    new_wps.addRow(\n      2 * i + 2,\n      get_point_at_length(p2, dir_norm(p2, p3).mul(-1), r)\n    );\n\n    i += 1;\n  }\n  return new_wps;\n}\n\nexport default generate_smooth_path;\n","const np_abs = (arr) => {\n  return arr.map((value) => Math.abs(value));\n};\n\nconst np_diff = (arr) => {\n  const arr_length = arr.length;\n  let return_arr = [];\n  let i;\n  for (i = 1; i < arr_length; i++) {\n    return_arr.push(arr[i] - arr[i - 1]);\n  }\n  return return_arr;\n};\n\nconst np_sum = (arr) => {\n  let total = 0;\n  let i;\n  for (i = 0; i < arr.length; i++) {\n    total = total + arr[i];\n  }\n  return total;\n};\n\nconst np_array_mul = (a, b) => {\n  let arr;\n  if (a.length === b.length) {\n    arr = a.map((element, index) => element * b[index]);\n  }\n  return arr;\n};\nconst np_array_sub = (a, b) => {\n  let arr;\n  if (a.length === b.length) {\n    arr = a.map((element, index) => element - b[index]);\n  }\n  return arr;\n};\nconst np_array_sum = (a, b) => {\n  let arr;\n  if (a.length === b.length) {\n    arr = a.map((element, index) => element + b[index]);\n  }\n  return arr;\n};\nconst np_array_exponential = (arr, exp) => {\n  return arr.map((element) => element ** exp);\n};\nconst np_array_division = (a, b) => {\n  return a.map((element, index) => element / b[index]);\n};\nconst np_max = (arr) => {\n  let max;\n  return Math.max(...arr);\n};\n\nexport {\n  np_abs,\n  np_diff,\n  np_max,\n  np_sum,\n  np_array_sub,\n  np_array_mul,\n  np_array_sum,\n  np_array_exponential,\n  np_array_division,\n};\n","import { np_diff, np_abs, np_sum } from \"./utils\";\nimport { Matrix } from \"ml-matrix\";\nconst POINTS_RES = 50; \nconst MAX_TURN_RAD = 20;\n\nfunction turn(p1, u1, p2, u2, pathres = POINTS_RES) {\n  let p1m = Matrix.columnVector(p1);\n  let p2m = Matrix.columnVector(p2);\n  let ts = Matrix.sub(p2m, p1m);\n\n  let theta_mat = _compute_theta(u1, u2, ts, pathres);\n\n  let theta_cos = Matrix.cos(theta_mat);\n  let theta_sin = Matrix.sin(theta_mat);\n\n  let rx, ry;\n  let temp_x, temp_y;\n  let pathm = [];\n\n  theta_cos.cumulativeSum();\n  theta_sin.cumulativeSum();\n\n  try {\n    theta_cos.get(theta_cos.size - 1, 0);\n  } catch (err) {\n    console.log(\"err: theta_cos\", theta_cos);\n    console.log(\"err: u1, u2, ts\", u1, u2, ts);\n    console.log(\"err: p1,p2\", p1, p2);\n  }\n  rx =\n    parseFloat(ts.get(0, 0)) /\n    (parseFloat(theta_cos.get(theta_cos.size - 1, 0)) + 0.0001);\n  ry =\n    parseFloat(ts.get(1, 0)) /\n    (parseFloat(theta_sin.get(theta_sin.size - 1, 0)) + 0.0001);\n\n  for (let i = 0; i < theta_mat.size; i++) {\n    temp_x = p1[0] + rx * parseFloat(theta_cos.get(i, 0));\n    temp_y = p1[1] + ry * parseFloat(theta_sin.get(i, 0));\n\n    pathm.push(temp_x, temp_y);\n  }\n\n  return pathm;\n}\n\nfunction _compute_theta(u1, u2, ts, pathres = POINTS_RES) {\n  let dist = ts.norm() + 1.0;\n  let N = Math.round(dist * pathres * 1.4, 0);\n\n  let theta2 = Math.atan2(u2[1], u2[0]);\n  let theta1 = Math.atan2(u1[1], u1[0]);\n\n  if (theta2 - theta1 > Math.PI) {\n    theta2 = theta2 - 2 * Math.PI;\n  } else if (theta2 - theta1 < -Math.PI) {\n    theta2 = theta2 + 2 * Math.PI;\n  }\n  let theta = _turn_theta(theta1, theta2, N);\n  let theta_m = Matrix.columnVector(theta);\n  return theta_m;\n}\n\nfunction _turn_theta(alpha, beta, n = 5001) {\n  let start_value = 0;\n  let stop_value = 1;\n  let step = (stop_value - start_value) / (n - 1);\n  let theta = [];\n  let x = start_value;\n  for (let i = 0; i < n; i++) {\n    let temp =\n      (alpha - beta) * (1 - 3 * Math.pow(x, 2) + 2 * Math.pow(x, 3)) + beta;\n    theta.push(temp);\n    x += step;\n  }\n  return theta;\n}\n\nconst _get_turn_speed_index = (u1, u2, p1, p2) => {\n  const theta1 = Math.atan2(u1[1], u1[0]);\n  let theta2 = Math.atan2(u2[1], u2[0]);\n  if (theta2 - theta1 > Math.PI) {\n    theta2 -= 2 * Math.PI;\n  } else if (theta2 - theta1 < -Math.PI) {\n    theta2 += 2 * Math.PI;\n  }\n  const theta = _turn_theta(theta1, theta2);\n  const score_thresh = Math.PI / 2;\n  const theta_change = np_sum(np_abs(np_diff(theta)));\n  const speed_index = theta_change / score_thresh < 0.33 ? 0 : 3;\n  return speed_index;\n};\n\nexport { turn, _get_turn_speed_index };\n","export function round_decimal(array, prec) {\n  return array.map((x) => parseFloat(x.toFixed(prec)));\n}\nexport const convert_to_radians = (angle, precision = 3) =>\n  parseFloat(((angle * Math.PI) / 180).toFixed(precision));\n","import { _get_turn_speed_index } from \"./planner\";\nimport { round_decimal } from \"../../../utilities/genericFunctions\";\nimport { Matrix } from \"ml-matrix\";\n\nfunction give_straight(path, i) {\n  let p1 = new Matrix(path.getRowVector(i)).to1DArray(); // start point of straight stretch\n  p1 = round_decimal(p1, 3);\n  let p2 = new Matrix(path.getRowVector(i + 1)).to1DArray(); // end point of straight stretch\n  p2 = round_decimal(p2, 3);\n  return [\"straight\", p1, p2, 0];\n}\n\nfunction give_turn(path, i) {\n  // start point of turn\n\n  let p1 = round_decimal(path.getRowVector(i).to1DArray(), 3);\n\n  // direction vector of the 1st straight line\n\n  let u1 = Matrix.sub(path.getRowVector(i), path.getRowVector(i - 1));\n  u1 = round_decimal(Matrix.div(u1, u1.norm()).to1DArray(), 3);\n\n  // end point of turn\n  let p2 = round_decimal(path.getRowVector(i + 1).to1DArray(), 3);\n\n  // direction vector of the 2nd straight line\n  let u2 = Matrix.sub(path.getRowVector(i + 2), path.getRowVector(i + 1));\n  u2 = round_decimal(Matrix.div(u2, u2.norm()).to1DArray(), 3);\n  const speed_index = _get_turn_speed_index(u1, u2, p1, p2);\n  return [\"turn\", p1, u1, p2, u2, speed_index];\n}\n\nexport function make_route(path) {\n  console.info(\"path make_route\", path);\n  let length = path.rows;\n  let route = [];\n  let k = 0;\n  while (k < length - 1) {\n    if (k % 2 === 0 || k === length - 2) {\n      route.push(give_straight(path, k));\n    } else {\n      route.push(give_turn(path, k));\n    }\n    k += 1;\n  }\n  return route;\n}\n\n\n","import { turn } from \"./planner\";\n\nfunction parse(\n  route,\n  check_curva = false,\n  threshold = null,\n  is_valid_route\n) {\n  let path = [];\n  try {\n    for (let i in route) {\n      if (route[i][0] === \"straight\")\n        path = path.concat(...route[i].slice(1, -1));\n      else if (route[i][0] === \"turn\")\n        path = path.concat(turn(...route[i].slice(1, -1)));\n    }\n  } catch (error) {\n    console.log(\"error in parse routes:\", error);\n  } finally {\n    return path;\n  }\n}\n\nexport default parse;\n","import {\n  np_diff,\n  np_abs,\n  np_array_sub,\n  np_array_mul,\n  np_array_sum,\n  np_array_exponential,\n  np_array_division,\n} from \"./utils\";\n\nconst _get_path_curvature = (xp, yp) => {\n  const xd = np_diff(xp);\n  const yd = np_diff(yp);\n  const xd2 = np_diff(xd);\n  const yd2 = np_diff(yd);\n  const nr = np_array_sub(\n    np_array_mul(xd.slice(1, xd.length), yd2),\n    np_array_mul(yd.slice(1, xd.length), xd2)\n  );\n  const dr = np_array_exponential(np_array_sum( np_array_exponential(xd.slice(1, xd.length), 2), np_array_exponential(yd.slice(1, xd.length), 2)), 1.5);\n  const curvature = np_abs(np_array_division(nr, dr));\n  return curvature;\n};\n\nexport default _get_path_curvature;\n","import { Matrix } from \"ml-matrix\";\nimport _get_path_curvature  from \"./calculate_curvature\";\nimport { turn } from \"./planner\";\nimport  { np_max } from \"./utils\";\n\nexport function check_valid_route_curva(\n  from_station_coord,\n  tmp_cp,\n  to_station_coord,\n  threshold,\n  get_pixel_coordinate,\n  get_transformed_coordinates\n) {\n  let i;\n  let invalid_routes = [];\n  for (i = 0; i < tmp_cp.length; i = i + 4) {\n    let r_p0;\n    const r_p1 = [tmp_cp[i], tmp_cp[i + 1]];\n    const r_p2 = [tmp_cp[i + 2], tmp_cp[i + 3]];\n    let r_p3;\n    if (i === 0) {\n      r_p0 = from_station_coord;\n      if (tmp_cp.length === 4) r_p3 = to_station_coord;\n      else r_p3 = [tmp_cp[i + 4], tmp_cp[i + 5]];\n    } else if (i === tmp_cp.length - 4) {\n      r_p0 = [tmp_cp[i - 2], tmp_cp[i - 1]];\n      r_p3 = to_station_coord;\n    } else {\n      r_p0 = [tmp_cp[i - 2], tmp_cp[i - 1]];\n      r_p3 = [tmp_cp[i + 4], tmp_cp[i + 5]];\n    }\n    const [p1, u1, p2, u2] = get_p1_u1_p2_u2(r_p0, r_p1, r_p2, r_p3);\n    const pathm = turn(p1, u1, p2, u2, 500);\n\n    const px = [];\n    const py = [];\n    pathm.forEach((value, key) => {\n      if (key % 2 === 0) {\n        px.push(value);\n      } else {\n        py.push(value);\n      }\n    });\n    console.log(\"pathm\", pathm);\n    if (check_curve_threshold(px, py, threshold)) {\n      // const r_p0_trans = get_transformed_coordinates(\n      //   ...get_pixel_coordinate(...r_p0)\n      // );\n      // const r_p1_trans = get_transformed_coordinates(\n      //   ...get_pixel_coordinate(...r_p1)\n      // );\n      // const r_p2_trans = get_transformed_coordinates(\n      //   ...get_pixel_coordinate(...r_p2)\n      // );\n      // const r_p3_trans = get_transformed_coordinates(\n      //   ...get_pixel_coordinate(...r_p3)\n      // );\n      // const [p1_trans, u1_trans, p2_trans, u2_trans] = get_p1_u1_p2_u2(\n      //   r_p0_trans,\n      //   r_p1_trans,\n      //   r_p2_trans,\n      //   r_p3_trans\n      // );\n      // const path_trans = turn(p1_trans, u1_trans, p2_trans, u2_trans);\n      // console.log(\"path_trans\", path_trans);\n      // invalid_routes.push(path_trans);\n      let invalid_trans_point = [];\n      let i;\n      for (i = 0; i < pathm.length; i += 2) {\n        const [tmp_x, tmp_y] = get_transformed_coordinates(\n          ...get_pixel_coordinate(pathm[i], pathm[i + 1])\n        );\n        invalid_trans_point.push(tmp_x, tmp_y);\n      }\n      // console.log(\"invalid_trans_point\", invalid_trans_point, \"pathm\", pathm);\n      invalid_routes.push(invalid_trans_point);\n    }\n  }\n  return invalid_routes;\n}\n\nconst get_p1_u1_p2_u2 = (r_p0, r_p1, r_p2, r_p3) => {\n  const current_selected_turn = new Matrix([r_p0, r_p1, r_p2, r_p3]);\n  let p1 = current_selected_turn.getRowVector(1).to1DArray();\n\n  let u1 = Matrix.sub(\n    current_selected_turn.getRowVector(1),\n    current_selected_turn.getRowVector(0)\n  );\n  u1 = Matrix.div(u1, u1.norm()).to1DArray();\n\n  let p2 = current_selected_turn.getRowVector(2).to1DArray();\n\n  let u2 = Matrix.sub(\n    current_selected_turn.getRowVector(3),\n    current_selected_turn.getRowVector(2)\n  );\n  u2 = Matrix.div(u2, u2.norm()).to1DArray();\n  return [p1, u1, p2, u2];\n};\n\nconst check_curve_threshold = (px, py, threshold) => {\n  console.log(\"px,py\", px, py);\n  const curva = _get_path_curvature(px, py);\n  console.log(\"curva\", curva);\n  const max_curva = np_max(curva);\n\n  console.info(\"max_curva\", max_curva, threshold, max_curva > threshold);\n  return max_curva > threshold;\n};\n","export function shift_coord_update_pos(x, y, offset_x, offset_y) {\n  return [x - offset_x, y - offset_y];\n}\n\nexport function rotate_point(x, y, angle) {\n  return [\n    x * Math.cos(angle) - y * Math.sin(angle),\n    x * Math.sin(angle) + y * Math.cos(angle),\n  ];\n}\n\nexport const check_if_point_in_on_the_line = (x, y, x1, y1, x2, y2) => {\n  let point_on_line = false;\n  let distance_p1_p2 = distance_between(x1, y1, x2, y2);\n  let distance_p_p1 = distance_between(x, y, x1, y1);\n  let distance_p_p2 = distance_between(x, y, x2, y2);\n  console.log(\n    \"Math.abs(distance_p1_p2 - distance_p_p1 - distance_p_p2)\",\n    Math.abs(distance_p1_p2 - distance_p_p1 - distance_p_p2)\n  );\n  if (Math.abs(distance_p1_p2 - distance_p_p1 - distance_p_p2) <= 5)\n    point_on_line = true;\n  return point_on_line;\n};\n\nexport const distance_between = (x1, y1, x2, y2) => {\n  return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n};\n\nexport const show_hide_selector_line = ({\n  route_ref,\n  show = true,\n  route_id = null,\n}) => {\n  Object.values(route_ref).forEach((route) => {\n    const [line1, line2] = route.line.children;\n    if (!(route_id && route.route_id === route_id)) {\n      if (show) line2.show();\n      else line2.hide();\n    }\n  });\n};\n\n//TODO: Rework\n// export const konva_shape_cursor_change = (shape_object, shape = \"\") => {\n//     if(shape === \"line1\") {\n//       shape_object.on('mouseenter', function () {\n//         document.body.style.cursor = 'crosshair';\n//       });\n//     } else if((shape === \"node\")) {\n//       shape_object.on('mouseenter', function () {\n//         document.body.style.cursor = 'grabbing';\n//       });\n//     } else {\n//       shape_object.on('mouseenter', function () {\n//         document.body.style.cursor = 'pointer';\n//       });\n//     }\n//     shape_object.on('mouseleave', function () {\n//       document.body.style.cursor = 'default';\n//     });\n//   }","import React, { useEffect, useRef, useState } from \"react\";\nimport Konva from \"konva\";\nimport arrowClockwise from \"../../icons/arrow-clockwise.svg\";\nimport arrowCounterClockwise from \"../../icons/arrow-counter-clockwise.svg\";\nimport pivot_image from \"../../icons/icon-move.svg\";\n// import Hammer from \"./map-editor-components/konva_hammer\";\n\nfunction AlignMap(props) {\n  const ROTATE_STEP_SIZE = useRef(3);\n  const [image_loaded, set_image_loaded] = useState(false);\n  const [map_angle, set_map_angle] = useState(null);\n  // const total_angle_ref = useRef(null);\n\n  let imageObj = useRef(new Image());\n\n  function edit_mode(enabled) {\n    Object.keys(props.icon_list.current).forEach((idx) => {\n      props.icon_list.current[idx].draggable(enabled);\n    });\n  }\n\n  const set_map_angle_input = () => {\n    set_map_angle(props.map_image.current.rotation());\n  };\n\n  useEffect(() => {\n    let isMounted = true;\n    imageObj.current.src = pivot_image;\n    imageObj.current.onload = function () {\n      if(isMounted) {\n        set_image_loaded(true);\n        set_map_angle_input();\n      }\n    };\n\n    // script.current = document.createElement(\"script\");\n\n    // script.current.src = \"https://konvajs.org/js/hammer-konva.js\";\n    // script.current.async = true;\n\n    // document.body.appendChild(script.current);\n\n    // return () => {\n    //   document.body.removeChild(script.current);\n    // };\n    return () => (isMounted = false);\n  }, []);\n\n  useEffect(() => {\n    edit_mode(false);\n    if (props.map_image.current && image_loaded) {\n      change_pivot();\n    }\n    return () => {\n      if (props.map_image.current && props.is_mounted.current) {\n        props.pivot_ref.current && props.pivot_ref.current.destroy();\n        props.layer.current.draw();\n      }\n    };\n  }, [props.map_image.current, image_loaded]);\n\n  function change_pivot() {\n    draw_pivot();\n    const x = props.stage.current.width() / 2;\n    const y = props.stage.current.height() / 2;\n    props.pivot.current = { x, y };\n    props.layer.current.add(props.pivot_ref.current);\n    props.layer.current.draw();\n  }\n\n  function draw_pivot() {\n    if (props.stage.current) {\n      // create our shape\n      let new_id = Object.keys(props.station_coord.current).length + 1;\n      props.pivot_ref.current = new Konva.Image({\n        x: props.stage.current.width() / 2,\n        y: props.stage.current.height() / 2,\n        image: imageObj.current,\n        width: 40,\n        height: 40,\n        offset: {\n          x: 20,\n          y: 20,\n        },\n        // id: new_id,\n        dragBoundFunc: function (pos) {\n          let new_y = pos.y;\n          let new_x = pos.x;\n          const stage_width = props.stage.current.width();\n          const stage_height = props.stage.current.height();\n          if (pos.y > stage_height - 20) new_y = stage_height - 20;\n          else if (pos.y < 20) new_y = 20;\n          if (pos.x > stage_width - 20) new_x = stage_width - 20;\n          else if (pos.x < 20) new_x = 20;\n          return {\n            x: new_x,\n            y: new_y,\n          };\n        },\n        draggable: true,\n      });\n\n      // var hammertime = new Hammer(circle, { domEvents: true });\n      // hammertime.get(\"rotate\").set({ enable: true });\n      props.pivot_ref.current.on(\n        \"dragend\",\n        function ({\n          target: {\n            attrs: { x, y },\n          },\n        }) {\n          props.pivot.current = { x, y };\n        }\n      );\n    }\n  }\n\n  const change_step_size = (e) => {\n    ROTATE_STEP_SIZE.current = e.target.value;\n  };\n\n  function compute_new_station_pos(anti_clockwise = -1) {\n    let angle = (ROTATE_STEP_SIZE.current * anti_clockwise * Math.PI) / 180;\n    let tmp;\n    Object.entries(props.station_coord.current).forEach(([id, val]) => {\n      tmp = props.shift_coord_update_pos(\n        val.x,\n        val.y,\n        props.pivot.current.x,\n        props.pivot.current.y\n      );\n      tmp = props.rotate_point(tmp[0], tmp[1], angle);\n      tmp = props.shift_coord_update_pos(\n        tmp[0],\n        tmp[1],\n        -props.pivot.current.x,\n        -props.pivot.current.y\n      );\n      props.station_coord.current[id].x = tmp[0];\n      props.station_coord.current[id].y = tmp[1];\n    });\n  }\n\n  function compute_new_nodes_pos(anti_clockwise = -1) {\n    let angle = (ROTATE_STEP_SIZE.current * anti_clockwise * Math.PI) / 180;\n    let tmp;\n    for (const id in props.node_ref.current) {\n      const val = props.node_ref.current[id];\n      tmp = props.shift_coord_update_pos(\n        val.x,\n        val.y,\n        props.pivot.current.x,\n        props.pivot.current.y\n      );\n      tmp = props.rotate_point(tmp[0], tmp[1], angle);\n      tmp = props.shift_coord_update_pos(\n        tmp[0],\n        tmp[1],\n        -props.pivot.current.x,\n        -props.pivot.current.y\n      );\n      props.node_ref.current[id].x = tmp[0];\n      props.node_ref.current[id].y = tmp[1];\n    }\n  }\n\n  function adjust_map_position() {\n    props.map_image.current.x(props.map_cord.current.x);\n    props.map_image.current.y(props.map_cord.current.y);\n    props.layer.current && props.layer.current.batchDraw();\n  }\n\n  async function compute_map_corner_pos(anti_clockwise = -1) {\n    let angle = (ROTATE_STEP_SIZE.current * anti_clockwise * Math.PI) / 180;\n    let tmp = props.shift_coord_update_pos(\n      props.map_cord.current.x,\n      props.map_cord.current.y,\n      props.pivot.current.x,\n      props.pivot.current.y\n    );\n    tmp = props.rotate_point(tmp[0], tmp[1], angle);\n    tmp = props.shift_coord_update_pos(\n      tmp[0],\n      tmp[1],\n      -props.pivot.current.x,\n      -props.pivot.current.y\n    );\n    props.map_cord.current = {\n      ...props.map_cord.current,\n      x: tmp[0],\n      y: tmp[1],\n    };\n  }\n\n  function rotate_map(anti_clockwise = -1) {\n    compute_map_corner_pos(anti_clockwise);\n    adjust_map_position();\n    // compute_new_station_pos(anti_clockwise);\n    // compute_new_nodes_pos(anti_clockwise);\n    props.map_image.current.rotate(anti_clockwise * ROTATE_STEP_SIZE.current);\n    props.update_icon_pos();\n    props.redraw_all_routes();\n    props.circle_hide_tool_tip();\n    // tmp_function();\n    if (props.grid_state) {\n      props.clear_grid();\n      props.draw_grid(true);\n    }\n    set_map_angle_input();\n    props.reset_zindex();\n    props.layer.current && props.layer.current.batchDraw();\n  }\n\n  const set_map_image_rotation = (e) => {\n    const step_size = ROTATE_STEP_SIZE.current;\n    const absolute_angle = props.map_image.current.attrs.rotation;\n    ROTATE_STEP_SIZE.current = absolute_angle;\n    rotate_map(-1);\n    ROTATE_STEP_SIZE.current = e.target.value;\n    rotate_map(1);\n    ROTATE_STEP_SIZE.current = step_size;\n    set_map_angle(e.target.value);\n    props.layer.current.batchDraw();\n  };\n\n  const align_tab = () => (\n    <div className=\"map-side-column\">\n      <div className=\"align-map-input-form\">\n        <section className=\"align-map-input-form-section\">\n          <div className=\"align-map-input\">\n            <label className=\"step-size-label\">Step size:</label>\n            <input\n              type=\"number\"\n              onChange={change_step_size}\n              step={0.5}\n              placeholder={ROTATE_STEP_SIZE.current}\n              className=\"step-size-input\"\n            />\n            <p>deg</p>\n          </div>\n        </section>\n        <div className=\"map-editor-rounded-button-div\">\n          <button\n            className=\"map-editor-rounded-button\"\n            onClick={() => rotate_map(1)}\n            title=\"clockwise\"\n          >\n            <img className=\"arrow-clockwise-icon\" src={arrowClockwise} />\n          </button>\n          <button\n            className=\"map-editor-rounded-button\"\n            onClick={() => rotate_map(-1)}\n            title=\"anti-clockwise\"\n          >\n            <img\n              className=\"arrow-anti-clockwise-icon\"\n              src={arrowCounterClockwise}\n            />\n          </button>\n        </div>\n      </div>\n      <section>\n        <label>Total rotation :</label>\n        <input\n          placeholder={map_angle || \"0\"}\n          value={map_angle || \"\"}\n          onChange={set_map_image_rotation}\n          type=\"number\"\n          className=\"total-rotation-input\"\n        />\n      </section>\n    </div>\n  );\n\n  return <div>{align_tab()}</div>;\n}\n\nexport default AlignMap;\n","// import {cloneDeep} from 'lodash';\nexport const remove_node_id_references = (route_ref,tmp_route_details,node_ref,tmp_node_details,node_id) => {\n  \n    // route_ref = cloneDeep(route_ref)\n    // tmp_route_details = cloneDeep(tmp_route_details)\n    // node_ref = cloneDeep(node_ref)\n    // tmp_node_details = cloneDeep(tmp_node_details)\n  \n    node_id = parseInt(node_id);\n    let route_id = tmp_node_details[node_id].route_id;\n    delete tmp_node_details[node_id];\n    tmp_route_details.node.splice(\n      tmp_route_details.node.indexOf(node_id),\n      1\n    );\n    if (route_id in route_ref) {\n      route_ref[route_id].node.splice(\n        route_ref[route_id].node.indexOf(node_id),\n        1\n      );\n    }\n    if (node_id in node_ref)\n      delete node_ref[node_id];\n    return [route_ref,tmp_route_details,node_ref,tmp_node_details]\n};\n\nexport const get_connected_post_process_points = (tmp_route_details,tmp_node_details,node_id_removed=null)=>{\n    let post_process_points = [];\n    let connected_node_found = false;\n    tmp_route_details.node.some(node_id => {\n      if(tmp_node_details[node_id].post_process) post_process_points.push(node_id)\n      else if(parseInt(node_id)===parseInt(node_id_removed)) connected_node_found = true\n      else if(parseInt(node_id)!==parseInt(node_id_removed) && !connected_node_found) post_process_points = []\n      else if(connected_node_found) return true\n    })\n    return post_process_points;\n}\nexport const remove_connected_post_process_points = (\n  route_ref,\n  tmp_route_details,\n  node_ref,\n  tmp_node_details,\n  node_id_removed=null\n) => {\n  // after removing the pp points, it is not drawn, explicty call batchDraw\n  if(node_id_removed){\n    let pp_points = get_connected_post_process_points(\n      tmp_route_details,\n      tmp_node_details,\n      node_id_removed\n    )\n    for(let node_id of pp_points) {\n      let node = tmp_node_details[node_id][\"node\"];\n      node.destroy();\n      [route_ref,\n        tmp_route_details,\n        node_ref,\n        tmp_node_details] = \n      remove_node_id_references(\n        route_ref,\n        tmp_route_details,\n        node_ref,\n        tmp_node_details,\n        node_id\n      )\n    }\n  }\n}","import React, { useEffect, useState, useRef } from \"react\";\nimport Konva from \"konva\";\nimport station_image from \"../../icons/station.svg\";\nimport {\n  CLOCKWISE_ROTATION,\n  MIN_STATION_NAME_LENGTH,\n} from \"../../common/constants\";\nimport { remove_node_id_references } from \"./RouteUtilities\";\n// import {\n// konva_shape_cursor_change,\n// } from \"./MapUtilities\";\nimport { useAlerts } from \"ati-ui\";\n\nfunction AddStations(props) {\n  const [map_x, set_x] = useState(null);\n  const [map_y, set_y] = useState(null);\n  const current_id_ref = useRef(null);\n  const [current_id, set_current_station_id] = useState(null);\n  let circle;\n  let icon_group;\n  let name;\n\n  const imageObj = useRef(new Image());\n\n  const name_input_ref = useRef(null);\n  const edit_name_warning = useRef(null);\n  const edit_name_input_ref = useRef(null);\n  const edit_angle_input_ref = useRef(null);\n  const post_process_ref = useRef(null);\n  const edit_station_tags_ref = useRef(null);\n\n  const inplace_input_ref = useRef(null);\n  const charging_input_ref = useRef(null);\n  const hide_station_ref = useRef(null);\n  const inplace_clockwise_ref = useRef(null);\n  const mode = useRef(\"add_station\");\n  const [mode_state, set_mode_state] = useState(\"add_station\");\n  const [image_loaded, set_image_loaded] = useState(false);\n  const { add_alert, dispatch_remove_alert } = useAlerts();\n\n  // useEffect(() => {\n  //   if (name_input_ref.current) name_input_ref.current.focus();\n  // }, [name_input_ref]);\n\n  useEffect(() => {\n    props.map_image.current.on(\n      \"touch.event2 tap.event2 click.event2\",\n      image_on_click\n    );\n    imageObj.current.src = station_image;\n    imageObj.current.onload = function () {\n      set_image_loaded(true);\n      if (\n        Object.keys(props.station_coord.current).length > 0 &&\n        Object.keys(props.icon_list.current).length === 0\n      ) {\n        draw_saved_stations();\n        props.reset_map_scale();\n      }\n    };\n    return () => {\n      if (props.is_mounted.current) {\n        props.map_image.current.off(\"touch.event2 tap.event2 click.event2\");\n        enable_disable_station_event_listeners(false);\n        edit_mode(false);\n        props.unhighlight_stations();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    reset_selection();\n    edit_mode(mode.current === \"edit_station\");\n    if (mode.current === \"edit_station\") {\n      if (is_station_selected()) {\n        set_inputs();\n        if (edit_name_input_ref.current)\n          edit_name_input_ref.current.value =\n            props.icon_name.current[current_id_ref.current].attrs.text;\n        if (edit_angle_input_ref.current)\n          edit_angle_input_ref.current.value =\n            -props.icon_list.current[current_id_ref.current].attrs.rotation;\n    }\n  }}, [mode_state]);\n\n  useEffect(() => {\n    if(mode.current === \"edit_station\") {\n      update_station_angle_name_charging(current_id_ref.current);\n    }\n  }, [current_id_ref.current])\n\n  function edit_mode(enabled) {\n    Object.keys(props.icon_list.current).forEach((idx) => {\n      props.icon_list.current[idx].draggable(enabled);\n    });\n  }\n\n  const enable_disable_station_event_listeners = (enable = true) => {\n    if (enable) {\n      add_event_listeners_to_stations();\n    } else {\n      remove_event_listeners_to_stations();\n    }\n  };\n\n  const image_on_click = (e) => {\n    if (\n      mode.current === \"add_station\" &&\n      name_input_ref.current.value !== \"\" &&\n      name_input_ref.current.value !== undefined &&\n      !station_name_exists(name_input_ref.current.value) &&\n      !station_name_length_check(name_input_ref.current.value)\n    ) {\n      const stage = e.target.getStage();\n      const stageLocation = stage.getPointerPosition();\n      const station_id = add_station(stageLocation.x, stageLocation.y);\n      current_id_ref.current = station_id;\n      set_current_station_id(station_id);\n      name_input_ref.current.placeholder =\n        props.icon_name.current[station_id].attrs.text;\n      edit_name_warning.current.innerHTML =\n        \"Enter a station name to start adding...\";\n      props.layer.current.batchDraw();\n      edit_angle_input_ref.current.placeholder = props.station_coord.current[station_id].rotation;\n      edit_station_tags_ref.current.placeholder = props.station_coord.current[station_id].station_tags ? props.station_coord.current[station_id].station_tags.toString() : \"\";\n    }\n  };\n\n  const draw_saved_stations = () => {\n    Object.keys(props.station_coord.current).forEach((station_id) => {\n      const station = props.station_coord.current[station_id];\n      add_station(station.x, station.y, station_id);\n    });\n    // props.map_image.current.off(\"touch.event2 tap.event2 click.event2\");\n    enable_disable_station_event_listeners(false);\n    edit_mode(false);\n    props.unhighlight_stations();\n  };\n  const get_new_station_id = () => {\n    let station_id_list = Object.keys(props.station_coord.current);\n    let new_id = parseInt(station_id_list.slice(-1)[0]) + 1;\n    if (!new_id) new_id = 1;\n    return new_id;\n  };\n\n  const add_event_listeners_to_stations = () => {\n    Object.values(props.icon_list.current).forEach((station) => {\n      station.on(\n        \"click.event2 touch.event2 tap.event2 dragstart.event2\",\n        circle_on_tap_dragstart\n      );\n      station.on(\"dragmove.event2\", station_on_drag);\n      station.on(\"dragend.event2\", props.reset_tmp_route_node_path);\n    });\n  };\n\n  const remove_event_listeners_to_stations = () => {\n    Object.values(props.icon_list.current).forEach((station) => {\n      station.off(\n        \"click.event2 touch.event2 tap.event2 dragstart.event2 dragmove.event2 dragend.event2\"\n      );\n    });\n  };\n\n  const is_name_input = () =>\n    Boolean(name_input_ref.current && name_input_ref.current.value !== \"\");\n\n  function add_station(x, y, station_id) {\n    if (is_name_input() || station_id) {\n      mode.current !== \"edit_station\" && edit_mode(false);\n      const id = draw_station(x, y, station_id);\n      props.layer.current.add(icon_group);\n      props.layer.current.add(name);\n      props.layer.current.batchDraw();\n      return id;\n    }\n  }\n\n  const set_x_y = (x_pix, y_pix, station_coord = false) => {\n    if (station_coord) {\n      const [x, y] = props.get_map_coordinate(x_pix, y_pix);\n      set_x(x.toFixed(3));\n      set_y(y.toFixed(3));\n    } else {\n      const [x_untrans, y_untrans] = props.get_untransformed_coordinates(\n        x_pix,\n        y_pix\n      );\n      const [x, y] = props.get_map_coordinate(x_untrans, y_untrans);\n      set_x(x.toFixed(3));\n      set_y(y.toFixed(3));\n    }\n  };\n\n  const set_current_id = (id) => {\n    current_id_ref.current = id;\n    set_current_station_id(id);\n  };\n  const update_inputs_in_edit_mode = (\n    x,\n    y,\n    id,\n    update_x_y = true,\n    station_coord = false\n  ) => {\n    if (update_x_y) {\n      if (station_coord) {\n        const [x_trans, y_trans] = props.get_transformed_coordinates(x, y);\n        props.station_coord.current[id].x = x;\n        props.station_coord.current[id].y = y;\n        props.icon_name.current[id].x(x_trans);\n        props.icon_name.current[id].y(y_trans - props.Y_OFFSET_NAME);\n      } else {\n        const [x_untrans, y_untrans] = props.get_untransformed_coordinates(\n          x,\n          y\n        );\n        props.station_coord.current[id].x = x_untrans;\n        props.station_coord.current[id].y = y_untrans;\n        props.icon_name.current[id].x(x);\n        props.icon_name.current[id].y(y - props.Y_OFFSET_NAME);\n      }\n    }\n    update_inplace_input(id);\n    // update_station_angle_name_charging(id); //moved to useEffect\n  };\n\n  const update_station_angle_name_charging = (id) => {\n    edit_name_input_ref.current && (edit_name_input_ref.current.value = props.icon_name.current[id].attrs.text);\n    edit_angle_input_ref.current && (edit_angle_input_ref.current.value = props.station_coord.current[id].rotation);\n    charging_input_ref.current && (charging_input_ref.current.checked = props.station_coord.current[id].charging);\n    hide_station_ref.current && (hide_station_ref.current.checked = props.station_coord.current[id].hidden);\n    edit_station_tags_ref.current && (edit_station_tags_ref.current.value = props.station_coord.current[id].station_tags ? props.station_coord.current[id].station_tags.toString() : \"\");\n  };\n\n  const update_inplace_input = (id) => {\n    if (inplace_input_ref.current)\n      inplace_input_ref.current.checked =\n        props.station_coord.current[id].inplace;\n    if (inplace_clockwise_ref.current) {\n      inplace_clockwise_ref.current.value =\n        props.station_coord.current[id].clockwise;\n      inplace_clockwise_ref.current.innerHTML =\n        props.station_coord.current[id].clockwise == 1\n          ? \"Clockwise\"\n          : \"Anticlockwise\";\n    }\n    if (post_process_ref.current)\n      post_process_ref.current.checked =\n        props.station_coord.current[id].post_process;\n  };\n\n  const circle_on_tap_dragstart = ({\n    target: {\n      attrs: { id },\n    },\n  }) => {\n    const { x, y } = props.station_coord.current[id];\n    // const [x_untrans, y_untrans] = props.get_untransformed_coordinates(x, y);\n    update_inputs_in_edit_mode(x, y, id, false, true);\n    set_x_y(x, y, true);\n    mode.current === \"edit_station\"\n      ? props.highlight_stations(id)\n      : props.highlight_stations(id, \"orange\");\n    set_current_id(parseInt(id));\n  };\n\n  const redraw_route_on_drag = () => {\n    for (const route_id in props.route_ref.current) {\n      const route = props.route_ref.current[route_id];\n\n      if (\n        parseInt(route.from_station) === parseInt(current_id_ref.current) ||\n        parseInt(route.to_station) === parseInt(current_id_ref.current)\n      ) {\n        props.load_temp_route(route_id);\n\n        props.tmp_route_details.current.line &&\n          props.tmp_route_details.current.line.destroy();\n        props.line.current = props.draw_route(false);\n\n        props.save_temp_route(route_id);\n      }\n    }\n    props.line.current = null;\n  };\n\n  const station_on_drag = ({\n    target: {\n      attrs: { x, y, id },\n    },\n  }) => {\n    props.update_tooltip(x, y);\n    update_inputs_in_edit_mode(x, y, id);\n    set_x_y(x, y);\n    remove_station_post_process_points(parseInt(id));\n    redraw_route_on_drag();\n    props.reset_zindex();\n    props.layer.current.batchDraw();\n  };\n\n  const remove_station_post_process_points = (station_id = null) => {\n    Object.values(props.route_ref.current).forEach((route_details) => {\n      let node_list = route_details.node;\n      if (\n        node_list.length > 0 &&\n        (route_details.from_station == station_id ||\n          route_details.to_station == station_id)\n      ) {\n        let post_process_points = [];\n        let from_station = station_id == route_details.from_station;\n        let node_details = props.node_ref.current;\n        let first_node = null;\n        let last_node = null;\n        for (let node_id of node_list) {\n          if (!node_details[node_id].post_process) {\n            if (!first_node) first_node = node_id;\n            last_node = node_id;\n          }\n        }\n\n        if (from_station && first_node) {\n          post_process_points = node_list.slice(\n            0,\n            node_list.indexOf(first_node)\n          );\n        } else if (!from_station && last_node) {\n          post_process_points = node_list.slice(\n            node_list.indexOf(last_node) + 1\n          );\n        } else {\n          post_process_points = [...node_list];\n        }\n\n        for (let post_process_id of post_process_points) {\n          node_list.splice(node_list.indexOf(post_process_id), 1);\n          delete props.node_ref.current[post_process_id];\n        }\n      }\n    });\n  };\n\n  function draw_station(x, y, station_id) {\n    let station_angle_input_value = parseInt(edit_angle_input_ref.current.value);\n    let new_id = station_id || get_new_station_id();\n\n    function station_rotation() {\n      /*station_id\n        ? -props.station_coord.current[station_id].rotation + props.map_image.current.rotation()\n        : (station_angle_input_value) ? -station_angle_input_value + props.map_image.current.rotation() : -90 + props.map_image.current.rotation() \n      */\n      let rotation;\n      if (station_id) {\n        rotation = -props.station_coord.current[station_id].rotation + props.map_image.current.rotation();\n      } else if (station_angle_input_value) {\n        rotation = (-station_angle_input_value + props.map_image.current.rotation());\n      } else {\n        rotation = (-90 + props.map_image.current.rotation());\n      }\n      return rotation;\n    }\n\n    const group = new Konva.Group({\n      x: x,\n      y: y,\n      draggable: true,\n      dragBoundFunc: function (pos) {\n        let new_y = pos.y;\n        let new_x = pos.x;\n        const stage_width = props.stage.current.width();\n        const stage_height = props.stage.current.height();\n        if (pos.y > stage_height - 10) new_y = stage_height - 10;\n        else if (pos.y < 10) new_y = 10;\n        if (pos.x > stage_width - 10) new_x = stage_width - 10;\n        else if (pos.x < 10) new_x = 10;\n        return {\n          x: new_x,\n          y: new_y,\n        };\n      },\n      id: new_id,\n      rotation: station_rotation(),\n    });\n    const image = new Konva.Image({\n      image: imageObj.current,\n      width: 20,\n      height: 20,\n      offset: {\n        x: 10,\n        y: 10,\n      },\n      id: new_id,\n    });\n\n    // konva_shape_cursor_change(image);\n\n    circle = new Konva.Circle({\n      radius: 20,\n      fill: \"orange\",\n      opacity: 0.5,\n      id: new_id,\n    });\n\n    // konva_shape_cursor_change(circle);\n\n    name = new Konva.Text({\n      x: x,\n      y: y - props.Y_OFFSET_NAME,\n      text: station_id\n        ? props.station_coord.current[station_id].name\n        : name_input_ref.current.value,\n      fontSize: 20,\n      fontFamily: \"Calibri\",\n      id: new_id,\n      fill: \"black\",\n      listening: false\n    });\n\n    group.add(circle);\n    group.add(image);\n\n    icon_group = group;\n\n    if (!station_id) {\n      const [x_untrans, y_untrans] = props.get_untransformed_coordinates(x, y);\n      props.station_coord.current[new_id] = {\n        x: x_untrans,\n        y: y_untrans,\n        name: name_input_ref.current.value,\n        rotation: station_angle_input_value || 90,\n        inplace: inplace_input_ref.current.checked || false,\n        clockwise: inplace_clockwise_ref.current.value || 0,\n        charging: charging_input_ref.current.checked || false,\n        post_process: post_process_ref.current.checked || false,\n        hidden: hide_station_ref.current.checked || false, \n      };\n      inplace_clockwise_button_status();\n      name_input_ref.current.value = \"\";\n      set_x_y(x_untrans, y_untrans, true);\n      set_current_id(new_id);\n      props.layer.current.batchDraw();\n    }\n\n    props.icon_list.current[new_id] = icon_group;\n    props.icon_name.current[new_id] = name;\n\n    props.highlight_stations(new_id, \"orange\");\n    enable_disable_station_event_listeners(false);\n\n    icon_group.on(\n      \"click.event2 touch.event2 tap.event2 dragstart.event2\",\n      circle_on_tap_dragstart\n    );\n    icon_group.on(\"dragmove.event2\", station_on_drag);\n    icon_group.on(\"dragend.event2\", props.reset_tmp_route_node_path);\n    props.add_tooltip_event_listener_to(new_id);\n    return new_id;\n  }\n  const inplace_clockwise_button_status = () => {\n    inplace_clockwise_ref.current.innerHTML =\n      inplace_clockwise_ref.current.value == 1 ? \"Clockwise\" : \"Anticlockwise\";\n  };\n\n  const inplace_change_handler = () => {\n    if (current_id_ref.current) {\n      props.station_coord.current[current_id_ref.current].inplace =\n        inplace_input_ref.current.checked;\n      if (\n        !inplace_input_ref.current.checked &&\n        post_process_ref.current.checked\n      ) {\n        alert(\n          \"In-place must always be selected to enable trolley hitch/release point\"\n        );\n        post_process_ref.current.checked = false;\n        props.station_coord.current[current_id_ref.current].post_process =\n          inplace_input_ref.current.checked;\n      }\n    } else {\n      if (\n        !inplace_input_ref.current.checked &&\n        post_process_ref.current.checked\n      ) {\n        alert(\n          \"In-place must always be selected to enable trolley hitch/release point\"\n        );\n        post_process_ref.current.checked = false;\n      }\n    }\n  };\n\n  const charging_station_change_handler = () => {\n    if (current_id_ref.current) {\n      props.station_coord.current[current_id_ref.current].charging =\n        charging_input_ref.current.checked;\n    }\n  };\n\n  const change_station_hide_handler = () => {\n    if (current_id_ref.current) {\n      props.station_coord.current[current_id_ref.current].hidden =\n        hide_station_ref.current.checked;\n    }\n  };\n\n\n  const inplace_clockwise_handler = (e) => {\n    e.preventDefault();\n    inplace_clockwise_ref.current.value =\n      1 - inplace_clockwise_ref.current.value;\n    inplace_clockwise_button_status();\n    if (current_id_ref.current) {\n      props.station_coord.current[current_id_ref.current].clockwise = parseInt(\n        inplace_clockwise_ref.current.value\n      );\n    }\n  };\n\n  const is_station_selected = () => {\n    if (current_id_ref.current) return true;\n    else return false;\n  };\n\n  const set_inputs = () => {\n    if (current_id_ref.current) {\n      const { x, y, charging, rotation, clockwise, inplace, post_process, hidden } =\n        props.station_coord.current[current_id_ref.current];\n      const [x_map, y_map] = props.get_map_coordinate(x, y);\n      set_x(x_map);\n      set_y(y_map);\n      inplace_clockwise_ref.current.innerHTML =\n        clockwise == 1 ? \"Clockwise\" : \"Anticlockwise\";\n      charging_input_ref.current.checked = charging;\n      post_process_ref.current.checked = post_process;\n      edit_angle_input_ref.current.value = rotation;\n      inplace_input_ref.current.checked = inplace;\n      hide_station_ref.current.checked = hidden;\n    }\n  };\n\n  const hide_inputs_if_name = (e) => {\n    if (e.target.value !== \"\") {\n      set_x(null);\n      set_y(null);\n      inplace_input_ref.current.checked = false;\n      post_process_ref.current.checked = false;\n      edit_angle_input_ref.current.value = 90;\n      edit_angle_input_ref.current.placeholder = 90;\n      inplace_clockwise_ref.current.innerHTML = \"Anticlockwise\";\n    } else {\n      set_inputs();\n    }\n  };\n\n  const hide_inputs = () => {\n    set_x(null);\n    set_y(null);\n    inplace_input_ref.current && (inplace_input_ref.current.checked = false);\n    inplace_clockwise_ref.current &&\n      (inplace_clockwise_ref.current.innerHTML = \"Anticlockwise\");\n    charging_input_ref.current && (charging_input_ref.current.checked = false);\n    post_process_ref.current && (post_process_ref.current.checked = false);\n    edit_angle_input_ref.current && (edit_angle_input_ref.current.value = 90);\n    hide_station_ref.current && (hide_station_ref.current.checked = false);\n    edit_station_tags_ref.current && (edit_station_tags_ref.current = \"\");\n  };\n\n  const reset_selection = () => {\n    current_id_ref.current = null;\n    set_current_station_id(null);\n    hide_inputs();\n  };\n\n  const station_name_exists = (name) => {\n    let exists = false;\n    for (const station_id in props.icon_name.current) {\n      if (props.icon_name.current[station_id].attrs.text === name && station_id !== current_id_ref.current) {\n        exists = true;\n        break;\n      }\n    }\n    return exists;\n  };\n\n  const station_name_length_check = (name) => {\n    let station_length = name.length;\n    if (station_length >= MIN_STATION_NAME_LENGTH) return false;\n    return true;\n  };\n\n  const name_on_change = (e) => {\n    hide_inputs_if_name(e);\n    if (edit_name_warning.current) {\n      if (e.target.value !== \"\") {\n        update_name_on_change_classname(\n          \"\",\n          \"Touch the map to add the station at that position...\"\n        );\n        if (station_name_exists(e.target.value)) {\n          update_name_on_change_classname(\n            \"text-danger\",\n            \"Station name already exists please try a different one\"\n          );\n        } else if (station_name_length_check(e.target.value)) {\n          update_name_on_change_classname(\n            \"text-danger\",\n            \"Station name length must be greater than 2\"\n          );\n        }\n      } else\n        update_name_on_change_classname(\n          \"\",\n          \"Enter a station name to start adding...\"\n        );\n    }\n  };\n\n  const update_name_on_change_classname = (class_name, inner_html) => {\n    edit_name_warning.current.innerHTML = inner_html;\n    edit_name_warning.current.className = class_name;\n  };\n\n  const edit_station_coordinates = (e) => {\n    let value = e.target.value;\n    let x_value;\n    let y_value;\n    if (e.target.id === \"x_coord\") {\n      set_x(value);\n      x_value = parseFloat(value);\n      y_value = parseFloat(map_y);\n      edit_station_coordinates_x_y_draw(x_value, y_value);\n    } else if ((e.target.id = \"y_coord\")) {\n      set_y(value);\n      y_value = parseFloat(value);\n      x_value = parseFloat(map_x);\n      edit_station_coordinates_x_y_draw(x_value, y_value);\n    }\n    redraw_route_on_drag();\n    remove_station_post_process_points(parseInt(current_id_ref.current));\n    props.reset_tmp_route_node_path();\n    props.circle_hide_tool_tip();\n  };\n\n  const post_process_handler = () => {\n    if (inplace_input_ref.current.checked) {\n      if (current_id_ref.current) {\n        props.station_coord.current[current_id_ref.current].post_process =\n          post_process_ref.current.checked;\n      }\n    } else {\n      alert(\"In-place should be enabled to select trolley hitch point\");\n      post_process_ref.current.checked = false;\n    }\n  };\n\n  const edit_station_coordinates_x_y_draw = (x_coord, y_coord) => {\n    if (current_id_ref.current) {\n      const [x, y] = props.get_pixel_coordinate(x_coord || 0, y_coord || 0);\n\n      props.station_coord.current[current_id_ref.current].x = x;\n      props.station_coord.current[current_id_ref.current].y = y;\n      const [x_transform, y_transform] = props.get_transformed_coordinates(\n        x,\n        y\n      );\n      props.icon_name.current[current_id_ref.current].y(\n        y_transform - props.Y_OFFSET_NAME\n      );\n      props.icon_name.current[current_id_ref.current].x(x_transform);\n\n      props.icon_list.current[current_id_ref.current].x(x_transform);\n      props.icon_list.current[current_id_ref.current].y(y_transform);\n      props.reset_zindex();\n      props.layer.current.batchDraw();\n    }\n  };\n\n  const station_x_y = () => (\n    <>\n      <section>\n        <label>x :</label>\n        <input\n          id=\"x_coord\"\n          type=\"number\"\n          step=\"0.005\"\n          placeholder=\"xcoord\"\n          value={map_x === null ? \"\" : map_x}\n          onChange={edit_station_coordinates}\n          className=\"coord-input\"\n        />\n      </section>\n      <section>\n        <label>y :</label>\n        <input\n          id=\"y_coord\"\n          type=\"number\"\n          step=\"0.005\"\n          placeholder=\"ycoord\"\n          value={map_y === null ? \"\" : map_y}\n          onChange={edit_station_coordinates}\n          className=\"coord-input\"\n        />\n      </section>\n    </>\n  );\n  const post_process_required = () => {\n    return (\n      <>\n        <input\n          id=\"post_process\"\n          ref={post_process_ref}\n          onChange={post_process_handler}\n          type=\"checkbox\"\n          defaultChecked={\n            current_id_ref.current &&\n            props.station_coord.current[current_id_ref.current].post_process\n          }\n        />{\" \"}\n        Trolley hitch/release\n      </>\n    );\n  };\n\n  const station_rotation_direction = () => {\n    let inplace_rotation_button_text = \"Anticlockwise\";\n    current_id_ref.current &&\n      props.station_coord.current[current_id_ref.current].clockwise ==\n      CLOCKWISE_ROTATION\n      ? (inplace_rotation_button_text = \"Clockwise\")\n      : (inplace_rotation_button_text = \"Anticlockwise\");\n    return (\n      <>\n        <span className=\"sherpa-rotation-text-container\">\n          <span>Sherpa rotation direction </span>\n          <small>* sherpa entering the station</small>\n        </span>\n        <button\n          className=\"inplace-clockwise\"\n          onClick={inplace_clockwise_handler}\n          ref={inplace_clockwise_ref}\n          value={\n            (current_id_ref.current &&\n              props.station_coord.current[current_id_ref.current].clockwise) ||\n            0\n          }\n        >\n          {inplace_rotation_button_text}\n        </button>\n      </>\n    );\n  };\n\n  const add_stations_tab = () => {\n    const add_station_div = () => (\n      <div className=\"map-side-column\">\n        <form action=\"#\" className=\"input-form\">\n          <input\n            id=\"name\"\n            ref={name_input_ref}\n            type=\"text\"\n            placeholder={\n              is_station_selected()\n                ? get_name_by_id(current_id_ref.current)\n                : \"Station Name\"\n            }\n            onChange={name_on_change}\n          />\n          <small ref={edit_name_warning} className=\"\">\n            Enter a station name to start adding...\n          </small>\n          {station_theta}\n          {station_tags}\n          <section className=\"form-checkbox-input\">\n            {station_rotation_direction()}\n          </section>\n          <section className=\"form-checkbox-input\">\n            {\" \"}\n            <input\n              id=\"inplace\"\n              ref={inplace_input_ref}\n              onChange={inplace_change_handler}\n              type=\"checkbox\"\n              placeholder=\"Station Name\"\n            />{\" \"}\n            Yes, it has an in-place{\" \"}\n          </section>\n          <section className=\"form-checkbox-input\">\n            {post_process_required()}\n          </section>\n          <section className=\"form-checkbox-input\">\n            {\" \"}\n            <input\n              id=\"charging\"\n              ref={charging_input_ref}\n              onChange={charging_station_change_handler}\n              type=\"checkbox\"\n            />{\" \"}\n            Charging station{\" \"}\n          </section>\n          <section className=\"form-checkbox-input\">\n            {\" \"}\n            <input\n              id=\"hide_station\"\n              type=\"checkbox\"\n              ref={hide_station_ref}\n              onChange={change_station_hide_handler}\n            />{\" \"}\n            Hide station{\" \"}\n          </section>\n          {station_x_y()}\n\n          <small className={{ fontSize: \"0.3rem\" }}>\n            * Add a station and drag it to a position\n          </small>\n        </form>\n        {switch_edit_mode_button()}\n      </div>\n    );\n\n    const get_name_by_id = (id) => {\n      if (props.icon_name.current[id])\n        return props.icon_name.current[id].attrs.text;\n    };\n    const get_rotation_by_id = (id) => {\n      if (props.station_coord.current[id]) {\n        return props.station_coord.current[id].rotation;\n      }\n    };\n\n    const get_station_tags_by_id = (id) => {\n      if(props.station_coord.current[id]) {\n        let tags = props.station_coord.current[id].station_tags ? props.station_coord.current[id].station_tags.toString() : \"\"\n        return tags;\n      }\n    }\n\n    const edit_station_name_on_focus = (e) => {\n      e.target.value = get_name_by_id(current_id_ref.current) || \"\";\n    };\n    const edit_station_rotation_on_focus = (e) => {\n      e.target.value = get_rotation_by_id(current_id_ref.current) || \"\";\n    };\n    const edit_station_tags_on_focus = (e) => {\n      e.target.value = get_station_tags_by_id(current_id_ref.current) || \"\";\n    };\n\n\n\n    const edit_station_name = () => {\n      if (current_id_ref.current) {\n        if (station_name_exists(edit_name_input_ref.current.value)) {\n          update_name_on_change_classname(\n            \"text-danger\",\n            \"Station name already exists please try a different one\"\n          );\n        } else if (edit_name_input_ref.current.value === \"\") {\n          update_name_on_change_classname(\n            \"text-danger\",\n            \"Station name can't be empty\"\n          );\n        } else if (\n          station_name_length_check(edit_name_input_ref.current.value)\n        ) {\n          update_name_on_change_classname(\n            \"text-danger\",\n            \"Station name length must be greater than 2\"\n          );\n        } else {\n          update_name_on_change_classname(\"\", \"\");\n          props.icon_name.current[current_id_ref.current].text(\n            edit_name_input_ref.current.value\n          );\n          props.station_coord.current[current_id_ref.current].name =\n            edit_name_input_ref.current.value;\n          props.layer.current.batchDraw();\n        }\n      }\n    };\n\n    const edit_station_rotation = (e) => {\n      if (current_id_ref.current) {\n        let angle = parseInt(e.target.value || 0);\n        if (angle >= -180 && angle <= 180) {\n          props.icon_list.current[current_id_ref.current].rotation(-angle + props.map_image.current.rotation());\n          props.station_coord.current[current_id_ref.current][\"rotation\"] =\n            angle;\n          props.layer.current.batchDraw();\n        } else {\n          add_alert({\n            message: \"Invalid station angle!\",\n            status: \"danger\",\n          });\n        }\n      }\n    };\n\n    const edit_station_tags = (e) => {\n      if (current_id_ref.current) {\n        props.station_coord.current[current_id_ref.current][\"station_tags\"] = [e.target.value];\n      }\n    };\n\n    const station_theta = (\n      <label className=\"station-angle-container\">\n        <small>Station Angle:</small>\n        <input\n          className=\"station-angle-input\"\n          type=\"number\"\n          id=\"theta\"\n          min=\"-180\"\n          max=\"180\"\n          placeholder={get_rotation_by_id(current_id_ref.current)}\n          ref={edit_angle_input_ref}\n          onFocus={edit_station_rotation_on_focus}\n          onChange={edit_station_rotation}\n        />\n      </label>\n    );\n\n    const station_tags = (\n      <label className=\"station-tags-container\">\n        <small>Station Tags:</small>\n        <input\n          className=\"station-tags-input\"\n          type=\"text\"\n          placeholder={get_station_tags_by_id(current_id_ref.current)}\n          ref={edit_station_tags_ref}\n          onFocus={edit_station_tags_on_focus}\n          onChange={edit_station_tags}\n        />\n      </label>\n    );\n\n    const edit_station_div = () => (\n      <div className=\"map-side-column\">\n        {switch_edit_mode_button()}\n        <div className=\"input-form\">\n          {is_station_selected() ? (\n            <>\n              <input\n                id=\"station_name\"\n                placeholder={get_name_by_id(current_id_ref.current) || \"---\"}\n                ref={edit_name_input_ref}\n                onFocus={edit_station_name_on_focus}\n                onKeyUp={edit_station_name}\n              />\n              <small ref={edit_name_warning} className=\"\"></small>\n              {station_theta}\n              {station_tags}\n              <section className=\"form-checkbox-input\">\n                {station_rotation_direction()}\n              </section>\n              <section className=\"form-checkbox-input\">\n                {\" \"}\n                <input\n                  id=\"inplace_edit\"\n                  ref={inplace_input_ref}\n                  onChange={inplace_change_handler}\n                  defaultChecked={\n                    current_id_ref.current &&\n                    props.station_coord.current[current_id_ref.current].inplace\n                  }\n                  type=\"checkbox\"\n                />{\" \"}\n                Yes, it has an in-place{\" \"}\n              </section>\n              <section className=\"form-checkbox-input\">\n                {post_process_required()}\n              </section>\n              <section className=\"form-checkbox-input\">\n                {\" \"}\n                <input\n                  id=\"charging\"\n                  ref={charging_input_ref}\n                  onChange={charging_station_change_handler}\n                  type=\"checkbox\"\n                  defaultChecked={\n                    current_id_ref.current &&\n                    props.station_coord.current[current_id_ref.current].charging\n                  }\n                />{\" \"}\n                Charging station{\" \"}\n              </section>\n              <section className=\"form-checkbox-input\">\n                {\" \"}\n                <input\n                  id=\"hide_station\"\n                  type=\"checkbox\"\n                  ref={hide_station_ref}\n                  onChange={change_station_hide_handler}\n                />{\" \"}\n              Hide station{\" \"}\n              </section>\n              {station_x_y()}\n\n              <button className=\"map-editor-button\" onClick={delete_station}>\n                Delete Station\n              </button>\n            </>\n          ) : (\n            <small>* please select a station first</small>\n          )}\n        </div>\n      </div>\n    );\n\n    const delete_station = (e) => {\n      if (current_id_ref.current) {\n        props.icon_list.current[current_id_ref.current].destroy();\n        props.icon_name.current[current_id_ref.current].destroy();\n\n        delete props.station_coord.current[current_id_ref.current];\n        delete props.icon_list.current[current_id_ref.current];\n        delete props.icon_name.current[current_id_ref.current];\n\n        set_y(null);\n        set_x(null);\n\n        Object.values(props.route_ref.current).forEach((route) => {\n          if (\n            parseInt(current_id_ref.current) === parseInt(route.from_station) ||\n            parseInt(current_id_ref.current) === parseInt(route.to_station)\n          )\n            props.delete_path(route.route_id);\n        });\n\n        current_id_ref.current = null;\n        set_current_station_id(null);\n        edit_angle_input_ref.current.value = null;\n        edit_station_tags_ref.current.value = \"\";\n        edit_name_input_ref.current.value = \"---\";\n        props.tooltip.current && props.tooltip.current.hide();\n\n        props.layer.current.batchDraw();\n      }\n    };\n    const switch_edit_mode_button = () => (\n      <button\n        className=\"edit-mode-button\"\n        onClick={() => {\n          if (mode.current === \"edit_station\") {\n            props.unhighlight_stations();\n            enable_disable_station_event_listeners(false);\n            mode.current = \"add_station\";\n            set_mode_state(\"add_station\");\n          } else if (mode.current === \"add_station\") {\n            props.unhighlight_stations();\n            enable_disable_station_event_listeners();\n            mode.current = \"edit_station\";\n            set_mode_state(\"edit_station\");\n          }\n        }}\n      >\n        {mode.current === \"edit_station\" ? \"+ Add Station\" : \"Edit Station\"}\n      </button>\n    );\n    if (image_loaded) {\n      return (\n        <>\n          {mode.current === \"add_station\" && add_station_div()}\n          {mode.current === \"edit_station\" && edit_station_div()}\n        </>\n      );\n    } else return <>loading...</>;\n  };\n  return <div>{add_stations_tab()}</div>;\n}\n\nexport default AddStations;\n","export const navLinks = {\n  dashboard: [\"sherpa\", \"booking\", \"trips\", \"analytics\"],\n  map_editor: [\"create_map\", \"add_map_attributes\"],\n  users_and_groups: [\"users\", \"roles\"],\n  fleet_management: [],\n  health_monitor: [],\n  master_reset: [],\n};\n\nexport const ROUTE_RADIUS = 1.5;\nexport const SCALING_FACTOR = 50;\nexport const Y_OFFSET_NAME = 50;\n\nexport const INPLACE_THRESHOLD = 0.4;\nexport const CLOCKWISE_ROTATION = 1;\n\nexport const MIN_STATION_NAME_LENGTH = 2;\n","function rad_to_deg(value){\n    return value*180/Math.PI\n}\nfunction adjust_velocity_slight_turns(routes,max_yaw_change = 3.0){\n    let new_routes = []\n    for(let [route, wps] of routes){\n        let new_wps = [];\n        for (let p of wps){\n            let mod_p = p;\n            if(p[0]==='turn'){\n                let yaw1 = Math.atan2(p[2][1],p[2][0])\n                let yaw2 = Math.atan2(p[4][1],p[4][0])\n                if(rad_to_deg(Math.abs(yaw1-yaw2)) < max_yaw_change){\n                    mod_p[-1] = 0\n                }\n            }\n            new_wps.push(mod_p)\n        }\n        new_routes.push([route,new_wps])\n    }\n    return new_routes\n}\nexport default adjust_velocity_slight_turns\n    ","const check_webui_json_file = (reader_result) => {\n  if (reader_result.maps)\n    if (\n      reader_result.maps[0].scale &&\n      reader_result.maps[0].size &&\n      reader_result.maps[0].origin &&\n      reader_result.map_name\n    ) {\n      return true;\n    }\n  return false;\n};\n\nconst check_waypoints_map_editor = (map_editor) => {\n  let object;\n  for (let key in map_editor) {\n    object = map_editor[key];\n    if (Array.isArray(object)) {\n      check_array(object);\n    } else if (typeof object === \"object\") {\n      Object.entries(object).forEach(([key, value]) => {\n        check_object(value);\n      });\n    } else {\n      //! if (typeof object === \"string\" && isFinite(object)) {\n      if (typeof object === \"string\") {\n        let object_num = Number(object);\n        if(isFinite(object_num)) map_editor[key] = Number(object_num);\n      }\n    }\n  }\n  return map_editor;\n};\n\nconst check_array = (array) => {\n  array.forEach((value, index) => {\n    //! if (typeof value === \"string\" && isFinite(value)) {\n    if (typeof value === \"string\") {\n      let num_value = Number(value);\n      if(isFinite(num_value)) array[index] = Number(num_value);\n    }\n  });\n};\n\nconst check_object = (object) => {\n  Object.entries(object).forEach(([key, value]) => {\n    //! if (typeof value === \"string\" && isFinite(value)) {\n    if (typeof value === \"string\") {\n      let num = Number(value);\n      if(isFinite(num)) object[key] = Number(num);\n    } else if (Array.isArray(value)) {\n      check_array(value);\n    }\n  });\n};\n\nconst normalize_angle = (angle) => {\n  const y = Math.sin(angle);\n  const x = Math.cos(angle);\n  return Math.atan2(y, x);\n}\n\n\n//! convert_file_data_to_blob \n// const convert_file_data_to_blob = (filename, data) => {\n  //   const file = new Blob([data], {\n  //     type: \"text/plain;charset=utf-8\",\n  //   });\n  //   const form_data = new FormData();\n  //   form_data.append(filename, file);\n  //   return form_data;\n  // }\n\nexport { check_webui_json_file, check_waypoints_map_editor, normalize_angle };\n\n","import {\n  INPLACE_THRESHOLD,\n  CLOCKWISE_ROTATION,\n} from \"../../../common/constants\";\nimport { normalize_angle } from \"../.../../utils\";\n\nexport function calculate_inplace(\n  line_point,\n  station_theta,\n  clockwise = 0,\n  path_direction = \"forward\",\n  start = false\n) {\n  let line_vec = [\n    line_point[1][1] - line_point[0][1],\n    line_point[1][0] - line_point[0][0],\n  ];\n  if (path_direction === \"reverse\") {\n    line_vec = line_vec.map((val) => -1 * val);\n  }\n  let path_angle = Math.atan2(...line_vec); \n  let station_angle_rad = normalize_angle((station_theta * Math.PI) / 180);\n  let inplace_angle =  start ? normalize_angle(path_angle - station_angle_rad) : normalize_angle(station_angle_rad - path_angle);\n\n  console.log(\"station_angle_rad\", station_angle_rad);\n  console.log(\"path_angle\", path_angle);\n  console.log(\"inplace_angle\", inplace_angle);\n  let add_offset = 0;\n\n  if (Math.abs(inplace_angle) > INPLACE_THRESHOLD) {\n    //If desired inplace angle < 135 degree, we will take the shortest path (preferred angle direction is not enforced)\n    if(Math.abs(inplace_angle) < (3*(Math.PI /4))) {\n      return [\"inplace\", parseFloat(inplace_angle.toFixed(3))];\n    } \n    //Enforcing the preferred inplace direction (inplace angle > 135 degree)\n    if ((clockwise == 1) ^ (inplace_angle < 0)) {\n      add_offset = inplace_angle < 0 ? 1 : -1;\n    }\n    inplace_angle += add_offset * 2 * Math.PI;\n    return [\"inplace\", parseFloat(inplace_angle.toFixed(3))];\n  } else {\n    //No inplace (Too small difference)\n    return false;\n  }\n}\n","import React, { useRef, useState, useEffect } from \"react\";\nimport { Matrix } from \"ml-matrix\";\nimport adjust_velocity_slight_turns from \"./map-editor-components/adjust_velocity_turn.js\";\nimport { construct_edge } from \"./map-editor-components/path_edge.js\";\nimport generate_smooth_path from \"./map-editor-components/generate_smooth_path.js\";\nimport { make_route } from \"./map-editor-components/make_route.js\";\nimport { calculate_inplace } from \"./map-editor-components/calculate_inplace.js\";\nimport { cloneDeep } from \"lodash\";\nimport { check_valid_route_curva } from \"./map-editor-components/check_valid_route_curva.js\";\nimport {\n  check_if_point_in_on_the_line,\n  distance_between,\n  show_hide_selector_line,\n  // get_zindex_of_konva_shape,\n} from \"./MapUtilities\";\nimport {\n  remove_node_id_references,\n  get_connected_post_process_points,\n  remove_connected_post_process_points,\n} from \"./RouteUtilities\";\nimport { ROUTE_RADIUS as RADIUS } from \"../../common/constants\";\nimport { convert_to_radians } from \"../../../src/utilities/genericFunctions\";\nimport arrow_down from \"../../icons/arrow-down.svg\";\nimport { useFetch, pulse_spinner, useAlerts, useAtimodal } from \"ati-ui\";\nimport { api_url } from \"../../conf\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\n\nconst MAP_VERSION = 2\n\nfunction AddRoutes(props) {\n  const [station_1, set_station_1] = useState(\"\");\n  const [station_2, set_station_2] = useState(\"\");\n  const is_station_2_selected = useRef(false);\n  const [route_mode, set_route_mode] = useState(\"add_route\");\n  const [path_selected, set_path] = useState(null);\n  const [radius, set_radius] = useState(0.75);\n  let scale_by = 1.1;\n\n  const input_to_selected = useRef(false);\n  const [input_selected, set_input_selected] = useState(\"from\");\n  const selected_route_id = useRef(null);\n  const show_curve_radius_warning = useRef(null);\n  const download_button_ref = useRef(null);\n  const to_station_id = useRef(null);\n  const from_station_id = useRef(null);\n  const test_line = useRef(null);\n  const webui_stations_data = useRef([]);\n\n\n  const [DownloadModal, show_download_modal, hide_download_modal] =\n    useAtimodal();\n\n  const download_option = useRef({\n    webui_map_json: true,\n    stations_csv: true,\n    stations_attributes_json: true,\n    waypoints_json: true,\n  });\n\n  const STATION_1_COLOR = \"skyblue\";\n  const STATION_2_COLOR = \"aquamarine\";\n  const POST_PROCESS_NODE_COLOR = \"cyan\";\n  const NODE_COLOR = \"orange\";\n  let station_attributes_maping = {};\n  const current_alert_id_ref = useRef(null);\n  const trip_type_ref = useRef([\"multiple\", \"p2p\"]);\n  const current_trip_type = useRef(null);\n  const default_trip_type = useRef(props.trip_type);\n\n  const { add_alert, dispatch_remove_alert } = useAlerts();\n\n  useEffect(() => {\n    remove_line_and_image_event_listener();\n    switch (props.add_delete_mode) {\n      case \"post_process\": {\n        remove_node_delete_event_handler();\n        remove_event_listeners_of_line_not_selected();\n        attach_add_node_event_listener({\n          color: POST_PROCESS_NODE_COLOR,\n          post_process: true,\n        });\n        break;\n      }\n      case \"add\": {\n        remove_node_delete_event_handler();\n        remove_event_listeners_of_line_not_selected();\n        attach_add_node_event_listener({});\n        break;\n      }\n      case \"delete\": {\n        remove_event_listeners_of_line_not_selected();\n        attach_node_delete_event_listeners();\n        break;\n      }\n      case null: {\n        // reattach_event_listeners_after_add_node();\n        remove_node_delete_event_handler();\n        break;\n      }\n    }\n  }, [props.add_delete_mode]);\n\n  const get_node_id_index = (id) => {\n    let idx = 0;\n    for (let node_id of props.tmp_route_details.current.node) {\n      if (node_id === id) {\n        break;\n      } else if (!props.tmp_node_details.current[node_id].post_process) {\n        idx++;\n      }\n    }\n    return idx;\n  };\n\n  const reset_post_process_pos = (id) => {\n    if (id) {\n      props.tmp_node_details.current[id].node.x(\n        props.tmp_node_details.current[id].x\n      );\n      props.tmp_node_details.current[id].node.y(\n        props.tmp_node_details.current[id].y\n      );\n      props.layer.current.batchDraw();\n    }\n  };\n\n  const add_node_event_listener = (node, post_process = false) => {\n    node.on(\n      \"dragmove\",\n      function ({\n        target: {\n          attrs: { x, y, id },\n        },\n      }) {\n        props.circle_hide_tool_tip();\n        let route_id = props.tmp_route_details.current[\"route_id\"];\n        let node_list = props.tmp_route_details.current.node;\n        let node_index = node_list.indexOf(parseInt(id));\n        if (post_process) {\n          if (!isFinite(get_node_index(x, y))) {\n            // alert('Trolly drop/hitch is not on the route')\n            reset_post_process_pos(id);\n            return false;\n          } else {\n            let overlap = false;\n            let req_node_idx = 0;\n            let connecting_node_id;\n\n            if (node_list[node_index - 1]) {\n              connecting_node_id = node_list[node_index - 1];\n              req_node_idx = get_node_id_index(connecting_node_id);\n              let cp_x_y = {\n                x: props.tmp_cp_details.current[req_node_idx * 4 + 2],\n                y: props.tmp_cp_details.current[req_node_idx * 4 + 3],\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n              cp_x_y = {\n                x: props.tmp_cp_details.current[req_node_idx * 4],\n                y: props.tmp_cp_details.current[req_node_idx * 4 + 1],\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n            }\n\n            if (!overlap && node_list[node_index + 1]) { \n              connecting_node_id = node_list[node_index + 1];\n              req_node_idx = get_node_id_index(connecting_node_id);\n              let cp_x_y = {\n                x: props.tmp_cp_details.current[req_node_idx * 4],\n                y: props.tmp_cp_details.current[req_node_idx * 4 + 1],\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n              cp_x_y = {\n                x: props.tmp_cp_details.current[req_node_idx * 4 + 2],\n                y: props.tmp_cp_details.current[req_node_idx * 4 + 3],\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n            }\n\n            if (!overlap && node_list[node_index + 1]) {\n              connecting_node_id = node_list[node_index + 1];\n              // req_node_idx = get_node_id_index(connecting_node_id)\n              let cp_x_y = {\n                x: props.tmp_node_details.current[connecting_node_id].x,\n                y: props.tmp_node_details.current[connecting_node_id].y,\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n            }\n            if (!overlap && node_list[node_index - 1]) {\n              connecting_node_id = node_list[node_index - 1];\n              // req_node_idx = get_node_id_index(connecting_node_id)\n              let cp_x_y = {\n                x: props.tmp_node_details.current[connecting_node_id].x,\n                y: props.tmp_node_details.current[connecting_node_id].y,\n              };\n              if (distance_between(x, y, cp_x_y.x, cp_x_y.y) < 10)\n                overlap = true;\n            }\n\n            if (overlap) {\n              reset_post_process_pos(id);\n              return false;\n            }\n          }\n        }\n\n        if (id in props.tmp_node_details.current) {\n          const [x_untrans, y_untrans] = props.get_untransformed_coordinates(\n            x,\n            y\n          );\n\n          props.tmp_node_details.current[id].x = x_untrans;\n          props.tmp_node_details.current[id].y = y_untrans;\n        }\n\n        if (!post_process) {\n          if (props.line.current) {\n            props.remove_control_points();\n            props.line.current.destroy();\n            props.remove_invalid_turns();\n            props.layer.current.batchDraw();\n          }\n          props.line.current = props.draw_route();\n\n          props.route_ref.current[route_id][\"line\"] = props.line.current;\n          // attach_add_node_event_listener()\n          set_current_route_invalid(props.check_valid_route());\n          attach_event_listener_after_draw_route(props.line.current, route_id);\n          remove_connected_post_process_points(\n            props.route_ref.current,\n            props.tmp_route_details.current,\n            props.node_ref.current,\n            props.tmp_node_details.current,\n            id\n          );\n          props.reset_zindex();\n          props.layer.current.batchDraw();\n          props.set_add_delete_mode(null);\n        }\n      }\n    );\n  };\n\n  const set_current_route_invalid = (invalid) => {\n    props.tmp_route_details.current[\"invalid_route\"] = invalid;\n  };\n\n  const attach_event_listener_after_draw_route = (new_line, route_id) => {\n    new_line.children[1].on(\" click.e1 tap.e1 touch.e1\", () =>\n      route_selected(route_id)\n    );\n    props.highlight_current_line();\n  };\n\n  const attach_add_node_event_listener = ({\n    color = NODE_COLOR,\n    post_process = false,\n  }) => {\n    props.line.current &&\n      props.line.current.on(\"click.e1 tap.e1 touch.e1\", (e) =>\n        target_on_click(e, color, post_process)\n      );\n    // props.map_image.current.on(\"click.e1 tap.e1 touch.e1\", (e) =>\n    //   target_on_click(e, color, post_process)\n    // );\n  };\n\n  const remove_event_listeners_of_line_not_selected = () => {\n    Object.values(props.route_ref.current).forEach((route_details) => {\n      if (route_details.route_id !== props.tmp_route_details.current.route_id)\n        route_details.line.children[1].off(\"click.e1 tap.e1 touch.e1\");\n    });\n  };\n\n  const remove_line_and_image_event_listener = () => {\n    props.line.current && props.line.current.off(\"click.e1 tap.e1 touch.e1\");\n    props.tmp_route_details.current.line &&\n      props.map_image.current.off(\"click.e1 tap.e1 touch.e1\");\n    props.tmp_route_details.current.line &&\n      props.tmp_route_details.current.line.off(\"click.e1 tap.e1 touch.e1\");\n  };\n\n  const enable_disable_station_event_listeners = (enable = true) => {\n    if (enable) {\n      Object.values(props.icon_list.current).forEach((icon) => {\n        icon.on(\"click.e1 tap.e1 touch.e1\", station_selected);\n      });\n    } else {\n      Object.values(props.icon_list.current).forEach((icon) => {\n        icon.off(\"click.e1 tap.e1 touch.e1\");\n      });\n    }\n  };\n\n  const station_selected = ({\n    target: {\n      attrs: { id },\n    },\n  }) => {\n    let station_name = props.icon_name.current[id].attrs.text;\n    if (input_to_selected.current) {\n      to_station_id.current = id;\n      if (!is_station_2_selected.current) is_station_2_selected.current = true;\n      set_station_2(station_name);\n      props.unhighlight_stations();\n      if (from_station_id.current) {\n        props.unhighlight_stations();\n        props.highlight_stations(from_station_id.current, STATION_1_COLOR);\n      }\n      props.highlight_stations(id, STATION_2_COLOR);\n      // is_from_to_inputs_valid();\n    } else {\n      from_station_id.current = id;\n      set_station_1(station_name);\n      !is_station_2_selected.current && highlight_to_input();\n      props.unhighlight_stations();\n      if (to_station_id.current) {\n        props.unhighlight_stations();\n        props.highlight_stations(to_station_id.current, STATION_2_COLOR);\n      }\n      props.highlight_stations(id, STATION_1_COLOR);\n      // is_from_to_inputs_valid();\n    }\n  };\n\n  const is_from_to_inputs_valid = () => {\n    let from_station;\n    let to_station;\n    if (from_station_id.current !== null && to_station_id.current !== null) {\n      props.tmp_route_details.current[\"to_station\"] = to_station_id.current;\n      props.tmp_route_details.current[\"from_station\"] = from_station_id.current;\n      from_station = from_station_id.current;\n      to_station = to_station_id.current;\n    }\n    let is_valid = false;\n    if (from_station && to_station)\n      if (from_station !== to_station) {\n        is_valid = true;\n      } else {\n        alert(\"select two different stations to add a route\");\n      }\n    return is_valid;\n  };\n\n  const highlight_to_input = () => {\n    input_to_selected.current = true;\n    set_input_selected(\"to\");\n  };\n\n  useEffect(() => {\n    show_hide_selector_line({\n      route_ref: props.route_ref.current,\n      show: true,\n    });\n    return async () => {\n      props.route_toggle_ref.current = false;\n      edit_complete();\n      enable_disable_station_event_listeners(false);\n      reset_station_selection();\n      // attach_event_listener_to_image(false, false);\n      props.unhighlight_stations();\n      show_hide_selector_line({\n        route_ref: props.route_ref.current,\n        show: false,\n      });\n      if (current_alert_id_ref.current) {\n        dispatch_remove_alert(current_alert_id_ref.current);\n        current_alert_id_ref.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    props.unhighlight_stations();\n    if (route_mode === \"edit_route\") {\n      enable_disable_station_event_listeners(false);\n      // attach_event_listeners_to_route();\n    } else if (route_mode === \"add_route\") {\n      enable_disable_station_event_listeners();\n      turnoff_route_selected_events();\n    } else {\n      enable_disable_station_event_listeners(false);\n    }\n    // if (route_mode = \"edit_mode\" || route_mode === \"delete_route\") {\n    // attach_event_listener_to_image();\n    // } else {\n    // attach_event_listener_to_image(false);\n    return () => {\n      props.is_mounted.current && turnoff_route_selected_events();\n    };\n  }, [route_mode, props.saved_route_loaded]);\n\n  useEffect(() => {\n    if (route_mode !== \"edit_route\") {\n      props.route_toggle_ref.current = false;\n      edit_complete();\n      props.route_toggle_button_on();\n      props.route_toggle_button_ref.current.style.display = \"none\";\n    }\n    return () => {\n      props.is_mounted.current && props.route_toggle_button_on();\n      props.is_mounted.current &&\n        (props.route_toggle_button_ref.current.style.display = \"none\");\n    };\n  }, [route_mode]);\n\n  const turnoff_route_selected_events = () => {\n    Object.values(props.route_ref.current).forEach((route_details) => {\n      if (route_details.line && route_details.line.children[1])\n        route_details.line.children[1].off(\"click.e1 tap.e1 touch.e1\");\n    });\n  };\n\n  const attach_event_listeners_to_route = () => {\n    Object.values(props.route_ref.current).forEach((route_details) => {\n      if (selected_route_id.current === route_details.route_id) {\n        props.highlight_stations(route_details.from_station, STATION_1_COLOR);\n        props.highlight_stations(route_details.to_station, STATION_2_COLOR);\n      }\n      route_details.line.children[1].on(\"click.e1 tap.e1 touch.e1\", () =>\n        route_selected(route_details.route_id)\n      );\n    });\n  };\n\n  const route_selected = (route_id) => {\n    route_id = parseInt(route_id);\n    route_editor(route_id);\n    Object.values(props.route_ref.current).some((route_details) => {\n      if (parseInt(route_details.route_id) === route_id) {\n        set_station_1(\n          props.icon_name.current[route_details.from_station].attrs.text\n        );\n        props.highlight_stations(route_details.from_station, STATION_1_COLOR);\n\n        set_station_2(\n          props.icon_name.current[route_details.to_station].attrs.text\n        );\n        props.highlight_stations(route_details.to_station, STATION_2_COLOR);\n\n        return true;\n      }\n    });\n  };\n\n  const get_node_index = (x, y) => {\n    let route_points = [\n      props.station_coord.current[props.tmp_route_details.current.from_station]\n        .x,\n      props.station_coord.current[props.tmp_route_details.current.from_station]\n        .y,\n    ];\n    let node_list = props.tmp_route_details.current.node;\n    let node_details = props.tmp_node_details.current;\n    let node_idx = 0;\n    let post_process_count = 0;\n\n    for (let node_id of node_list) {\n      if (node_details[node_id].post_process) {\n        route_points = route_points.concat([\n          node_details[node_id].x,\n          node_details[node_id].y,\n        ]);\n        post_process_count += 1;\n      } else {\n        node_idx = node_list.indexOf(node_id) - post_process_count;\n        // control points is a flattened array of x,y in the order of nodes\n        // there are 2 control points for each node  & thus 4 coordinate points for each node\n        // mul factor 4 is to account for this\n        node_idx *= 4;\n        let points_to_add = props.tmp_cp_details.current.slice(\n          node_idx,\n          node_idx + 4\n        );\n        for (let i = 0; i < points_to_add.length; i = i + 2) {\n          [points_to_add[i], points_to_add[i + 1]] =\n            props.get_untransformed_coordinates(\n              points_to_add[i],\n              points_to_add[i + 1]\n            );\n        }\n        route_points = route_points.concat(points_to_add);\n      }\n    }\n    route_points = route_points.concat([\n      props.station_coord.current[props.tmp_route_details.current.to_station].x,\n      props.station_coord.current[props.tmp_route_details.current.to_station].y,\n    ]);\n    let new_node_indexes = {};\n    let insert_pos = Infinity;\n    let candidate_index;\n    let step_size = post_process_count > 0 ? 2 : 4;\n    for (let i = 0; i <= route_points.length - step_size; i += step_size) {\n      if (\n        check_if_point_in_on_the_line(\n          x,\n          y,\n          route_points[i],\n          route_points[i + 1],\n          route_points[i + 2],\n          route_points[i + 3]\n        )\n      ) {\n        new_node_indexes[i] = {\n          x,\n          y,\n          x1: route_points[i],\n          y1: route_points[i + 1],\n          x2: route_points[i + 2],\n          y2: route_points[i + 3],\n        };\n      }\n    }\n    candidate_index = Object.keys(new_node_indexes);\n    if (candidate_index.length > 1) {\n      insert_pos = parseInt(get_valid_index(new_node_indexes));\n    } else if (candidate_index.length === 1) {\n      insert_pos = parseInt(candidate_index[0]);\n    }\n    return Math.floor((insert_pos + 2) / 4);\n  };\n\n  const is_route_selected = () => {\n    test_line.current = props.line.current;\n    if (props.line.current) return true;\n    else return false;\n  };\n\n  const get_valid_index = (node_index_object) => {\n    let node_index_to_return = null;\n    let dist_diff = null;\n    let temp_node_index;\n    let temp_distance;\n    for (const node_index in node_index_object) {\n      let { x, y, x1, y1, x2, y2 } = node_index_object[node_index];\n      temp_node_index = node_index;\n      temp_distance =\n        distance_between(x1, y1, x, y) +\n        distance_between(x, y, x2, y2) -\n        distance_between(x1, y1, x2, y2);\n      if (dist_diff) {\n        if (temp_distance < dist_diff) {\n          dist_diff = temp_distance;\n          node_index_to_return = temp_node_index;\n        }\n      } else {\n        dist_diff = temp_distance;\n        node_index_to_return = temp_node_index;\n      }\n    }\n    return node_index_to_return;\n  };\n\n  function draw_node(\n    color = \"red\",\n    x,\n    y,\n    on_line = false,\n    post_process = false\n  ) {\n    const [x_untrans, y_untrans] = props.get_untransformed_coordinates(x, y);\n    let node_index = get_node_index(x_untrans, y_untrans);\n    if (post_process && !isFinite(node_index)) {\n      alert(\"Selected point should be on the route\");\n      return false;\n    }\n    let new_id = props.get_id();\n    let tmp_circle = props.get_circle(new_id, color, x, y, 5, !post_process);\n    let tmp_station_name = null;\n    if (props.stage.current) {\n      // create our shape\n      props.tmp_node_details.current[new_id] = {\n        x: x_untrans,\n        y: y_untrans,\n        node: tmp_circle,\n        post_process: post_process,\n        node_id: new_id,\n        route_id: props.tmp_route_details.current.route_id,\n      };\n\n      if (\"node\" in props.tmp_route_details.current) {\n        if (on_line) {\n          node_index = get_node_index(x_untrans, y_untrans);\n          props.tmp_route_details.current[\"node\"].splice(node_index, 0, new_id);\n        } else {\n          props.tmp_route_details.current[\"node\"].push(new_id);\n        }\n      } else {\n        props.tmp_route_details.current[\"node\"] = [new_id];\n      }\n      add_node_event_listener(tmp_circle, post_process);\n      props.layer.current.add(tmp_circle);\n      props.layer.current.batchDraw();\n    }\n    return { tmp_station_name };\n  }\n\n  const is_from_to_selected = () => {\n    if (\n      props.tmp_route_details.current.to_station !== \"\" &&\n      props.tmp_route_details.current.from_station !== \"\"\n    ) {\n      return (\n        props.tmp_route_details.current.from_station > -1 &&\n        props.tmp_route_details.current.to_station > -1\n      );\n    }\n  };\n\n  const add_node = (\n    x,\n    y,\n    on_line,\n    color = NODE_COLOR,\n    post_process = false\n  ) => {\n    if (props.line.current) {\n      draw_node(color, x, y, on_line, post_process);\n      if (!post_process) {\n        props.remove_control_points();\n        redraw_route();\n        set_current_route_invalid(props.check_valid_route());\n      }\n      if (!post_process) {\n        props.remove_control_points();\n        redraw_route(false);\n      }\n      props.reset_zindex();\n      reattach_event_listeners_after_add_node();\n    }\n  };\n\n  const reattach_event_listeners_after_add_node = () => {\n    Object.values(props.route_ref.current).forEach((route_details) => {\n      route_details.line.children[1].on(\"click.e1 tap.e1 touch.e1\", () =>\n        route_selected(route_details.route_id, true)\n      );\n    });\n  };\n  const check_route = (route, current_from, current_to) => {\n    let [route_from, route_to] = [\n      props.route_ref.current[route].from_station,\n      props.route_ref.current[route].to_station,\n    ];\n    return (\n      parseInt(current_from) === parseInt(route_from) &&\n      parseInt(current_to) === parseInt(route_to)\n    );\n  };\n  const already_a_route = (from, to) => {\n    let is_route_already_present = false;\n    if (Object.keys(props.route_ref.current).length > 0)\n      for (const route in props.route_ref.current) {\n        if (check_route(route, from, to)) {\n          is_route_already_present = true;\n          break;\n        }\n      }\n    return is_route_already_present;\n  };\n\n  const check_route_post_process = () => {\n    let pp_added = false;\n    if (props.tmp_node_details.current) {\n      Object.values(props.tmp_node_details.current).some((node_details) => {\n        pp_added = node_details.post_process;\n        return pp_added;\n      });\n    }\n    return pp_added;\n  };\n\n  const draw_return_route = () => {\n    const from_station = props.tmp_route_details.current.from_station;\n    const to_station = props.tmp_route_details.current.to_station;\n\n    let ref_route = [];\n    if (Object.keys(props.route_ref.current).length > 0)\n      for (const route in props.route_ref.current) {\n        // checking route with inverted from and to\n        if (check_route(route, to_station, from_station)) {\n          ref_route = props.route_ref.current[route];\n          break;\n        }\n      }\n    let i;\n    const nodes = ref_route.node || [];\n    const radius = ref_route.radius || RADIUS;\n    const direction = ref_route.direction || \"forward\";\n\n    draw_straight_route(radius, direction);\n    for (i = nodes.length - 1; i >= 0; i--) {\n      const node = nodes[i];\n      const ref_node = props.node_ref.current[node];\n      const [x_trans, y_trans] = props.get_transformed_coordinates(\n        ref_node.x,\n        ref_node.y\n      );\n      add_node(x_trans, y_trans, true);\n    }\n  };\n\n  const draw_straight_route = (radius = RADIUS, direction = \"forward\") => {\n    props.tmp_route_details.current[\"node\"] = [];\n    props.tmp_route_details.current[\"radius\"] = radius;\n    props.tmp_route_details.current[\"direction\"] = direction;\n    props.line.current = props.draw_route();\n    // route_editor(edit_complete(false));\n    const route_id = edit_complete(false);\n    set_route_mode(\"edit_route\");\n    route_selected(route_id);\n  };\n\n  const add_route = async () => {\n    if (is_from_to_inputs_valid()) {\n      if (\n        !already_a_route(\n          props.tmp_route_details.current.from_station,\n          props.tmp_route_details.current.to_station\n        )\n      ) {\n        if (is_from_to_selected()) {\n          if (\n            already_a_route(\n              props.tmp_route_details.current.to_station,\n              props.tmp_route_details.current.from_station\n            )\n          ) {\n            if (current_alert_id_ref.current) {\n              dispatch_remove_alert(current_alert_id_ref.current);\n              current_alert_id_ref.current = null;\n            }\n            current_alert_id_ref.current = await add_alert({\n              message: `You have already added a route from ${props.tmp_route_details.current.to_station} to ${props.tmp_route_details.current.from_station}\n              \\n click here to mirror the route or cancel to draw a default route`,\n              status: \"info\",\n              on_click: draw_return_route,\n              on_cancel: draw_straight_route,\n            });\n          } else {\n            draw_straight_route();\n          }\n        } else alert(\"select two stations\");\n      } else {\n        alert(\"route already present!!!\");\n        reset_station_selection();\n        props.unhighlight_stations();\n      }\n    }\n  };\n\n  const route_select_dropdown = () => (\n    <select\n      className=\"routes-drop-down\"\n      onChange={(e) => route_selection_handler(e.target.value)}\n      value={\n        station_1 == \"\" && station_2 == \"\" ? -99 : selected_route_id.current\n      }\n    >\n      <option value={-99}></option>\n      {Object.entries(props.route_ref.current).map(([id, route_details]) => (\n        <option value={route_details.route_id} key={id}>\n          {\" \"}\n          {`${props.icon_name.current[route_details.from_station].attrs.text\n            }->${props.icon_name.current[route_details.to_station].attrs.text}`}\n        </option>\n      ))}\n    </select>\n  );\n\n  const edit_route_select = () => {\n    return (\n      <div className=\"edit-route-input\">\n        <label className=\"select-route-dropdown-label\">\n          Select a route to edit\n        </label>\n        {route_select_dropdown()}\n        <label className=\"route-selection-choice\">Or</label>\n        <label className=\"edit-route-input-label\">\n          Click on a route to start editing it\n        </label>\n        <input\n          readOnly\n          type=\"text\"\n          className=\"edit-route-input-select edit-route-input-select-from\"\n          placeholder=\"From\"\n          value={station_1}\n        />\n        <img src={arrow_down}></img>\n        <input\n          readOnly\n          type=\"text\"\n          className=\"edit-route-input-select edit-route-input-select-to\"\n          placeholder=\"To\"\n          value={station_2}\n        />\n      </div>\n    );\n  };\n\n  const remove_current_route_node_icon = () => {\n    if (\n      props.tmp_route_details.current &&\n      props.tmp_route_details.current.node\n    ) {\n      props.tmp_route_details.current.node.forEach((id) => {\n        props.tmp_node_details.current[id].node &&\n          props.tmp_node_details.current[id].node.destroy();\n        props.layer.current.batchDraw();\n      });\n    }\n  };\n\n  const unhighlight_current_line = () => {\n    const [line1, line2] = props.line.current.children;\n    if (line1) {\n      line1.stroke(\"black\");\n      line1.strokeWidth(2);\n    }\n  };\n\n  const reset_unsaved_route = () => {\n    let route_id = props.tmp_route_details.current.route_id;\n    props.remove_control_points();\n    remove_current_route_node_icon();\n    props.line.current && props.line.current.destroy();\n    props.remove_invalid_turns();\n    test_line.current = null;\n\n    props.tmp_route_details.current.node = cloneDeep(\n      props.reference_route_ref.current.node\n    );\n    props.tmp_route_details.current.radius =\n      props.reference_route_ref.current.radius;\n    props.reference_route_ref.current.node.forEach((id) => {\n      const node = props.reference_route_ref.current.node_ref[id];\n      if (id in props.tmp_node_details.current) {\n        props.tmp_node_details.current[id].x = node.x;\n        props.tmp_node_details.current[id].y = node.y;\n      } else {\n        props.tmp_node_details.current[id] = cloneDeep(node);\n      }\n    });\n    const invalid_route = props.reference_route_ref.current.invalid_route;\n    props.tmp_route_details.current[\"invalid_route\"] = invalid_route;\n    // if (route_id)\n    props.route_ref.current[route_id][\"line\"] = props.draw_route(false);\n    props.line.current = props.route_ref.current[route_id][\"line\"];\n    // props.reset_tmp_route_node_path();\n    route_editor(edit_complete(false));\n    props.highlight_stations(\n      props.tmp_route_details.current[\"from_station\"],\n      STATION_1_COLOR\n    );\n    props.highlight_stations(\n      props.tmp_route_details.current[\"to_station\"],\n      STATION_2_COLOR\n    );\n    props.layer.current.batchDraw();\n  };\n\n  const edit_complete = (reset_station_inputs = true) => {\n    if (props.line.current) {\n      let route_id = get_route_id();\n      props.line.current[\"route_id\"] = route_id;\n      props.save_temp_route(route_id);\n      props.remove_control_points();\n      unhighlight_current_line();\n      remove_current_route_node_icon();\n      props.layer.current.batchDraw();\n      remove_line_and_image_event_listener();\n      props.set_add_delete_mode(null);\n      // attach_event_listeners_to_route();\n      props.unhighlight_stations();\n      props.reset_tmp_route_node_path();\n      props.set_route_added((state) => state + 1);\n      set_path(null);\n      set_radius(\"\");\n      reset_station_inputs && reset_station_selection();\n      props.reference_route_ref.current !== null &&\n        props.reference_route_ref.current.line.destroy();\n      props.reference_route_ref.current = null;\n      props.redraw_all_routes(!props.route_toggle_ref.current);\n      props.reset_zindex();\n      return route_id;\n    }\n  };\n\n  const reset_station_selection = () => {\n    set_station_1(\"\");\n    set_station_2(\"\");\n    to_station_id.current = null;\n    from_station_id.current = null;\n    selected_route_id.current = null;\n    // props.tmp_route_details.current[\"from_station\"] = \"\";\n    // props.tmp_route_details.current[\"to_station\"] = \"\";\n    input_to_selected.current = false;\n    is_station_2_selected.current = false;\n  };\n\n  const get_route_id = () => {\n    let route_id =\n      \"route_id\" in props.tmp_route_details.current\n        ? props.tmp_route_details.current.route_id\n        : props.get_id();\n    return route_id;\n  };\n\n  const add_nodes_to_route = () => {\n    Object.entries(props.tmp_node_details.current).forEach(\n      ([node_id, node_details]) => {\n        const [x_trans, y_trans] = props.get_transformed_coordinates(\n          props.node_ref.current[node_id].x,\n          props.node_ref.current[node_id].y\n        );\n        let node = props.get_circle(\n          node_id,\n          node_details.post_process ? POST_PROCESS_NODE_COLOR : NODE_COLOR,\n          x_trans,\n          y_trans,\n          5,\n          !node_details.post_process\n        );\n        props.tmp_node_details.current[node_id][\"node\"] = node;\n        add_node_event_listener(node, node_details.post_process);\n        props.layer.current.add(node);\n      }\n    );\n  };\n  const route_selection_handler = (route_id) => {\n    if (route_id >= 0) {\n      set_station_1(\n        props.icon_name.current[props.route_ref.current[route_id].from_station]\n          .attrs.text\n      );\n      set_station_2(\n        props.icon_name.current[props.route_ref.current[route_id].to_station]\n          .attrs.text\n      );\n      route_selected(route_id);\n    } else {\n      set_station_1(\"\");\n      set_station_2(\"\");\n      edit_complete();\n    }\n    props.set_add_delete_mode(null);\n  };\n  const route_editor = async (route_id = null) => {\n    props.unhighlight_stations();\n    edit_complete(false);\n    if (route_id >= 0) {\n      remove_current_route_node_icon();\n      props.load_temp_route(route_id);\n      add_nodes_to_route();\n      props.draw_control_points();\n      props.line.current = props.tmp_route_details.current.line;\n      props.reference_route_ref.current = cloneDeep(\n        props.tmp_route_details.current\n      );\n\n      const node_ref_clone = cloneDeep(props.node_ref.current);\n      let node_ref_temp_save = {};\n      props.reference_route_ref.current.node.forEach((node_id) => {\n        node_ref_temp_save[parseInt(node_id)] = node_ref_clone[node_id];\n      });\n\n      props.reference_route_ref.current[\"node_ref\"] = node_ref_temp_save;\n\n      props.reference_route_ref.current[\"line\"] = props.draw_route(false, true);\n      props.redraw_all_routes(!props.route_toggle_ref.current);\n      set_path(props.tmp_route_details.current.path);\n      set_radius(props.tmp_route_details.current.radius);\n      selected_route_id.current = route_id;\n      props.reset_zindex();\n    }\n  };\n\n  const delete_path_event_callback = (route_id) => {\n    let path = props.route_ref.current[route_id];\n    let stations = [path.from_station, path.to_station];\n    path.line.children[1].off(\"click.e1 tap.e1 touch.e1\");\n    let delete_confirm =\n      window.confirm(`Are you sure to delete the selected route:'\n    ${props.station_coord.current[stations[0]].name} -> ${props.station_coord.current[stations[1]].name\n        }`);\n    if (delete_confirm && path.route_id >= 0) {\n      set_station_1(\"\");\n      set_station_2(\"\");\n      props.delete_path(path.route_id);\n      props.reference_route_ref.current !== null &&\n        props.reference_route_ref.current.line.destroy();\n      props.reference_route_ref.current = null;\n      props.remove_invalid_turns();\n      props.unhighlight_stations();\n      props.set_add_delete_mode(null);\n    } else {\n      props.remove_path_event_listeners();\n      props.set_add_delete_mode(null);\n    }\n  };\n\n  // const attach_path_event_listeners = () => {\n  //   Object.values(props.route_ref.current).forEach((details) => {\n  //     details.line.children[1].on(\"click.e1 tap.e1 touch.e1\", (_) =>\n  //       delete_path_event_callback(details.route_id)\n  //     );\n  //   });\n  //   props.set_add_delete_mode(\"delete_route\");\n  // };\n\n  const redraw_route = (remove_invalid = true) => {\n    const route_id = props.tmp_route_details.current.route_id;\n    props.line.current && props.line.current.destroy();\n    remove_invalid && props.remove_invalid_turns();\n    if (\n      route_id in props.route_ref.current &&\n      \"line\" in props.route_ref.current[route_id]\n    ) {\n      props.line.current = props.draw_route();\n      props.route_ref.current[route_id][\"line\"] = props.line.current;\n      attach_event_listener_after_draw_route(props.line.current, route_id);\n    }\n  };\n\n  const remove_node_redraw_route = (node_id) => {\n    let node = props.tmp_node_details.current[node_id][\"node\"];\n    node.destroy();\n    props.remove_control_points();\n    remove_connected_post_process_points(\n      props.route_ref.current,\n      props.tmp_route_details.current,\n      props.node_ref.current,\n      props.tmp_node_details.current,\n      node_id\n    );\n    [\n      props.route_ref.current,\n      props.tmp_route_details.current,\n      props.node_ref.current,\n      props.tmp_node_details.current,\n    ] = remove_node_id_references(\n      props.route_ref.current,\n      props.tmp_route_details.current,\n      props.node_ref.current,\n      props.tmp_node_details.current,\n      node_id\n    );\n    redraw_route();\n    reattach_event_listeners_after_add_node();\n    set_current_route_invalid(props.check_valid_route());\n    props.remove_control_points();\n    redraw_route(false);\n    props.reset_zindex();\n    props.set_add_delete_mode(null);\n  };\n\n  const remove_node_delete_event_handler = () => {\n    Object.values(props.tmp_node_details.current).forEach((node_details) => {\n      node_details.node && node_details.node.off(\"click.e1 tap.e1 touch.e1\");\n    });\n  };\n  const attach_node_delete_event_listeners = () => {\n    if (Object.keys(props.tmp_node_details.current).length === 0) {\n      alert(\"no nodes present\");\n      return;\n    }\n    Object.entries(props.tmp_node_details.current).forEach(\n      ([node_id, node_detail]) => {\n        if (\"node\" in node_detail) {\n          node_detail.node.on(\"click.e1 tap.e1 touch.e1\", (e) => {\n            if (node_detail.post_process) {\n              node_detail.node.destroy();\n              remove_node_id_references(\n                props.route_ref.current,\n                props.tmp_route_details.current,\n                props.node_ref.current,\n                props.tmp_node_details.current,\n                node_id\n              );\n              props.layer.current.batchDraw();\n              props.set_add_delete_mode(null);\n            } else {\n              remove_node_redraw_route(node_id);\n            }\n          });\n        }\n      }\n    );\n  };\n\n  const target_on_click = (e, color = NODE_COLOR, post_process = false) => {\n    const stage = e.target.getStage();\n    const stageLocation = stage.getPointerPosition();\n    add_node(stageLocation.x, stageLocation.y, true, color, post_process);\n    props.set_add_delete_mode(null);\n  };\n\n  const add_node_at_x_y = ({ color = NODE_COLOR, post_process = false }) => {\n    if (post_process && check_route_post_process()) {\n      alert(\"Route already has a trollery hitch/drop point\");\n      return false;\n    }\n\n    if (props.tmp_route_details.current.line) {\n      post_process\n        ? props.set_add_delete_mode(\"post_process\")\n        : props.set_add_delete_mode(\"add\");\n    } else {\n      alert(\"please select a route\");\n    }\n  };\n\n  const add_route_input_selected = (e) => {\n    if (e.target.id === \"from\") {\n      input_to_selected.current = false;\n      set_input_selected(\"from\");\n    } else if (e.target.id === \"to\") {\n      input_to_selected.current = true;\n      set_input_selected(\"to\");\n    }\n  };\n\n  const utils = () => {\n    const prepare_options = () => {\n      return Object.keys(props.station_coord.current).map((station_id, index) => (\n        <option key={index} value={station_id}>\n          {props.station_coord.current[station_id].name}\n        </option>\n      ));\n    };\n\n    const prepare_trip_type = () => {\n      return trip_type_ref.current.map((type, index) => (\n        <option key={index} value={type}>\n          {type}\n        </option>\n      ));\n    };\n\n    const get_common_dispatch_station = () => {\n      let common_dispatch_station;\n      Object.keys(props.station_coord.current).every((station_id) => {\n        const station = props.station_coord.current[station_id];\n        if (station.common_dispatch_station) {\n          common_dispatch_station = { ...station, id: station_id };\n          return false;\n        } else return true;\n      });\n      return common_dispatch_station;\n    };\n\n    const get_empty_trolley_station = () => {\n      let empty_trolley_station;\n      Object.keys(props.station_coord.current).every((station_id) => {\n        const station = props.station_coord.current[station_id];\n        if (station.empty_trolley_station) {\n          empty_trolley_station = { ...station, id: station_id };\n          return false;\n        } else return true;\n      });\n      return empty_trolley_station;\n    };\n\n\n    const set_common_dispatch_station = (station_id) => {\n      const current_dispatch_station = get_common_dispatch_station();\n      current_dispatch_station &&\n        delete props.station_coord.current[current_dispatch_station.id][\n        \"common_dispatch_station\"\n        ];\n      props.station_coord.current[station_id][\"common_dispatch_station\"] = true;\n    };\n\n    const set_empty_trolley_station = (station_id) => {\n      const current_empty_trolley_station = get_empty_trolley_station();\n      current_empty_trolley_station &&\n        delete props.station_coord.current[current_empty_trolley_station.id][\n        \"empty_trolley_station\"\n        ];\n      props.station_coord.current[station_id][\"empty_trolley_station\"] = true;\n    };\n\n\n    const on_station_select = (e) => {\n      const value = e.target.value;\n      value && set_common_dispatch_station(value);\n    };\n\n    const on_empty_station_select = (e) => {\n      const value = e.target.value;\n      value && set_empty_trolley_station(value);\n    }\n\n    const on_trip_type_select = (e) => {\n      const value = e.target.value;\n      value && (current_trip_type.current = value);\n    }\n\n    const current_dispatch_station = get_common_dispatch_station();\n    const current_empty_trolley_station = get_empty_trolley_station();\n\n    return (\n      <div className=\"input-form\">\n        <h4 style={{ color: \"#01051B\", textAlign: \"center\" }}>Utilities</h4>\n        <section className=\"commom-dispatch-container\">\n          <label className=\"select-route-dropdown-label\">\n            Trip Type\n          </label>\n          <select defaultValue={\"default\"} className=\"routes-drop-down\" onChange={on_trip_type_select}>\n            <option value=\"default\" disabled>{`Default trip type: ${props.trip_type}`}</option>\n            {prepare_trip_type()}\n          </select>\n        </section>\n        <section className=\"commom-dispatch-container\">\n          <label className=\"select-route-dropdown-label\">\n            Common dispatch station\n          </label>\n          <select defaultValue={\"default\"} className=\"routes-drop-down\" onChange={on_station_select}>\n            {/* <option disabled selected>\n                {current_dispatch_station\n                  ? current_dispatch_station.name\n                  : \"Please select a common dispatch station\"}\n              </option> */}\n            <option value=\"default\" disabled>{current_dispatch_station\n              ? current_dispatch_station.name\n              : \"Please select a common dispatch station\"}</option>\n            {prepare_options()}\n          </select>\n        </section>\n        <section className=\"commom-dispatch-container\">\n          <label className=\"select-route-dropdown-label\">\n            empty trolley station\n          </label>\n          <select defaultValue={\"default\"} className=\"routes-drop-down\" onChange={on_empty_station_select}>\n            <option value=\"default\" disabled>{current_empty_trolley_station\n              ? current_empty_trolley_station.name\n              : \"Please select a empty trolley station\"}</option>\n            {prepare_options()}\n          </select>\n        </section>\n        {download_button()}\n        <DownloadModal>{download_files_popup()}</DownloadModal>\n        {/* {upload_button()} */}\n      </div>\n    );\n  };\n\n  const update_download_files_state = (e) => {\n    const target = e.target;\n    download_option.current = {\n      ...download_option.current,\n      [target.dataset.file]: target.checked,\n    };\n  };\n\n  useEffect(() => { }, [download_option]);\n\n  const download_files_popup = () => {\n    const files = [\n      \"webui_map_json\",\n      \"waypoints_json\",\n      \"stations_csv\",\n      \"stations_attributes_json\",\n    ];\n    const checkbox_inputs = files.map((file_type, index) => (\n      <section key={index}>\n        <label>{file_type}</label>\n        <input\n          data-file={file_type}\n          key={index}\n          onChange={update_download_files_state}\n          type=\"checkbox\"\n          defaultChecked={download_option.current[file_type]}\n        />\n      </section>\n    ));\n    return (\n      <div className=\"download-modal\">\n        {checkbox_inputs}\n        <button\n          onClick={() => {\n            download();\n          }}\n        >\n          Download Files\n        </button>\n      </div>\n    );\n  };\n\n  const check_routes = () => {\n    let invalid_routes_list = Object.values(props.route_ref.current);\n    for (let i = 0; i < invalid_routes_list.length; i++) {\n      if (invalid_routes_list[i][\"invalid_route\"]) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  const download = () => {\n    const stations_csv = generate_stations_csv_file();\n    download_option.current.stations_csv &&\n      download_file(stations_csv, \"stations.csv\");\n\n    download_option.current.stations_attributes_json &&\n      download_file(\n        JSON.stringify(generate_station_attributes_data()),\n        \"station_attributes.json\"\n      );\n\n    download_option.current.webui_map_json &&\n      download_file(\n        JSON.stringify(generate_webui_map_json_stations()),\n        \"webui_map.json\"\n      );\n\n    download_option.current.waypoints_json &&\n      download_file(JSON.stringify(generate_waypoints_file()), \"waypoints.json\");\n\n    download_button_ref.current.disable = false;\n    hide_download_modal();\n  };\n\n  const download_files = () => {\n    download_button_ref.current.disable = true;\n    props.route_toggle_ref.current = false;\n    edit_complete();\n    props.route_toggle_button_on();\n    let invalid_route = check_routes();\n    if (invalid_route) {\n      add_alert({\n        message:\n          \"Invalid routes found!\\n\\n It is recommended to recheck the routes.\\n\\n Click here if you still want to download files.\",\n        status: \"danger\",\n        on_click: show_download_modal,\n      });\n    } else {\n      show_download_modal();\n    }\n  };\n\n  const download_button = () => (\n    <button\n      className=\"map-editor-button\"\n      ref={download_button_ref}\n      onClick={download_files}\n    >\n      Download Files\n    </button>\n  );\n\n  const upload_button = () => (\n    <button\n      className=\"map-editor-button upload-button\"\n      ref={download_button_ref}\n      onClick={() => {\n        download_button_ref.current.disable = true;\n        props.route_toggle_ref.current = false;\n        edit_complete();\n        props.route_toggle_button_on();\n        let upload_data = {\n          stations_csv: generate_stations_csv_file(),\n          // station_attributes_json: generate_station_attributes_data(),\n          waypoints_json: generate_waypoints_file(),\n          webui_map_json: generate_webui_map_json_stations(),\n        };\n        upload_files(upload_data);\n        download_button_ref.current.disable = false;\n      }}\n    >\n      {upload_loading ? pulse_spinner : \"Upload Files\"}\n    </button>\n  );\n\n  const add_route_div = () => (\n    <div className=\"input-form\">\n      <section className=\"add-route-station-input-section\">\n        <label>Click the station in map begin the route.</label>\n        <input\n          readOnly\n          type=\"text\"\n          className=\"add-route-station-input-from\"\n          id=\"from\"\n          value={station_1}\n          onClick={add_route_input_selected}\n          placeholder=\"From\"\n          style={\n            !input_to_selected.current ? { background: STATION_1_COLOR } : {}\n          }\n        />\n        <label>Click the station to end route.</label>\n        <input\n          readOnly\n          type=\"text\"\n          className=\"add-route-station-input-to\"\n          id=\"to\"\n          value={station_2}\n          onClick={add_route_input_selected}\n          placeholder=\"To\"\n          style={\n            input_to_selected.current ? { background: STATION_2_COLOR } : {}\n          }\n        />\n      </section>\n      <button className=\"map-editor-button\" onClick={add_route}>\n        Add Route\n      </button>\n    </div>\n  );\n\n  const radius_change_handler = (e) => {\n    e.preventDefault();\n    let radius_value = parseFloat(e.target.value);\n    // if (radius_value >= 0.75) {\n    // show_curve_radius_warning.current.innerHTML =\n    //   \"*Minimum curve radius is 0.75 meters\";\n    // show_curve_radius_warning.current.className = \"\";\n    props.tmp_route_details.current.radius = parseFloat(e.target.value);\n    set_radius(e.target.value);\n    props.remove_control_points();\n    redraw_route();\n    props.highlight_current_line();\n    // } else show_curve_radius_warning_text();\n    props.set_add_delete_mode(null);\n    props.reset_zindex();\n  };\n\n  const show_curve_radius_warning_text = () => {\n    props.tmp_route_details.current.radius = \"0.75\";\n    set_radius(0.75);\n    show_curve_radius_warning.current.innerHTML =\n      \"Curve radius can't be less than 0.75 meters\";\n    show_curve_radius_warning.current.className = \"text-danger\";\n  };\n\n  const path_type = (e) => {\n    let type = e.target.checked ? \"forward\" : \"reverse\";\n    props.tmp_route_details.current.direction = type;\n    set_path(type);\n  };\n\n  const edit_route_buttons = () => (\n    <>\n      <section className=\"form-checkbox-input\">\n        <input\n          id=\"forward\"\n          type=\"checkbox\"\n          onChange={path_type}\n          checked={\n            props.tmp_route_details.current.direction === \"forward\"\n              ? true\n              : false\n          }\n        />{\" \"}\n        Forward route{\" \"}\n      </section>\n      <section className=\"form-checkbox-input\">\n        Curve Radius:\n        <input\n          className=\"input-radius\"\n          onChange={radius_change_handler}\n          id=\"path_radius\"\n          type=\"number\"\n          value={props.tmp_route_details.current.radius || radius}\n          step={0.01}\n        />\n        metres\n      </section>\n      {/* <small ref={show_curve_radius_warning}>\n        *Minimum curve radius is 0.75 meters\n      </small> */}\n      <div className=\"add-delete-node-div\">\n        <label>Click on a route to start adding nodes</label>\n        <button\n          className=\"btn map-editor-button\"\n          onClick={() => {\n            // props.set_add_delete_mode(null);\n            add_node_at_x_y({});\n          }}\n          style={\n            props.add_delete_mode === \"add\"\n              ? { background: \"cyan\", color: \"#000\" }\n              : {}\n          }\n        >\n          Add Node\n        </button>\n      </div>\n      <div className=\"add-delete-node-div\">\n        <label>Add Trolley hitch/release point</label>\n        <button\n          className=\"btn map-editor-button\"\n          onClick={() => {\n            // props.set_add_delete_mode(null);\n            add_node_at_x_y({\n              color: POST_PROCESS_NODE_COLOR,\n              post_process: true,\n            });\n          }}\n          style={\n            props.add_delete_mode === \"post_process\"\n              ? { background: \"cyan\", color: \"#000\" }\n              : {}\n          }\n        >\n          Add Pause\n        </button>\n      </div>\n      <div className=\"add-delete-node-div\">\n        <button\n          className=\"btn map-editor-button\"\n          onClick={() => {\n            props.set_add_delete_mode(\"delete\");\n          }}\n          style={\n            props.add_delete_mode === \"delete\"\n              ? { background: \"indianred\", color: \"#000\" }\n              : {}\n          }\n        >\n          {\" \"}\n          Remove Node/Pause\n        </button>\n      </div>\n      {/* <div>\n        <div className=\"add-delete-node-div\">\n          <label style={{ textAlign: \"center\" }}>\n            Click to show/hide routes\n          </label>\n          <button\n            ref={route_toggle_button_ref}\n            onClick={route_toggle_button}\n            style={{ backgroundColor: \"#74c7b8\" }}\n            value={0}\n            className=\"btn map-editor-button\"\n          >\n            Routes On\n          </button>\n        </div>\n      </div> */}\n      <div className=\"add-delete-node-div\">\n        <label style={{ textAlign: \"center\" }}>Click to reset path</label>\n        <button className=\"btn map-editor-button\" onClick={reset_unsaved_route}>\n          Reset Path\n        </button>\n      </div>\n      <div className=\"input-form-button-div\">\n        <button\n          className=\"btn map-editor-button\"\n          onClick={() => {\n            props.route_toggle_ref.current = false;\n            edit_complete();\n          }}\n        >\n          {\" \"}\n          Done\n        </button>\n      </div>\n    </>\n  );\n\n  const edit_route_div = () => {\n    let edit_route_display = <small>* please select a route first</small>;\n    if (is_route_selected()) {\n      edit_route_display = edit_route_buttons();\n      props.route_toggle_button_ref.current.style.display = \"block\";\n    } else {\n      props.route_toggle_button_ref.current.style.display = \"none\";\n    }\n    return (\n      <div className=\"input-form\">\n        {edit_route_select()}\n        {edit_route_display}\n      </div>\n    );\n  };\n\n  const delete_existing_route_div = () => (\n    <div className=\"input-form\">\n      {route_select_dropdown()}\n      {props.add_delete_mode === \"delete_route\" ? (\n        <small>* click on a route to delete</small>\n      ) : is_route_selected() ? (\n        <small>\n          * click on delete route button to delete highlighted route\n        </small>\n      ) : (\n        <small>* click on delete mode button to activate delete mode</small>\n      )}\n      <button\n        className=\"map-editor-button\"\n        onClick={() => {\n          if (is_route_selected())\n            delete_path_event_callback(\n              props.tmp_route_details.current.route_id\n            );\n          // else attach_path_event_listeners();\n        }}\n        style={\n          props.add_delete_mode === \"delete_route\"\n            ? { background: POST_PROCESS_NODE_COLOR }\n            : {}\n        }\n      >\n        {/* {is_route_selected() ? \"Delete Selected Route\" : \"Delete Mode\"} */}\n        Delete Selected Route\n      </button>\n    </div>\n  );\n\n  const generate_station_attributes_data = () => {\n    let station_attributes = {};\n    Object.keys(props.station_coord.current).forEach((station_id) => {\n      station_attributes[String(station_attributes_maping[station_id])] = [\n        -1,\n        -1,\n        -1,\n        parseInt(station_id),\n      ];\n    });\n    return station_attributes;\n  };\n\n  const check_string_starts_with_string = (str) => {\n if(/^\\s/.test(str)) return str.replace(/\\s+$/g, '')\n    return str;\n  }\n\n  const generate_webui_map_json_stations = () => {\n    const stations = [];\n    let maps_object = {\n      file_name: \"webui_map.png\",\n      scale: props.scale,\n      size: props.size,\n      origin: props.origin,\n      viewbox: `0 0 ${props.size.x} ${props.size.y}`,\n    };\n    let common_dispatch_station;\n    let empty_trolley_station;\n    Object.keys(props.station_coord.current).forEach((station_id, index) => {\n      const station_value = props.station_coord.current[station_id];\n      const [x, y] = props.get_map_coordinate(station_value.x, station_value.y);\n      const theta = convert_to_radians(station_value.rotation);\n      const station_name = station_value.name;\n      const is_charging = station_value.charging;\n      const hidden = station_value.hidden !== undefined ? station_value.hidden : false;\n      let station_tags = station_value.station_tags !== undefined ?  station_value.station_tags[0].split(\",\") : [];\n      \n\n      if (station_value.common_dispatch_station) {\n        common_dispatch_station =\n          station_attributes_maping[parseInt(station_id)];\n      }\n\n      if (station_value.empty_trolley_station) {\n        empty_trolley_station =\n          station_attributes_maping[parseInt(station_id)];\n      }\n\n      let station_object = {\n        id: station_attributes_maping[parseInt(station_id)],\n        name: station_name,\n        x: x,\n        y: y,\n        theta: theta,\n      };\n\n      is_charging && (station_object[\"isCharging\"] = is_charging);\n      station_object[\"hidden\"] = hidden;\n      if(station_tags.length === 1 && station_tags[0] === \"\") station_tags = [];\n      if(station_tags.length > 1) {\n        let station_tags_mod = station_tags.map((station) => {\n           return check_string_starts_with_string(station);\n        })\n        station_tags = station_tags_mod;\n      }\n      station_tags && (station_object[\"station_tags\"] = station_tags);\n      stations.push(station_object);\n    });\n\n    webui_stations_data.current = stations;\n\n    const webui_json_object = {\n      map_name: props.map_name,\n      trip_type: current_trip_type.current ? current_trip_type.current : props.trip_type,\n      maps: { 0: maps_object },\n      stations: stations\n    };\n\n    common_dispatch_station &&\n      (webui_json_object[\"common_dispatch_station\"] = common_dispatch_station);\n\n    empty_trolley_station &&\n      (webui_json_object[\"empty_trolley_station\"] = empty_trolley_station);\n\n    return webui_json_object;\n  };\n\n  const generate_stations_csv_file = () => {\n    let stations_csv = \"x,y,theta\\n\";\n    let station_key = 1;\n    Object.keys(props.station_coord.current).forEach((station_id) => {\n      const station_info = props.station_coord.current[station_id];\n      station_attributes_maping[station_id] = station_key;\n      const [x, y] = props.get_map_coordinate(station_info.x, station_info.y);\n      stations_csv =\n        stations_csv +\n        `${x},${y},${convert_to_radians(station_info.rotation)}\\n`;\n      station_key += 1;\n    });\n    return stations_csv;\n  };\n\n  const get_route_segments = (route_id) => {\n    let route_data = [];\n    let route_segment_data = [];\n    let route_info = props.route_ref.current[route_id];\n\n    if (route_id >= 0) {\n      route_segment_data.push(\n        props.get_map_coordinate(\n          props.station_coord.current[route_info.from_station].x,\n          props.station_coord.current[route_info.from_station].y\n        )\n      );\n\n      for (let node_id of route_info.node) {\n        route_segment_data.push(\n          props.get_map_coordinate(\n            props.node_ref.current[node_id].x,\n            props.node_ref.current[node_id].y\n          )\n        );\n        if (props.node_ref.current[node_id].post_process) {\n          route_data.push(route_segment_data);\n          //start a new segment from the post-process point\n          route_segment_data = route_segment_data.slice(-1);\n        }\n      }\n\n      route_segment_data.push(\n        props.get_map_coordinate(\n          props.station_coord.current[route_info.to_station].x,\n          props.station_coord.current[route_info.to_station].y\n        )\n      );\n    }\n    route_data.push(route_segment_data);\n    return route_data;\n  };\n\n  const generate_waypoints_data = () => {\n    let map_route_wps = [];\n\n    Object.values(props.route_ref.current).forEach((route_info) => {\n      let route_array = [];\n      let route_details = [];\n\n      let wps_matrix;\n      let gen_path;\n      let route_segment = [];\n      let post_process_added = false;\n\n      let route_station_id = [\n        // parseInt(station_attributes_maping[route_info.from_station]),\n        // parseInt(station_attributes_maping[route_info.to_station]),\n        station_attributes_maping[parseInt(route_info.from_station)],\n        station_attributes_maping[parseInt(route_info.to_station)]\n\n      ];\n\n      route_array.push(route_station_id);\n\n      route_segment = get_route_segments(route_info.route_id);\n      //check for start inplace in the first route segment\n      if (\n        route_info.direction === \"reverse\" ||\n        props.station_coord.current[route_info.from_station].inplace\n      ) {\n        let first_segment = route_segment[0];\n        let start_inplace = calculate_inplace(\n          first_segment.slice(0, 2),\n          props.station_coord.current[route_info.from_station].rotation,\n          !parseInt(\n            props.station_coord.current[route_info.from_station].clockwise\n          ),\n          route_info.direction,\n          true\n        );\n        start_inplace && route_details.push(start_inplace);\n      }\n\n      for (let segment_idx in route_segment) {\n        wps_matrix = new Matrix(route_segment[segment_idx]);\n        gen_path = make_route(\n          generate_smooth_path(wps_matrix, route_info.radius)\n        );\n        if (segment_idx > 0) {\n          route_details.push(\"post_process\");\n          route_details.push([[route_info.direction, gen_path]]);\n          post_process_added = true;\n        } else {\n          route_details.push([route_info.direction, gen_path]);\n          post_process_added = false;\n        }\n      }\n\n      //check for end inplace in the last route segment\n      if (\n        route_info.direction === \"reverse\" ||\n        props.station_coord.current[route_info.to_station].inplace\n      ) {\n        let last_segment = route_segment.slice(-1)[0];\n        let end_inplace = calculate_inplace(\n          last_segment.slice(-2),\n          props.station_coord.current[route_info.to_station].rotation,\n          parseInt(\n            props.station_coord.current[route_info.to_station].clockwise\n          ),\n          route_info.direction\n        );\n\n        if (end_inplace) {\n          if (post_process_added) {\n            route_details.slice(-1)[0].push(end_inplace);\n          } else if (\n            props.station_coord.current[route_info.to_station].post_process\n          ) {\n            route_details.push(\"post_process\", [end_inplace]);\n          } else {\n            route_details.push(end_inplace);\n          }\n        }\n      }\n\n      route_array.push(route_details);\n      map_route_wps.push(route_array);\n    });\n    return map_route_wps;\n  };\n\n  const generate_waypoints_file = () => {\n    let data = {};\n    let station_data = [];\n\n    Object.values(props.station_coord.current).forEach((station_info) => {\n      station_data.push([\n        station_info.x,\n        station_info.y,\n        convert_to_radians(station_info.rotation),\n      ]);\n    });\n\n    let tx_st_data = [];\n    let route_data = generate_waypoints_data();\n\n    for (let station_coord of station_data) {\n      let temp = props.get_map_coordinate(station_coord[0], station_coord[1]);\n      tx_st_data.push([...temp, station_coord[2]]);\n    }\n\n    let route_info_to_save = cloneDeep(props.route_ref.current);\n\n    let new_route_ref = {};    \n    \n    Object.entries(props.route_ref.current).map((item) => new_route_ref[item[0]] = {\n      from_station: station_attributes_maping[parseInt(item[1].from_station)],\n      to_station: station_attributes_maping[parseInt(item[1].to_station)],\n        route_id: item[1].route_id,\n        radius: item[1].radius,\n        node: item[1].node,\n        invalid_route: item[1].invalid_route,\n        direction: item[1].direction,\n    });\n\n\n    Object.values(route_info_to_save).forEach((route_details) => {\n      if (\"line\" in route_details)\n        delete route_info_to_save[route_details.route_id][\"line\"];\n      if (\"cp_ref\" in route_details)\n        delete route_info_to_save[route_details.route_id][\"cp_ref\"];\n    });\n\n    const station_coord_to_save = cloneDeep(props.station_coord.current);\n    Object.keys(station_coord_to_save).forEach((station_id) => {\n      const [map_x, map_y] = props.get_map_coordinate(\n        station_coord_to_save[station_id].x,\n        station_coord_to_save[station_id].y\n      );\n      station_coord_to_save[station_id].x = map_x;\n      station_coord_to_save[station_id].y = map_y;\n    });\n\n    const node_ref_to_save = cloneDeep(props.node_ref.current);\n    Object.keys(node_ref_to_save).forEach((node_id) => {\n      const [map_x, map_y] = props.get_map_coordinate(\n        node_ref_to_save[node_id].x,\n        node_ref_to_save[node_id].y\n      );\n      node_ref_to_save[node_id].x = map_x;\n      node_ref_to_save[node_id].y = map_y;\n    });\n\n    data[\"stations\"] = tx_st_data;\n    data[\"routes\"] = adjust_velocity_slight_turns(route_data);\n    //! Below line is not used anymore. Here length of each route was calculated. Data was meant to be used to compute the shortest path\n    // data[\"edges\"] = construct_edge(route_data)\n    \n    //! Check if waypoints stations object and webui stations object are equal\n    //! ideally this should have sorted during deleting station in edit mode in -> props.station_coord.current\n\n    //! lodash cloneDeep\n    const waypoints_stations_data = cloneDeep(station_coord_to_save);\n    \n    //! adding this object in map_data\n    let new_waypoints_stations_object = {};\n\n    for (const [key, value] of Object.entries(waypoints_stations_data)) {\n    webui_stations_data.current.forEach((station) => {\n        const web_key = station.id;\n        const way_value = value.name;\n        const web_value = station.name;\n        //! add station_tags and hidden attrs\n        if ((way_value === web_value)) new_waypoints_stations_object[web_key] = { ...value, station_tags: station['station_tags'], hidden: station['hidden']};\n    })}\n\n    data[\"map_editor\"] = {\n      map_data: {\n        scale: props.scale,\n        size: props.size,\n        origin: props.origin,\n      },\n      ver: MAP_VERSION,\n      stations: new_waypoints_stations_object,\n      routes: new_route_ref,\n      nodes: cloneDeep(node_ref_to_save),\n      // map_rotation: props.map_image.current.attrs.rotation,\n      // map_corner: [props.map_cord.current.x, props.map_cord.current.y],\n    };\n    return data;\n  };\n\n  const download_file = (data, filename) => {\n    const element = document.createElement(\"a\");\n    const file = new Blob([data], {\n      type: \"text/plain;charset=utf-8\",\n    });\n    element.href = URL.createObjectURL(file);\n    element.download = filename;\n    document.body.appendChild(element);\n    element.click();\n  };\n\n  const [upload_file, upload_loading] = useFetch({\n    url: `${api_url}/map_editor/upload`,\n    method: \"post\",\n    on_error: (err) => {\n      add_alert({\n        message: \"Error occurred when uploading files!\",\n        status: \"danger\",\n      });\n    },\n    on_success: ({ data }) => {\n      add_alert({\n        message: data.message,\n        status: \"info\",\n      });\n    },\n  });\n\n  const upload_files = (args = { ...args }) => {\n    let upload_data = args;\n    upload_file({ request_body: upload_data, request_headers: headers() });\n  };\n\n  const switch_button = (mode) => {\n    return (\n      <button\n        className=\"edit-mode-button\"\n        onClick={() => {\n          set_route_mode(mode);\n        }}\n      >\n        <span className=\"text-capitalize\">{mode.split(\"_\").join(\" \")}</span>\n      </button>\n    );\n  };\n\n  const add_route_content = () => {\n    switch (route_mode) {\n      case \"add_route\": {\n        return (\n          <>\n            {add_route_div()}\n            {switch_button(\"edit_route\")}\n            {switch_button(\"delete_route\")}\n            {utils()}\n          </>\n        );\n      }\n      case \"edit_route\": {\n        return (\n          <>\n            {switch_button(\"add_route\")}\n            {edit_route_div()}\n            {switch_button(\"delete_route\")}\n            {utils()}\n          </>\n        );\n      }\n      case \"delete_route\": {\n        return (\n          <>\n            {switch_button(\"add_route\")}\n            {switch_button(\"edit_route\")}\n            {delete_existing_route_div()}\n            {utils()}\n          </>\n        );\n      }\n    }\n  };\n\n  return <div className=\"map-side-column\">{add_route_content()}</div>;\n}\n\nexport default AddRoutes;\n","import React, { useEffect, useState, useRef } from \"react\";\nimport Konva from \"konva\";\n// import mule_image from \"../../resources/webui_map.png\";\n// import { getNavData } from \"../../reducers/navReducer\";\n// import { useSelector } from \"react-redux\";\nimport { cloneDeep, flatten, debounce, throttle } from \"lodash\";\nimport { Matrix } from \"ml-matrix\";\nimport generate_smooth_path from \"../map-editor/map-editor-components/generate_smooth_path\";\nimport { make_route } from \"../map-editor/map-editor-components/make_route\";\nimport parse from \"../map-editor/map-editor-components/parse\";\nimport { round_decimal } from \"../../utilities/genericFunctions\";\nimport { check_valid_route_curva } from \"./map-editor-components/check_valid_route_curva.js\";\n\nimport {\n  ROUTE_RADIUS as RADIUS,\n  // SCALING_FACTOR,\n  Y_OFFSET_NAME,\n} from \"../../common/constants\";\n// import { TransformWrapper, TransformComponent } from \"react-zoom-pan-pinch\";\nimport {\n  shift_coord_update_pos,\n  rotate_point,\n  show_hide_selector_line,\n  // konva_shape_cursor_change,\n} from \"./MapUtilities\";\nimport AlignMap from \"./AlignMap\";\nimport AddStations from \"./AddStations\";\nimport AddRoutes from \"./AddRoutes\";\nimport \"./MapEditor.scss\";\n\nconst THROTTLE_DELAY = 10;\nconst DEBOUNCE_DELAY = 100;\n\nfunction MapEditor(props) {\n  const origin = props.origin;\n  const scale = props.scale;\n  const size = props.size;\n\n  const pivot = useRef({ x: 0, y: 0 });\n\n  const mule_image = props.image;\n  // const map_width_margin = (40 / 100) * window.innerWidth;\n  const pan_offset = useRef({ x: 0, y: 0 });\n  const angle_offset = useRef(0);\n  const ZOOM_LIMIT = 100;\n  let height = 600;\n  let scale_by = 1.1;\n  const is_mounted = useRef(false);\n\n  const map_cord = useRef({\n    x: 0,\n    y: 0,\n    rotation: 0,\n    scale: 1,\n  });\n\n  let map_scale = height / size.y;\n\n  // if (size.x * map_scale > map_width_margin) {\n  //   map_scale = map_width_margin / size.x;\n  //   height = size.y * map_scale;\n  // }\n\n  const cp_ref = useRef({});\n  const tmp_route_details = useRef({});\n  const tmp_node_details = useRef({});\n  const tmp_cp_details = useRef([]);\n  const line = useRef(null);\n  const [new_route_added, set_route_added] = useState(0);\n\n  // const to_show_sidebar = useSelector(getNavData).to_show_sidebar;\n  const stage = useRef(null);\n  const stage_ruler = useRef(null);\n  const ruler_x_width = 40;\n  const ruler_y_width = 40;\n  const grid_x_color = \"black\";\n  const grid_y_color = \"#787878\";\n  const [image_loaded, set_image_loaded] = useState(false);\n  const [current_tab, set_current_tab] = useState(\"Align Map\");\n  const map_div_ref = useRef(null);\n  const [add_delete_mode, set_add_delete_mode] = useState(null);\n\n  let circle;\n  let tooltip = useRef(null);\n  let pivot_ref = useRef(null);\n  let grid_group_lines = useRef([]);\n  let grid_group_texts = useRef([]);\n  const [grid_on_off, set_grid_on_off] = useState(true);\n\n  const layer = useRef(null);\n  const layer_ruler = useRef(null);\n  const map_image = useRef(null);\n\n  const station_coord = useRef({});\n  const icon_list = useRef({});\n  const icon_name = useRef({});\n\n  const node_ref = useRef({});\n  const route_ref = useRef({});\n  const count = useRef(0);\n  const reference_route_ref = useRef(null);\n  const reference_route_copy_ref = useRef(null);\n  const route_toggle_ref = useRef(false);\n  const route_toggle_button_ref = useRef(null);\n  const invalid_route_ref = useRef([]);\n  const drawn_invalid_route_ref = useRef([]);\n  const zooming = useRef(false);\n\n  const get_current_x_y = (x, y, scale) => {\n    const x_dashed = (x / scale) * map_scale;\n    const y_dashed = (y / scale) * map_scale;\n    return [x_dashed, y_dashed];\n  };\n\n  const preprocess_map_editor_data = (map_editor_data) => {\n    if (map_editor_data.ver === 2) {\n      preprocess_v2(map_editor_data)\n    } else {\n      preprocess_v1(map_editor_data)\n    }\n  };\n\n\n  const preprocess_v1 = (map_editor_data) => {\n    for (const station_id in map_editor_data.stations) {\n      const station = map_editor_data.stations[station_id];\n      if (map_editor_data.stage) {\n        const [x_dashed, y_dashed] = get_current_x_y(\n          station.x,\n          station.y,\n          map_editor_data.stage.scale\n        );\n        station.x = x_dashed;\n        station.y = y_dashed;\n      }\n    }\n\n    for (const node_id in map_editor_data.nodes) {\n      const node = map_editor_data.nodes[node_id];\n      if (map_editor_data.stage) {\n        const [x_dashed, y_dashed] = get_current_x_y(\n          node.x,\n          node.y,\n          map_editor_data.stage.scale\n        );\n        node.x = x_dashed;\n        node.y = y_dashed;\n      }\n    }\n\n    if (map_editor_data.map_corner) {\n      const [x_dashed, y_dashed] = get_current_x_y(\n        map_editor_data.map_corner[0],\n        map_editor_data.map_corner[1],\n        map_editor_data.stage.scale\n      );\n      map_editor_data.map_corner = [x_dashed, y_dashed];\n    }\n  };\n\n  const preprocess_v2 = (map_editor_data) => {\n    for (const station_id in map_editor_data.stations) {\n      const station = map_editor_data.stations[station_id];\n\n      const [x_dashed, y_dashed] = get_pixel_coordinate(\n        station.x,\n        station.y,\n      );\n      station.x = x_dashed;\n      station.y = y_dashed;\n\n    }\n\n    for (const node_id in map_editor_data.nodes) {\n      const node = map_editor_data.nodes[node_id];\n      const [x_dashed, y_dashed] = get_pixel_coordinate(node.x, node.y);\n      node.x = x_dashed;\n      node.y = y_dashed;\n    }\n\n    if (map_editor_data.map_corner) {\n      const [x_dashed, y_dashed] = get_current_x_y(\n        map_editor_data.map_corner[0],\n        map_editor_data.map_corner[1],\n        map_editor_data.stage.scale\n      );\n      map_editor_data.map_corner = [x_dashed, y_dashed];\n    }\n  }\n\n\n  const load_routes_and_stations_data = (map_editor_data) => {\n    preprocess_map_editor_data(map_editor_data);\n    if (\n      map_editor_data.map_corner &&\n      map_editor_data.map_rotation !== undefined\n    ) {\n      Object.values(map_editor_data.stations).forEach((station) => {\n        let x = station.x - map_editor_data.map_corner[0];\n        let y = station.y - map_editor_data.map_corner[1];\n        let angle = (map_editor_data.map_rotation * Math.PI) / 180;\n\n        [x, y] = rotate_point(x, y, -angle);\n        station.x = x;\n        station.y = y;\n      });\n      Object.values(map_editor_data.nodes).forEach((node) => {\n        let x = node.x - map_editor_data.map_corner[0];\n        let y = node.y - map_editor_data.map_corner[1];\n        let angle = (map_editor_data.map_rotation * Math.PI) / 180;\n\n        [x, y] = rotate_point(x, y, -angle);\n        node.x = x;\n        node.y = y;\n      });\n    }\n    station_coord.current = cloneDeep(map_editor_data.stations);\n    node_ref.current = cloneDeep(map_editor_data.nodes);\n    route_ref.current = cloneDeep(map_editor_data.routes);\n\n    let route_ids = Object.keys(route_ref.current);\n    count.current =\n      route_ids.length > 0 ? parseInt(route_ids.slice(-1)[0]) + 1 : 1;\n\n    // update_map_pos(map_editor_data);\n\n    //draw route\n    Object.keys(route_ref.current).forEach((route_id) => {\n      load_temp_route(route_id);\n      route_ref.current[route_id][\"line\"] = draw_route(false);\n      copy_tmp_cp_master_cp(route_id);\n    });\n    show_hide_selector_line({\n      route_ref: route_ref.current,\n      show: false,\n    });\n\n    reset_tmp_route_node_path();\n    //add station\n    set_current_tab(\"Station\");\n  };\n\n  useEffect(() => {\n    is_mounted.current = true;\n    return () => {\n      is_mounted.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    let isMounted = true;\n    if (!image_loaded) {\n      stage.current = new Konva.Stage({\n        container: \"konva-div\",\n        // width: size.x * map_scale,\n        // height: size.y * map_scale,\n        width: map_div_ref.current.offsetWidth - ruler_x_width,\n        height: map_div_ref.current.offsetHeight - ruler_y_width,\n      });\n      stage_ruler.current = new Konva.Stage({\n        container: \"konva-div-ruler\",\n        // width: size.x * map_scale + ruler_x_width,\n        // height: size.y * map_scale + ruler_y_width,\n        width: map_div_ref.current.offsetWidth,\n        height: map_div_ref.current.offsetHeight,\n      });\n\n      isMounted && load_map();\n    }\n    return () => (isMounted = false);\n  }, [map_div_ref.current, image_loaded]);\n\n  const get_map_coordinate = (x, y, round_step = 3) => {\n    // let tmp;\n    // let angle = (map_image.current.attrs.rotation * Math.PI) / 180;\n    // const image_width = map_image.current.attrs.x;\n    // const image_height = map_image.current.attrs.y;\n    // tmp = shift_coord_update_pos(x, y, image_width, image_height);\n    // tmp = rotate_point(tmp[0], tmp[1], -angle);\n\n    const x_dashed = (x / map_scale - origin.x) / scale.x;\n    const y_dashed = (y / map_scale - origin.y) / scale.y;\n    return round_decimal([x_dashed, y_dashed], round_step);\n  };\n\n  const get_untransformed_coordinates = (x, y) => {\n    let tmp;\n    let angle = (map_image.current.attrs.rotation * Math.PI) / 180;\n    const scale = map_image.current.scaleX();\n    const image_width = map_image.current.attrs.x;\n    const image_height = map_image.current.attrs.y;\n    tmp = shift_coord_update_pos(x, y, image_width, image_height);\n    tmp = rotate_point(tmp[0], tmp[1], -angle);\n    tmp[0] = tmp[0] / scale;\n    tmp[1] = tmp[1] / scale;\n\n    return tmp;\n  };\n\n  const update_tooltip = (x, y, on_image = false) => {\n    if (Math.abs(stage.current.width() - x) > stage.current.width() - 100) {\n      set_tooltip_direction(\"left\", on_image);\n    } else if (Math.abs(stage.current.width() - x) < 100) {\n      set_tooltip_direction(\"right\", on_image);\n    } else if (Math.abs(stage.current.height() - y) < 100) {\n      set_tooltip_direction(\"down\", on_image);\n    } else {\n      set_tooltip_direction(\"up\", on_image);\n    }\n  };\n\n  const save_node_references = (tmp_node_details) => {\n    let key_node = {};\n    Object.keys(tmp_node_details).forEach((key) => {\n      key_node[key] = tmp_node_details[key].node;\n    });\n    return key_node;\n  };\n\n  const load_node_references = (node_object, tmp_node_details) => {\n    Object.keys(node_object).forEach((key) => {\n      if (key in tmp_node_details)\n        tmp_node_details[key].node = node_object[key];\n    });\n    return tmp_node_details;\n  };\n\n  const update_node_pos = () => {\n    if (tmp_route_details.current && tmp_route_details.current.node) {\n      tmp_route_details.current.node.forEach((id) => {\n        const node_ref = tmp_node_details.current[id];\n        const [x_trans, y_trans] = get_transformed_coordinates(\n          node_ref.x,\n          node_ref.y\n        );\n        node_ref.node.x(x_trans);\n        node_ref.node.y(y_trans);\n      });\n      // draw_control_points();\n      layer.current.batchDraw();\n    }\n  };\n  const hide_nodes = () => {\n    if (tmp_route_details.current && tmp_route_details.current.node) {\n      tmp_route_details.current.node.forEach((id) => {\n        tmp_node_details.current[id].node.hide();\n      });\n      // draw_control_points();\n      layer.current.batchDraw();\n    }\n  };\n  const hide_ref_line = () => {\n    if (reference_route_ref.current) {\n      reference_route_ref.current.line.hide();\n    }\n  };\n  const show_ref_line = () => {\n    if (reference_route_ref.current) {\n      reference_route_ref.current.line.show();\n    }\n  };\n  const show_nodes = () => {\n    if (tmp_route_details.current && tmp_route_details.current.node) {\n      tmp_route_details.current.node.forEach((id) => {\n        tmp_node_details.current[id].node.show();\n      });\n      // draw_control_points();\n      layer.current.batchDraw();\n    }\n  };\n\n  const remove_invalid_turns = () => {\n    if (drawn_invalid_route_ref.current) {\n      drawn_invalid_route_ref.current.forEach((line) => {\n        line.destroy();\n      });\n      drawn_invalid_route_ref.current = [];\n    }\n  };\n\n  const highlight_invalid_routes = () => {\n    Object.values(route_ref.current).forEach((route) => {\n      if (route[\"invalid_route\"]) {\n        const [line1, line2] = route.line.children;\n        if (line1) {\n          line1.stroke(\"#52006A\");\n          line1.strokeWidth(2);\n          line1.dash([5, 0.001, 5]);\n        }\n      }\n    });\n  };\n\n  const redraw_all_routes = (redraw_all = true) => {\n    let tmp_route_details_copy;\n    let tmp_node_details_copy;\n    let tmp_cp_details_copy;\n    let route_id_tmp;\n    let line_tmp;\n    let node_object;\n    remove_invalid_turns();\n    if (\n      tmp_route_details.current &&\n      Object.keys(tmp_route_details.current).length > 0\n    ) {\n      tmp_route_details_copy = cloneDeep(tmp_route_details.current);\n      route_id_tmp = tmp_route_details.current.route_id;\n      node_object = save_node_references(tmp_node_details.current || {});\n      tmp_node_details_copy = cloneDeep(tmp_node_details.current);\n      tmp_cp_details_copy = tmp_cp_details.current;\n      remove_control_points();\n    }\n\n    Object.keys(route_ref.current).forEach((route_id) => {\n      reset_tmp_route_node_path();\n      load_temp_route(route_id, true);\n      tmp_route_details.current.line &&\n        tmp_route_details.current.line.destroy();\n      if (parseInt(route_id_tmp) === parseInt(route_id)) {\n        tmp_route_details.current = tmp_route_details_copy;\n        tmp_node_details.current = load_node_references(\n          node_object,\n          tmp_node_details_copy\n        );\n        tmp_cp_details.current = tmp_cp_details_copy;\n      }\n      const line_drawn = draw_route(\n        parseInt(route_id_tmp) === parseInt(route_id)\n      );\n      if (parseInt(route_id_tmp) === parseInt(route_id)) {\n        line_tmp = line_drawn;\n        check_valid_route();\n      }\n      route_ref.current[route_id][\"line\"] = line_drawn;\n      line.current = line_drawn;\n      line.current.children[1].hide();\n      if (!(redraw_all || parseInt(route_id) === parseInt(route_id_tmp)))\n        line.current.children[0].hide();\n      copy_tmp_cp_master_cp(route_id);\n    });\n    if (reference_route_ref.current) {\n      const points = prepare_line_points(true);\n      const [line1, line2] = reference_route_ref.current.line.children;\n      line1.points(points);\n      line2.points(points);\n    }\n    reset_tmp_route_node_path();\n    if (tmp_route_details_copy) {\n      tmp_route_details.current = tmp_route_details_copy;\n      tmp_route_details.current[\"line\"] = line_tmp;\n      line.current = line_tmp;\n      tmp_node_details.current = load_node_references(\n        node_object,\n        tmp_node_details_copy\n      );\n      tmp_cp_details.current = tmp_cp_details_copy;\n      update_node_pos();\n    }\n    if (line.current) {\n      highlight_current_line();\n    }\n    // highlight_invalid_routes();\n  };\n\n  const highlight_current_line = () => {\n    const [line1, line2] = line.current.children;\n    if (line1) {\n      line1.stroke(\"red\");\n      line1.strokeWidth(5);\n    }\n    if (line2) {\n      line2.hide();\n    }\n  };\n\n  const set_tooltip_direction = (direction, on_image = false) => {\n    if (tooltip.current) {\n      if (direction === \"right\" || direction === \"left\") {\n        tooltip.current.children[0].pointerWidth(35);\n        tooltip.current.children[0].pointerHeight(on_image ? 0 : 3);\n      } else {\n        tooltip.current.children[0].pointerWidth(on_image ? 0 : 3);\n        tooltip.current.children[0].pointerHeight(35);\n      }\n      tooltip.current.children[0].pointerDirection(direction);\n    }\n  };\n\n  const update_map_pos = (map_editor_data) => {\n    let [corner_x, corner_y] = map_editor_data.map_corner || [0, 0];\n    let map_rotation = map_editor_data.map_rotation || 0;\n\n    map_cord.current.x = corner_x;\n    map_cord.current.y = corner_y;\n    map_cord.current.rotation = map_rotation;\n\n    map_image.current.x(corner_x);\n    map_image.current.y(corner_y);\n    map_image.current.rotate(map_rotation);\n    clear_draw_grid();\n    draw_grid(true);\n    set_grid_on_off(true);\n    layer.current && layer.current.batchDraw();\n  };\n\n  const get_pixel_coordinate = (x_map, y_map) => {\n    const x_dashed = (x_map * scale.x + origin.x) * map_scale;\n    const y_dashed = (y_map * scale.y + origin.y) * map_scale;\n\n    return [x_dashed, y_dashed];\n  };\n\n  const get_transformed_coordinates = (x, y) => {\n    let tmp;\n    let angle = (map_image.current.attrs.rotation * Math.PI) / 180;\n\n    x *= map_image.current.scaleX();\n    y *= map_image.current.scaleX();\n\n    tmp = rotate_point(x, y, angle);\n\n    x = tmp[0];\n    y = tmp[1];\n\n    x += map_image.current.x();\n    y += map_image.current.y();\n\n    return [x, y];\n  };\n\n  const draw_grid_line_and_text = (\n    value,\n    draw_line,\n    stroke_width = 0.5,\n    vertical = false\n  ) => {\n    let angle = (map_image.current.attrs.rotation * Math.PI) / 180;\n    let height = stage_ruler.current.height();\n    let width = stage_ruler.current.width();\n    if (draw_line) {\n      const tmp = vertical\n        ? value - height * Math.tan(angle)\n        : value + width * Math.tan(angle);\n      const points = vertical\n        ? [value, 0, tmp, height]\n        : [0, value, width, tmp];\n      const grid_line = new Konva.Line({\n        points,\n        stroke: vertical ? grid_x_color : grid_y_color,\n        strokeWidth: stroke_width,\n        lineCap: \"round\",\n        opacity: 0.5,\n      });\n\n      layer.current.add(grid_line);\n      grid_group_lines.current.push(grid_line);\n    }\n\n    let x = vertical ? value - height * Math.tan(angle) : 0;\n    let y = vertical ? height : value;\n    let text_value_to_show = get_untransformed_map_coordinates(x, y, 1);\n    if (vertical) {\n      x = x + ruler_x_width / 2;\n      y = y - ruler_y_width / 1.5;\n    } else {\n      y = y - ruler_y_width / 2;\n    }\n\n    const text = new Konva.Text({\n      text: vertical ? text_value_to_show[0] : text_value_to_show[1],\n      // rotation: vertical ? 0 : -90,\n      x: x,\n      y: y,\n      align: \"right\",\n      width: 40,\n      padding: 5,\n      fontFamily: \"Calibri\",\n      fontSize: 12,\n      fill: vertical ? grid_x_color : grid_y_color,\n      drawBorder: true,\n    });\n\n    layer_ruler.current.add(text);\n    grid_group_texts.current.push(text);\n\n    layer.current.batchDraw();\n    layer_ruler.current.batchDraw();\n  };\n\n  const draw_grid = (draw_lines = false) => {\n    const stage_height = parseInt(stage.current.attrs.height);\n    const stage_width = parseInt(stage.current.attrs.width);\n\n    let angle = (map_image.current.attrs.rotation * Math.PI) / 180;\n    const step = 50 / Math.abs(Math.cos(angle));\n\n    let y_span, x_span, y_start, x_start;\n\n    //Note:angle here is positive for clockwise rotation, equation takes that into account\n    //Corner is the bottom-right corner of the map\n    //x_corner pos is x coord of the line from  the top-right to bottom-right\n    //y_corner pos is y coord of the line from  the bottom-left to bottom-right\n    //Difference is new_x/new_y and stage_width/stage_height is added to the top x-axis/y-axis respectively\n    let new_x_corner = stage_width - stage_height * Math.tan(angle);\n    let new_y_corner = stage_height + stage_width * Math.tan(angle);\n\n    if (new_y_corner < stage_height) {\n      y_span = stage_height + (stage_height - new_y_corner);\n      y_start = 0;\n    } else {\n      y_span = stage_height;\n      y_start = stage_height - new_y_corner;\n    }\n\n    if (new_x_corner < stage_width) {\n      x_span = stage_width + (stage_width - new_x_corner);\n      x_start = 0;\n    } else {\n      x_span = stage_width;\n      x_start = stage_width - new_x_corner;\n    }\n\n    while (y_start < y_span) {\n      draw_grid_line_and_text(y_start, draw_lines);\n      y_start += step;\n    }\n\n    while (x_start < x_span) {\n      draw_grid_line_and_text(x_start, draw_lines, 0.5, true);\n      x_start += step;\n    }\n  };\n\n  const clear_grid = (clear_lines = true) => {\n    clear_lines &&\n      grid_group_lines.current.forEach((child) => {\n        child.destroy();\n      });\n    grid_group_texts.current.forEach((child) => {\n      child.destroy();\n    });\n    layer.current.batchDraw();\n    layer_ruler.current.batchDraw();\n    if (clear_lines) grid_group_lines.current = [];\n    grid_group_texts.current = [];\n  };\n\n  const clear_draw_grid = (e) => {\n    if (grid_on_off) {\n      clear_grid();\n      set_grid_on_off(false);\n    } else {\n      draw_grid(true);\n      set_grid_on_off(true);\n    }\n  };\n\n  const initialize_tooltip = (x, y) => {\n    tooltip.current = new Konva.Label({\n      x: x,\n      y: y,\n      opacity: 0.75,\n    });\n\n    tooltip.current.add(\n      new Konva.Tag({\n        fill: \"black\",\n        pointerDirection: \"up\",\n        pointerWidth: 3,\n        pointerHeight: 35,\n        lineJoin: \"round\",\n      })\n    );\n\n    tooltip.current.add(\n      new Konva.Text({\n        text: \"\",\n        fontFamily: \"Calibri\",\n        fontSize: 18,\n        padding: 5,\n        fill: \"white\",\n      })\n    );\n    layer.current.add(tooltip.current);\n  };\n\n  const set_tooltip_text = (text) => {\n    if (tooltip.current) {\n      const [Tag, Text] = tooltip.current.children;\n      Text.text(text);\n    }\n  };\n\n  const show_tool_tip = (e) => {\n    const stage = e.target.getStage();\n    const stageLocation = stage.getPointerPosition();\n\n    if (tooltip.current) {\n      set_tooltip_x_y(stageLocation.x, stageLocation.y);\n      const [map_x, map_y] = get_untransformed_map_coordinates(\n        stageLocation.x,\n        stageLocation.y\n      );\n      // const map_x = stageLocation.x.toFixed(3);\n      // const map_y = stageLocation.y.toFixed(3);\n      set_tooltip_text(`x:${map_x},y:${map_y}`);\n      tooltip.current.show();\n      layer.current.batchDraw();\n    } else {\n      initialize_tooltip(stageLocation.x, stageLocation.y);\n      const [map_x, map_y] = get_untransformed_map_coordinates(\n        stageLocation.x,\n        stageLocation.y\n      );\n      // const map_x = stageLocation.x.toFixed(3);\n      // const map_y = stageLocation.y.toFixed(3);\n      set_tooltip_text(`x:${map_x},y:${map_y}`);\n    }\n    tooltip.current.children[0].pointerWidth(0);\n    update_tooltip(stageLocation.x, stageLocation.y, true);\n  };\n\n  const circle_show_tool_tip = (station_id) => {\n    const { x, y, rotation } = station_coord.current[station_id];\n    if (tooltip.current) {\n      const [x_trans, y_trans] = get_transformed_coordinates(x, y);\n      set_tooltip_x_y(x_trans, y_trans);\n      const [map_x, map_y] = get_map_coordinate(x, y);\n      set_tooltip_text(`x:${map_x},y:${map_y},angle:${rotation}`);\n      tooltip.current.show();\n      layer.current.batchDraw();\n    } else {\n      const [x_trans, y_trans] = get_transformed_coordinates(x, y);\n      initialize_tooltip(x_trans, y_trans);\n      const [map_x, map_y] = get_map_coordinate(x, y);\n      set_tooltip_text(`x:${map_x},y:${map_y},angle:${rotation}`);\n    }\n    tooltip.current.children[0].pointerWidth(3);\n  };\n\n  const set_tooltip_x_y = (x, y) => {\n    if (tooltip.current) {\n      tooltip.current.x(x);\n      tooltip.current.y(y);\n    }\n  };\n\n  const get_untransformed_map_coordinates = (x, y, round_step = 3) => {\n    const [stage_x, stage_y] = get_untransformed_coordinates(x, y);\n    const [map_x, map_y] = get_map_coordinate(stage_x, stage_y, round_step);\n    return [map_x, map_y];\n  };\n\n  const map_image_show_tooltip = (e) => {\n    const stage = e.target.getStage();\n    const stageLocation = stage.getPointerPosition();\n\n    if (tooltip.current) {\n      set_tooltip_x_y(stageLocation.x, stageLocation.y);\n      const [map_x, map_y] = get_untransformed_map_coordinates(\n        stageLocation.x,\n        stageLocation.y\n      );\n      set_tooltip_text(`x:${map_x},y:${map_y}`);\n      tooltip.current.show();\n      layer.current.batchDraw();\n    } else {\n      initialize_tooltip(stageLocation.x, stageLocation.y);\n      const [map_x, map_y] = get_untransformed_map_coordinates(\n        stageLocation.x,\n        stageLocation.y\n      );\n      set_tooltip_text(`x:${map_x},y:${map_y}`);\n    }\n    tooltip.current.children[0].pointerWidth(0);\n    update_tooltip(stageLocation.x, stageLocation.y, true);\n  };\n\n  const circle_hide_tool_tip = () => {\n    if (tooltip.current) {\n      tooltip.current.hide();\n      layer.current.batchDraw();\n    }\n  };\n\n  const add_tooltip_event_listener_to = (station_id) => {\n    const [outer_circle, image] = icon_list.current[station_id].children;\n    icon_list.current[station_id].on(\"dragmove.event1\", () => {\n      circle_show_tool_tip(station_id);\n    });\n    outer_circle.on(\"mouseenter.event1 tap\", () => {\n      circle_show_tool_tip(station_id);\n    });\n    outer_circle.on(\"mouseout.event1 dragend.event1\", circle_hide_tool_tip);\n    image.on(\"mouseenter.event1 tap\", () => {\n      circle_show_tool_tip(station_id);\n    });\n  };\n\n  const get_id = () => {\n    count.current += 1;\n    return count.current;\n  };\n\n  const get_circle = (\n    id,\n    color,\n    x = null,\n    y = null,\n    radius = 5,\n    draggable = false\n  ) => {\n    let x_pos = x || stage.current.width() / 2;\n    let y_pos = y || stage.current.height() / 2;\n    circle = new Konva.Circle({\n      x: x_pos,\n      y: y_pos,\n      radius,\n      fill: color,\n      stroke: \"black\",\n      strokeWidth: 1,\n      draggable,\n      id,\n    });\n\n    circle.on(\"mousemove\", show_tool_tip);\n    // konva_shape_cursor_change(circle, \"node\");\n    return circle;\n  };\n\n  const draw_control_points = () => {\n    let no_of_coord = tmp_cp_details.current.length;\n    if (no_of_coord >= 4) {\n      let i = 0;\n      let tmp_circle;\n      tmp_route_details.current[\"cp_ref\"] = [];\n      while (i < no_of_coord) {\n        tmp_circle = get_circle(\n          get_id(),\n          \"green\",\n          tmp_cp_details.current[i],\n          tmp_cp_details.current[i + 1],\n          2\n        );\n        layer.current.add(tmp_circle);\n        tmp_route_details.current[\"cp_ref\"].push(tmp_circle);\n        i += 2;\n      }\n      layer.current.batchDraw();\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  const draw_line = (\n    points,\n    color = \"black\",\n    update_ref_route = false,\n    invalid_turn = false,\n    invalid_route = false\n  ) => {\n    let line1;\n    let line2;\n    if (update_ref_route) {\n      line1 = new Konva.Arrow({\n        points,\n        fill: \"yellow\",\n        stroke: \"#EB8F8F\",\n        dashEnabled: true,\n        dash: [12, 12],\n        strokeWidth: 5,\n        lineCap: \"round\",\n      });\n      line2 = new Konva.Arrow({\n        points,\n        fill: \"yellow\",\n        stroke: color,\n        strokeWidth: 0,\n        opacity: 0,\n        lineCap: \"round\",\n      });\n    } else if (invalid_turn) {\n      line1 = new Konva.Line({\n        points,\n        fill: color,\n        stroke: color,\n        strokeWidth: 30,\n        lineCap: \"round\",\n        tension: 2,\n        opacity: 0.3,\n      });\n      line2 = draw_transparent_line(points);\n    } else {\n      line1 = new Konva.Arrow({\n        points,\n        fill: \"yellow\",\n        stroke: color,\n        strokeWidth: 2,\n        lineCap: \"round\",\n        dashEnabled: invalid_route,\n        dash: [12, 12],\n      });\n      line2 = draw_transparent_line(points);\n    }\n    // konva_shape_cursor_change(line1, \"line1\");\n    let line_group = new Konva.Group();\n    line_group.on(\"mousemove\", show_tool_tip);\n\n    line_group.add(line1, line2);\n    layer.current.add(line_group);\n    layer.current.batchDraw();\n    return line_group;\n  };\n\n  const draw_transparent_line = (points) => {\n    return new Konva.Line({\n      points,\n      fill: \"purple\",\n      stroke: \"purple\",\n      strokeWidth: 25,\n      opacity: 0,\n      lineCap: \"round\",\n    });\n  };\n\n  function load_map() {\n    layer.current = new Konva.Layer();\n    layer_ruler.current = new Konva.Layer();\n    let imageObj = new Image();\n    imageObj.src = mule_image;\n    imageObj.onload = function () {\n      map_image.current = new Konva.Image({\n        x: map_cord.current.x,\n        y: map_cord.current.y,\n        image: imageObj,\n        width: size.x * map_scale,\n        height: size.y * map_scale,\n        offset: {\n          x: 0,\n          y: 0,\n        },\n        draggable: false,\n        rotation: map_cord.current.rotation,\n      });\n      map_image.current.on(\"tap.event1\", circle_hide_tool_tip);\n      map_image.current.on(\"mousemove\", map_image_show_tooltip);\n      map_image.current.on(\"mouseleave\", circle_hide_tool_tip);\n      add_objects();\n      route_toggle_button_ref.current.style.display = \"none\";\n      map_image.current && enable_pan_map_image();\n      map_image.current && enable_map_zoom();\n      set_image_loaded(true);\n      if (props.waypoints_data)\n        load_routes_and_stations_data(props.waypoints_data);\n      else reset_map_scale();\n    };\n  }\n\n  const show_all_routes_pan_zoom  = async () => {\n    redraw_all_routes(!route_toggle_ref.current);\n    if (\n      tmp_route_details.current &&\n      Object.keys(tmp_route_details.current).length > 0\n    ) {\n      show_nodes();\n      show_ref_line();\n    }\n    reset_zindex();\n  }\n\n  const hide_all_routes_pan_zoom = async () => {\n    let tmp_route_details_copy;\n    let tmp_node_details_copy;\n    let tmp_cp_details_copy;\n    let node_object = {};\n    if (\n      tmp_route_details.current &&\n      Object.keys(tmp_route_details.current).length > 0\n    ) {\n      tmp_route_details_copy = cloneDeep(tmp_route_details.current);\n      node_object = save_node_references(tmp_node_details.current || {});\n      tmp_node_details_copy = cloneDeep(tmp_node_details.current);\n      tmp_cp_details_copy = cloneDeep(tmp_cp_details.current);\n      remove_control_points();\n      delete_all_routes(false);\n    } else delete_all_routes(true);\n\n    if (tmp_route_details_copy) {\n      tmp_route_details.current = tmp_route_details_copy;\n      tmp_cp_details.current = tmp_cp_details_copy;\n      tmp_node_details.current = load_node_references(\n        node_object,\n        tmp_node_details_copy\n      );\n      hide_nodes();\n      hide_ref_line();\n      remove_invalid_turns();\n    }\n  }\n\n  const enable_map_zoom = () => {\n    stage.current.on(\"wheel\", throttle((e) => {\n      e.evt.preventDefault();\n      if (!zooming.current) {\n        zooming.current = true;\n        hide_all_routes_pan_zoom();\n      }\n      let old_scale = map_image.current.scaleX();\n\n      let pointer = stage.current.getPointerPosition();\n\n      let mouse_point_to = {\n        x: (pointer.x - map_image.current.x()) / old_scale,\n        y: (pointer.y - map_image.current.y()) / old_scale,\n      };\n\n      let new_scale =\n        e.evt.deltaY > 0 ? old_scale * scale_by : old_scale / scale_by;\n\n      if (new_scale >= 1 && new_scale <= ZOOM_LIMIT) {\n        map_image.current.scale({ x: new_scale, y: new_scale });\n\n        let newPos = {\n          x: pointer.x - mouse_point_to.x * new_scale,\n          y: pointer.y - mouse_point_to.y * new_scale,\n        };\n\n        map_image.current.position(newPos);\n        update_icon_pos();\n        circle_hide_tool_tip();\n        clear_grid(false);\n        set_add_delete_mode(null);\n        draw_grid();\n        layer.current.batchDraw();\n      }\n    }, THROTTLE_DELAY));\n\n    stage.current.on(\"wheel\", debounce((e) => {\n      zooming.current && (zooming.current = false);\n      update_map_corner_pos(map_image.current).then((_) => {\n        show_all_routes_pan_zoom();\n      })\n    }, DEBOUNCE_DELAY));\n  };\n\n  const delete_all_routes = (clear_tmp = true) => {\n    Object.keys(route_ref.current).forEach((route_id) => {\n      load_temp_route(route_id);\n      tmp_route_details.current.line &&\n        tmp_route_details.current.line.destroy();\n    });\n    clear_tmp && reset_tmp_route_node_path();\n  };\n\n  const enable_pan_map_image = () => {\n    map_image.current.draggable(true);\n    map_image.current.on(\"dragmove\", async function ({ target }) {\n      update_map_corner_pos(target).then((_) => {\n        update_icon_pos();\n        circle_hide_tool_tip();\n        clear_grid(false);\n        draw_grid();\n      });\n    });\n\n    map_image.current.on(\"dragstart\", hide_all_routes_pan_zoom);\n\n    map_image.current.on(\"dragend\", show_all_routes_pan_zoom);\n  };\n\n  const check_valid_route = () => {\n    const tmp_cp = cloneDeep(tmp_cp_details.current);\n    const { from_station, to_station } = tmp_route_details.current;\n    const from_station_coord = get_map_coordinate(\n      station_coord.current[from_station].x,\n      station_coord.current[from_station].y\n    );\n    const to_station_coord = get_map_coordinate(\n      station_coord.current[to_station].x,\n      station_coord.current[to_station].y\n    );\n    let i;\n    for (i = 0; i < tmp_cp.length; i += 2) {\n      const [x_map, y_map] = get_untransformed_map_coordinates(\n        tmp_cp[i],\n        tmp_cp[i + 1]\n      );\n      tmp_cp[i] = x_map;\n      tmp_cp[i + 1] = y_map;\n    }\n\n    // const threshold =\n    //   (1 /\n    //     (tmp_route_details.current.radius *\n    //       map_scale *\n    //       scale.x *\n    //       map_image.current.scaleX())) *\n    //   2.5;\n    const threshold = 4 / tmp_route_details.current.radius;\n    const invalid_points = check_valid_route_curva(\n      from_station_coord,\n      tmp_cp,\n      to_station_coord,\n      threshold,\n      get_pixel_coordinate,\n      get_transformed_coordinates\n    );\n    if (invalid_points.length > 0) {\n      draw_invalid_turns(invalid_points);\n    }\n    return invalid_points.length > 0;\n  };\n\n  async function update_map_corner_pos(target) {\n    pan_offset.current.x = target.attrs.x - map_cord.current.x;\n    pan_offset.current.y = target.attrs.y - map_cord.current.y;\n    map_cord.current.x = target.attrs.x;\n    map_cord.current.y = target.attrs.y;\n  }\n\n  function update_station_panned_pos() {\n    Object.keys(station_coord.current).forEach((id) => {\n      station_coord.current[id].x += pan_offset.current.x;\n      station_coord.current[id].y += pan_offset.current.y;\n    });\n  }\n\n  function update_icon_pos() {\n    Object.keys(icon_list.current).forEach((id) => {\n      let { x, y } = station_coord.current[id];\n      [x, y] = get_transformed_coordinates(x, y);\n      icon_list.current[id].x(x);\n      icon_list.current[id].y(y);\n      icon_list.current[id].rotation(map_image.current.rotation() - station_coord.current[id].rotation);\n\n      icon_name.current[id].x(x);\n      icon_name.current[id].y(y - Y_OFFSET_NAME);\n    });\n  }\n\n  function update_icon_pos_scale() {\n    Object.keys(icon_list.current).forEach((id) => {\n      let { x, y } = station_coord.current[id];\n      x = x * map_image.current.scaleX();\n      y = y * map_image.current.scaleX();\n      icon_list.current[id].x(x);\n      icon_list.current[id].y(y);\n\n      icon_name.current[id].x(x);\n      icon_name.current[id].y(y - Y_OFFSET_NAME);\n    });\n  }\n\n  const update_node_pan_pos = () => {\n    for (const node_id in node_ref.current) {\n      const node = node_ref.current[node_id];\n      node.x += pan_offset.current.x;\n      node.y += pan_offset.current.y;\n    }\n  };\n\n  const load_master_route_tmp_route = (route_id) => {\n    tmp_route_details.current = { ...route_ref.current[route_id] };\n    tmp_route_details.current[\"node\"] = [...route_ref.current[route_id].node];\n    tmp_route_details.current[\"route\"] = cloneDeep(\n      route_ref.current[route_id].route\n    );\n  };\n  const load_master_node_tmp_node = (route_id) => {\n    route_ref.current[route_id].node.forEach((node_id) => {\n      tmp_node_details.current[node_id] = cloneDeep(node_ref.current[node_id]);\n    });\n  };\n  const load_master_cp_tmp_cp = (route_id) => {\n    if (route_id in cp_ref.current)\n      tmp_cp_details.current = [...cp_ref.current[route_id]];\n  };\n\n  const load_temp_route = (route_id) => {\n    load_master_route_tmp_route(route_id);\n    load_master_node_tmp_node(route_id);\n    load_master_cp_tmp_cp(route_id);\n  };\n\n  function add_objects() {\n    layer.current.add(map_image.current);\n    stage_ruler.current.add(layer_ruler.current);\n    stage.current.add(layer.current);\n    draw_grid(true);\n    layer.current.draw();\n  }\n\n  function iterate_array_get_transformed_coordinates(map_coord_array) {\n    let transformed_array = [];\n    for (let i = 0; i < map_coord_array.length; i = i + 2) {\n      const pixel_coordinates = get_pixel_coordinate(map_coord_array[i], map_coord_array[i + 1]);\n      const transformed_coordinates = get_transformed_coordinates(pixel_coordinates[0], pixel_coordinates[1]);\n      transformed_array.push(...transformed_coordinates);\n    }\n    return transformed_array;\n  }\n\n  const smooth_path = (points_array, radius) => {\n    let flat_smooth_path = [];\n    let mat_points = new Matrix(points_array);\n    let smooth_path = generate_smooth_path(\n      mat_points,\n      radius\n    );\n    tmp_cp_details.current = iterate_array_get_transformed_coordinates(flatten(smooth_path.to2DArray()).slice(2, -2))\n    flat_smooth_path = parse(make_route(smooth_path));\n    return iterate_array_get_transformed_coordinates(flat_smooth_path);\n  }\n\n  const prepare_route_line_points = (route, update_ref_route) => {\n    let map_coordinates_points_array = [];\n    let route_details = route.current;\n    let route_radius = update_ref_route ? route_details.radius : route_details.radius || RADIUS;\n\n    map_coordinates_points_array.push([\n      ...get_map_coordinate(station_coord.current[route_details.from_station].x,\n        station_coord.current[route_details.from_station].y),\n    ])\n\n    if (!update_ref_route) {\n      route_details.node.forEach((node_id) => {\n        if (\n          node_id in tmp_node_details.current &&\n          !tmp_node_details.current[node_id].post_process\n        ) {\n          map_coordinates_points_array.push([\n            ...get_map_coordinate(tmp_node_details.current[node_id].x,\n              tmp_node_details.current[node_id].y)\n          ])\n        }\n      })\n    } else {\n      route_details.node.forEach((node_id) => {\n        const node = route_details.node_ref[node_id];\n        map_coordinates_points_array.push([...get_map_coordinate(node.x, node.y)]);\n      });\n    }\n\n    map_coordinates_points_array.push([\n      ...get_map_coordinate(\n        station_coord.current[route_details.to_station].x,\n        station_coord.current[route_details.to_station].y\n      )\n    ]);\n\n    return smooth_path(map_coordinates_points_array, route_radius);\n  }\n\n  const prepare_line_points = (update_ref_route = false) => {\n    let route_points = update_ref_route\n      ? prepare_route_line_points(reference_route_ref, update_ref_route)\n      : prepare_route_line_points(tmp_route_details, update_ref_route)\n    return route_points;\n  };\n\n  const draw_invalid_turns = (invalid_route) => {\n    invalid_route.forEach((points) => {\n      const invalid_line = draw_line(points, \"#3F50AA\", false, true);\n      drawn_invalid_route_ref.current.push(invalid_line);\n    });\n  };\n\n  const draw_route = (\n    show_control_points = true,\n    update_ref_route = false,\n    color = \"black\"\n  ) => {\n    const invalid_route = tmp_route_details.current.invalid_route || false;\n    let route_points = prepare_line_points(update_ref_route);\n    let line = draw_line(\n      route_points,\n      color,\n      update_ref_route,\n      false,\n      invalid_route\n    );\n\n    if (update_ref_route) {\n      reference_route_copy_ref.current = line;\n    }\n    show_control_points && draw_control_points();\n    return line;\n  };\n\n  const copy_tmp_route_master_route = (route_id) => {\n    route_ref.current[route_id] = cloneDeep(tmp_route_details.current);\n    route_ref.current[route_id][\"line\"] = line.current;\n    route_ref.current[route_id][\"route_id\"] = route_id;\n  };\n\n  const copy_tmp_node_master_node = (route_id) => {\n    Object.entries(tmp_node_details.current).forEach(([id, value]) => {\n      node_ref.current[id] = cloneDeep(value);\n      delete node_ref.current[id][\"node\"];\n    });\n  };\n\n  const copy_tmp_cp_master_cp = (route_id) => {\n    cp_ref.current[route_id] = [...tmp_cp_details.current];\n  };\n\n  const save_temp_route = (route_id) => {\n    copy_tmp_route_master_route(route_id);\n    copy_tmp_node_master_node(route_id);\n    copy_tmp_cp_master_cp(route_id);\n  };\n\n  const highlight_stations = (id, color = \"green\") => {\n    if (color !== \"green\" && color !== \"orange\") {\n      highlight_circle(id, color);\n    } else {\n      unhighlight_stations();\n      highlight_circle(id, color);\n    }\n  };\n\n  const highlight_circle = (id, color) => {\n    const station = icon_list.current[id];\n    let [Circle] = station.children;\n    Circle.attrs.fill = color;\n    Circle.strokeEnabled(true);\n    Circle.attrs.stroke = \"red\";\n    Circle.attrs.strokeWidth = 5;\n    Circle.dashEnabled(true);\n    Circle.dash([12, 12]);\n    layer.current.batchDraw();\n  };\n\n  const unhighlight_stations = () => {\n    Object.values(icon_list.current).forEach((station) => {\n      let [Circle] = station.children;\n      Circle.attrs.fill = \"orange\";\n      Circle.strokeEnabled(false);\n      Circle.dashEnabled(false);\n      layer.current.batchDraw();\n    });\n  };\n\n  const delete_path = (route_id) => {\n    remove_control_points();\n    remove_line_and_nodes(route_id);\n    if (route_id >= 0) {\n      remove_path_event_listeners();\n      set_route_added((state) => state - 1);\n    }\n  };\n\n  const remove_line_and_nodes = (route_id) => {\n    let line_to_delete =\n      route_id in route_ref.current && \"line\" in route_ref.current[route_id]\n        ? route_ref.current[route_id].line\n        : line.current;\n    line_to_delete.destroy();\n    if (route_id in route_ref.current) delete route_ref.current[route_id];\n    Object.entries(tmp_node_details.current).forEach(\n      ([node_id, node_details]) => {\n        node_details.node.destroy();\n        if (node_id in node_ref.current) delete node_ref.current[node_id];\n      }\n    );\n    layer.current.batchDraw();\n    reset_tmp_route_node_path();\n    // reset_station_selection();\n  };\n\n  const remove_control_points = () => {\n    if (tmp_cp_details.current.length > 0) {\n      if (tmp_route_details.current[\"cp_ref\"])\n        tmp_route_details.current[\"cp_ref\"].forEach((control_point) => {\n          control_point.destroy();\n        });\n      delete tmp_route_details.current[\"cp_ref\"];\n    }\n    tmp_cp_details.current = [];\n  };\n\n  const remove_path_event_listeners = (route_exception_id = null) => {\n    Object.values(route_ref.current).forEach((details) => {\n      if (\"line\" in details && details.route_id !== route_exception_id)\n        details.line.children[1].off(\"click.e1 tap.e1 touch.e1\");\n    });\n  };\n  const reset_tmp_route_node_path = () => {\n    tmp_route_details.current = {};\n    tmp_node_details.current = {};\n    line.current = null;\n  };\n\n  const reset_zindex = () => {\n\n    Object.values(icon_list.current).forEach((station) => {\n      station.moveToTop();\n    });\n    reference_route_ref.current && reference_route_ref.current.line.moveToTop();\n    line.current && line.current.moveToTop();\n    invalid_route_ref.current.forEach((invalid_turn) => {\n      invalid_turn.moveToTop();\n    });\n    Object.values(icon_name.current).forEach((station) => {\n      station.moveToTop();\n    });\n    tmp_route_details.current[\"cp_ref\"] &&\n      tmp_route_details.current[\"cp_ref\"].forEach((each_cp) => {\n        each_cp.moveToTop();\n      });\n    tooltip.current && tooltip.current.moveToTop();\n    Object.values(tmp_node_details.current).forEach((each_node) => {\n      each_node.node && each_node.node.moveToTop();\n    });\n    if (pivot_ref.current) pivot_ref.current.parent && pivot_ref.current.moveToTop();\n    layer.current.batchDraw();\n  };\n\n  const tabs = [\"Align Map\", \"Station\", \"Route\"];\n\n  const change_current_tab = (e) => {\n    switch (e.target.id) {\n      case \"Align Map\": {\n        set_current_tab(e.target.id);\n        break;\n      }\n      case \"Station\": {\n        set_current_tab(e.target.id);\n        break;\n      }\n      case \"Route\": {\n        set_current_tab(e.target.id);\n        break;\n      }\n    }\n  };\n\n  const tabs_buttons = () =>\n    tabs.map((tab_button, idx) => (\n      <button\n        key={idx}\n        onClick={change_current_tab}\n        className={`${current_tab === tab_button\n          ? \"map-editor-button-tabs-active\"\n          : \"map-editor-button-tabs\"\n          }`}\n        id={tab_button}\n      >\n        {tab_button}\n      </button>\n    ));\n\n  const allign_map_component = () => (\n    <AlignMap\n      map_image={map_image}\n      station_coord={station_coord}\n      icon_list={icon_list}\n      icon_name={icon_name}\n      map_cord={map_cord}\n      stage={stage}\n      layer={layer}\n      rotate_point={rotate_point}\n      shift_coord_update_pos={shift_coord_update_pos}\n      Y_OFFSET_NAME={Y_OFFSET_NAME}\n      clear_grid={clear_grid}\n      draw_grid={draw_grid}\n      grid_state={grid_on_off}\n      update_icon_pos={update_icon_pos}\n      node_ref={node_ref}\n      redraw_all_routes={redraw_all_routes}\n      circle_hide_tool_tip={circle_hide_tool_tip}\n      pivot={pivot}\n      angle_offset={angle_offset}\n      icon_list={icon_list}\n      is_mounted={is_mounted}\n      reset_zindex={reset_zindex}\n      pivot_ref={pivot_ref}\n    />\n  );\n  const station_component = () => (\n    <AddStations\n      map_image={map_image}\n      station_coord={station_coord}\n      icon_list={icon_list}\n      icon_name={icon_name}\n      map_cord={map_cord}\n      stage={stage}\n      layer={layer}\n      route_ref={route_ref}\n      node_ref={node_ref}\n      delete_all_routes={delete_all_routes}\n      load_temp_route={load_temp_route}\n      draw_route={draw_route}\n      line={line}\n      reset_tmp_route_node_path={reset_tmp_route_node_path}\n      tmp_route_details={tmp_route_details}\n      save_temp_route={save_temp_route}\n      get_map_coordinate={get_map_coordinate}\n      get_pixel_coordinate={get_pixel_coordinate}\n      get_untransformed_coordinates={get_untransformed_coordinates}\n      get_transformed_coordinates={get_transformed_coordinates}\n      Y_OFFSET_NAME={Y_OFFSET_NAME}\n      highlight_stations={highlight_stations}\n      unhighlight_stations={unhighlight_stations}\n      add_tooltip_event_listener_to={add_tooltip_event_listener_to}\n      tooltip={tooltip}\n      delete_path={delete_path}\n      set_current_tab={set_current_tab}\n      update_tooltip={update_tooltip}\n      circle_hide_tool_tip={circle_hide_tool_tip}\n      is_mounted={is_mounted}\n      reset_map_scale={reset_map_scale}\n      highlight_current_line={highlight_current_line}\n      reset_zindex={reset_zindex}\n    />\n  );\n  const route_component = () => (\n    <AddRoutes\n      delete_all_routes={delete_all_routes}\n      map_image={map_image}\n      station_coord={station_coord}\n      icon_list={icon_list}\n      icon_name={icon_name}\n      map_cord={map_cord}\n      stage={stage}\n      layer={layer}\n      node_ref={node_ref}\n      route_ref={route_ref}\n      count={count}\n      load_temp_route={load_temp_route}\n      cp_ref={cp_ref}\n      tmp_route_details={tmp_route_details}\n      tmp_node_details={tmp_node_details}\n      tmp_cp_details={tmp_cp_details}\n      draw_route={draw_route}\n      get_circle={get_circle}\n      draw_control_points={draw_control_points}\n      get_id={get_id}\n      line={line}\n      reset_tmp_route_node_path={reset_tmp_route_node_path}\n      save_temp_route={save_temp_route}\n      get_map_coordinate={get_map_coordinate}\n      highlight_stations={highlight_stations}\n      unhighlight_stations={unhighlight_stations}\n      delete_path={delete_path}\n      remove_control_points={remove_control_points}\n      remove_path_event_listeners={remove_path_event_listeners}\n      set_route_added={set_route_added}\n      map_image={map_image}\n      update_map_corner_pos={update_map_corner_pos}\n      update_station_panned_pos={update_station_panned_pos}\n      update_icon_pos={update_icon_pos}\n      update_node_pan_pos={update_node_pan_pos}\n      redraw_all_routes={redraw_all_routes}\n      clear_grid={clear_grid}\n      draw_grid={draw_grid}\n      circle_hide_tool_tip={circle_hide_tool_tip}\n      origin={origin}\n      scale={scale}\n      size={size}\n      map_scale={map_scale}\n      map_name={props.map_name}\n      trip_type={props.trip_type}\n      get_untransformed_coordinates={get_untransformed_coordinates}\n      get_transformed_coordinates={get_transformed_coordinates}\n      reference_route_ref={reference_route_ref}\n      tooltip={tooltip}\n      route_toggle_ref={route_toggle_ref}\n      route_toggle_button_ref={route_toggle_button_ref}\n      route_toggle_button_on={route_toggle_button_on}\n      is_mounted={is_mounted}\n      add_delete_mode={add_delete_mode}\n      set_add_delete_mode={set_add_delete_mode}\n      draw_line={draw_line}\n      invalid_route_ref={invalid_route_ref}\n      remove_invalid_turns={remove_invalid_turns}\n      check_valid_route={check_valid_route}\n      highlight_current_line={highlight_current_line}\n      reset_zindex={reset_zindex}\n    />\n  );\n  const current_tab_content = () => {\n    switch (current_tab) {\n      case \"Align Map\": {\n        return allign_map_component();\n      }\n      case \"Station\": {\n        return station_component();\n      }\n      case \"Route\": {\n        return route_component();\n      }\n      default: {\n        return allign_map_component();\n      }\n    }\n  };\n  const increase_map_scale = () => {\n    let scale = map_image.current.scaleX();\n    scale = scale + 0.1;\n    if (scale <= ZOOM_LIMIT) {\n      map_image.current.scale({ x: scale, y: scale });\n      map_image.current.x(\n        map_image.current.x() - (map_image.current.width() * 0.1) / 2\n      );\n      map_image.current.y(\n        map_image.current.y() - (map_image.current.height() * 0.1) / 2\n      );\n      // update_station_panned_pos();\n      update_map_corner_pos(map_image.current).then((_) => {\n        update_icon_pos();\n        // update_node_pan_pos();\n        redraw_all_routes(!route_toggle_ref.current);\n        circle_hide_tool_tip();\n        clear_grid(false);\n        draw_grid();\n        reset_zindex();\n      });\n    }\n  };\n  const decrease_map_scale = () => {\n    let scale = map_image.current.scaleX();\n    scale = scale - 0.1;\n    if (scale >= 1) {\n      map_image.current.scale({ x: scale, y: scale });\n      map_image.current.x(\n        map_image.current.x() + (map_image.current.width() * 0.1) / 2\n      );\n      map_image.current.y(\n        map_image.current.y() + (map_image.current.height() * 0.1) / 2\n      );\n      update_map_corner_pos(map_image.current).then((_) => {\n        update_icon_pos();\n        redraw_all_routes(!route_toggle_ref.current);\n        circle_hide_tool_tip();\n        clear_grid(false);\n        draw_grid();\n        reset_zindex();\n      });\n    }\n  };\n\n  const route_toggle_button = () => {\n    if (!route_toggle_ref.current) {\n      route_toggle_button_off();\n    } else {\n      route_toggle_button_on();\n    }\n  };\n\n  const route_toggle_button_on = () => {\n    route_toggle_button_ref.current.innerHTML = \"Routes On\";\n    route_toggle_button_ref.current.style.backgroundColor = \"#005086\";\n    redraw_all_routes();\n    reset_zindex();\n    route_toggle_ref.current = false;\n  };\n\n  const route_toggle_button_off = () => {\n    route_toggle_button_ref.current.innerHTML = \"Routes Off\";\n    route_toggle_button_ref.current.style.backgroundColor = \"darkred\";\n    redraw_all_routes(false);\n    reset_zindex();\n    route_toggle_ref.current = true;\n  };\n\n  const reset_map_scale = () => {\n    map_image.current.scale({ x: 1, y: 1 });\n    map_image.current.x((stage.current.width() - size.x * map_scale) / 2);\n    map_image.current.y((stage.current.height() - size.y * map_scale) / 2);\n\n    update_map_corner_pos(map_image.current).then((_) => {\n      update_icon_pos();\n      redraw_all_routes(!route_toggle_ref.current);\n      circle_hide_tool_tip();\n      clear_grid(false);\n      draw_grid();\n      reset_zindex();\n    });\n  };\n  const route_toggle_button_handler = () => (\n    <button\n      ref={route_toggle_button_ref}\n      onClick={route_toggle_button}\n      className=\"grid-button-route\"\n    >\n      Routes On\n    </button>\n  );\n  return (\n    <>\n      <div className=\"map-editor-div\">\n        <div className=\"map-div\">\n          <div className=\"tools\">\n            {tmp_route_details.current && route_toggle_button_handler()}\n            <button\n              value={grid_on_off}\n              onClick={clear_draw_grid}\n              style={\n                grid_on_off\n                  ? { backgroundColor: \"#005086\", color: \"white\" }\n                  : { backgroundColor: \"darkred\", color: \"white\" }\n              }\n              className=\"grid-button\"\n            >\n              Grid {grid_on_off ? \"On\" : \"Off\"}\n            </button>\n            <button onClick={increase_map_scale}>+</button>\n            <button onClick={decrease_map_scale}>-</button>\n            <button onClick={reset_map_scale}>x</button>\n          </div>\n\n          <div className=\"konva-container\" ref={map_div_ref}>\n            <div id=\"konva-div-ruler\"></div>\n            <div id=\"konva-div\"></div>\n          </div>\n        </div>\n\n        <div className=\"input-div\">\n          <div className=\"tab-buttons\">{tabs_buttons()}</div>\n          {image_loaded && (\n            <div className=\"tab-content\">{current_tab_content()}</div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default MapEditor;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport MapEditor from \"./MapEditor\";\nimport { useAlerts, useFetch, pulse_spinner } from \"ati-ui\";\nimport { api_url } from \"../../conf\";\nimport { check_webui_json_file, check_waypoints_map_editor } from \"./utils\";\nimport { useParams } from \"react-router-dom\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\n\nfunction MapEditorAPI() {\n  const [map_editor_load, set_map_editor_load] = useState(false);\n  const [image, set_image] = useState(null);\n  const [data, set_data] = useState(null);\n  const [waypoints_data, set_waypoints_data] = useState(null);\n  const is_mounted = useRef(false);\n\n  const { add_alert } = useAlerts();\n  const { id } = useParams();\n\n  const on_error = (err) => {\n    add_alert({\n      message: \"Some Unexpected error occurred!\",\n      status: \"danger\",\n    });\n  };\n\n  useEffect(() => {\n    is_mounted.current = true;\n    return () => {\n      is_mounted.current = false;\n    }\n  }, []);\n\n  useEffect(() => {\n    fetch_files({request_headers: headers()});\n  }, [id]);\n\n  const on_success = (data) => {\n    console.log(data, \"files data\");\n    add_alert({\n      message: \"Files are retrieved!\",\n      status: \"info\",\n    });\n\n    if (check_webui_json_file(data.webui_map_json)) {\n      is_mounted.current && set_data(data.webui_map_json);\n      is_mounted.current && set_image(data.webui_map_image);\n      if (data.waypoints !== null) {\n        let result = check_waypoints_map_editor(data.waypoints);\n        is_mounted.current && set_waypoints_data(result);\n      }\n      is_mounted.current && set_map_editor_load(true);\n    }\n  };\n\n  const load_map_editor = (data, image) => {\n    const scale = data.maps[0].scale;\n    const size = data.maps[0].size;\n    const origin = data.maps[0].origin;\n    const map_name = data.map_name;\n    const trip_type = data.trip_type || \"p2p\";\n\n    return (\n      <MapEditor\n        scale={scale}\n        size={size}\n        origin={origin}\n        map_name={map_name}\n        image={image}\n        trip_type={trip_type}\n        waypoints_data={waypoints_data}\n      />\n    );\n  };\n\n  const [fetch_files, files_loading] = useFetch({\n    url: `${api_url}/map_editor/${id}`,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data);\n    },\n  });\n  return map_editor_load ? load_map_editor(data, image) : <div className=\"map-editor-api-main-container\">{pulse_spinner}</div>;\n}\n\nexport default MapEditorAPI;\n","import React, { useState, useEffect, useRef} from \"react\";\nimport { AtiButton, useFetch } from \"ati-ui\";\nimport \"react-placeholder/lib/reactPlaceholder.css\";\nimport { RectShape, TextBlock } from \"react-placeholder/lib/placeholders\";\nimport { api_url } from \"../../conf\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\n\nconst rect_shape_placeholder = (\n  <RectShape color=\"#E0E0E0\" style={{ minWidth: \"7rem\", height: \"3rem\" }} />\n);\nconst text_placeholder = <TextBlock color=\"#E0E0E0\" rows={1} />;\n\nexport default function WebctlStationSelector({\n  hide_modal,\n  add_alert,\n  select_station_and_set_status,\n}) {\n  const [stations, set_stations] = useState<String[] | null>(null);\n  const is_mounted = useRef(false);\n\n  const on_success = (data) => {\n    is_mounted.current && set_stations(data.stations);\n  };\n\n  const on_error = (err) => {\n    add_alert({\n      message: \"Some Unexpected error occurred!\",\n      status: \"danger\",\n    });\n  };\n\n  const [fetch_stations, stations_loading] = useFetch({\n    url: `${api_url}/stations`,\n    method: \"get\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data);\n    },\n  });\n\n  useEffect(() => {\n    is_mounted.current = true;\n    console.log(\"component mounted\");\n    fetch_stations({ request_headers: headers()});\n    return () => {\n      is_mounted.current = false;\n    }\n  }, []);\n\n  const loading_station_button = () => {\n    return (\n      <>\n        <div className=\"loading-station-button\">{rect_shape_placeholder}</div>\n        <div className=\"loading-station-button\">{rect_shape_placeholder}</div>\n        <div className=\"loading-station-button\">{rect_shape_placeholder}</div>\n        <div className=\"loading-station-button\">{rect_shape_placeholder}</div>\n        <div className=\"loading-station-button\">{rect_shape_placeholder}</div>\n      </>\n    );\n  };\n\n  const station_button = (e) => {\n    select_station_and_set_status(\n      { request_body: { action: e.target.dataset.type, station: e.target.dataset.id } },\n    );\n    hide_modal();\n  };\n\n  const show_stations = () => {\n    let stations_list =\n      stations &&\n      stations.map((station, index) => (\n        <AtiButton\n          key={index}\n          data-id={station}\n          className=\"station-button\"\n          data-testid=\"station-button\"\n          data-type=\"auto\"\n          onClick={(e) => station_button(e)}\n        >\n          {station}\n        </AtiButton>\n      ));\n    return <>{stations_list}</>;\n  };\n\n  return (\n    <div className=\"stations-wrapper\">\n      <span\n        data-testid=\"sherpa-station-title\"\n        className=\"status-text sherpa-status-text\"\n      >\n        {stations_loading ? (\n          <span className=\"text-placeholder-wrapper\">{text_placeholder}</span>\n        ) : (\n          \"Which station is the Sherpa at?\"\n        )}\n      </span>\n      <div className=\"stations-container\">\n        {stations_loading ? loading_station_button() : show_stations()}\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useRef } from \"react\";\nimport {\n  useAlerts,\n  AtiButton,\n  useFetch,\n  pulse_spinner,\n  useAtimodal,\n} from \"ati-ui\";\nimport WebctlStationSelector from \"./WebctlStationSelector\";\nimport \"./webctl.scss\";\nimport { TextBlock } from \"react-placeholder/lib/placeholders\";\nimport { api_url } from \"../../conf\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\n\nconst status_placeholder = <TextBlock color=\"#E0E0E0\" rows={1} />;\n\nfunction Webctl() {\n  const [sherpa_status, set_sherpa_status] = useState<String>(\"\");\n  const { add_alert } = useAlerts();\n  const [StationModal, show_station_modal, hide_station_modal] = useAtimodal();\n  const [mode, set_mode] = useState<string|null>(null);\n  const is_mounted = useRef(false);\n\n  const spinner_div = () => <div className=\"spinner-div\">{pulse_spinner}</div>;\n\n  useEffect(() => {\n    is_mounted.current = true;\n    fetch_initial_mode({request_headers: headers()});\n    return () => {\n      is_mounted.current = false;\n    };\n  }, []);\n\n  const on_success = (data, type) => {\n    switch (type) {\n      case \"remote\": {\n        add_alert({\n          message: \"Switched to remote drive\",\n          status: \"info\",\n        });\n        is_mounted.current && set_mode(type);\n        is_mounted.current && set_sherpa_status(\"Sherpa is in remote drive\");\n        break;\n      }\n      case \"dualshock\": {\n        add_alert({\n          message: \"Switched to manual mode!\",\n          status: \"info\",\n        });\n        is_mounted.current && set_mode(type);\n        is_mounted.current && set_sherpa_status(\"Sherpa is in manual mode\");\n        break;\n      }\n      case \"shutdown\": {\n        add_alert({\n          message: \"Turned off the vehicle!\",\n          status: \"info\",\n        });\n        is_mounted.current && set_mode(type);\n        is_mounted.current && set_sherpa_status(\"Sherpa is turned off\");\n        break;\n      }\n      case \"auto\": {\n        add_alert({\n          message: \"Switched to autonomous mode!\",\n          status: \"info\",\n        });\n        is_mounted.current && set_mode(type);\n        is_mounted.current && set_sherpa_status(`Sherpa is in autonomous mode at ${data.station}`);\n        break;\n      }\n      default: {\n        is_mounted.current && set_mode(\"\");\n        add_alert({\n          message: \"Some Unexpected error occurred!\",\n          status: \"danger\",\n        });\n      }\n    }\n  };\n\n  const on_error = (err) => {\n    console.log(\"err\", err);\n    add_alert({\n      message: \"Some Unexpected error occurred!\",\n      status: \"danger\",\n    });\n  };\n\n  const on_fetch_mode_success = (data) => {\n    is_mounted.current && set_mode(data.mode);\n  };\n\n  const [fetch_initial_mode, initial_mode_loading] = useFetch({\n    url: `${api_url}/mode`,\n    method: \"get\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_fetch_mode_success(data);\n    },\n  });\n\n  const [remote_post, remote_loading] = useFetch({\n    url: api_url,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data, \"remote\");\n    },\n  });\n  const [dual_shock_post, dual_shock_loading] = useFetch({\n    url: api_url,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data, \"dualshock\");\n    },\n  });\n  const [shutdown_post, shutdown_loading] = useFetch({\n    url: api_url,\n    method: \"post\",\n    on_error: on_error,\n\n    on_success: ({ data }) => {\n      on_success(data, \"shutdown\");\n    },\n  });\n\n  const select_station_and_set_status = async (args) => {\n    await select_station(args);\n  };\n\n  const [select_station, auto_button_loading] = useFetch({\n    url: api_url,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data, \"auto\");\n    },\n  });\n\n  const status_button_onclick = async (e) => {\n    const type = e.target.dataset.type;\n    const inner_html = e.target.innerHTML;\n    switch (type) {\n      case \"remote\": {\n        await remote_post({ request_body: { action: type }, request_headers: headers()});\n        break;\n      }\n      case \"dualshock\": {\n        await dual_shock_post({ request_body: { action: type} , request_headers: headers()});\n        break;\n      }\n      case \"shutdown\": {\n        shutdown_post({ request_body: { action: type }, request_headers: headers()});\n        break;\n      }\n      default: {\n        add_alert({\n          message: \"Some Unexpected error occurred!\",\n          status: \"danger\",\n        });\n      }\n    }\n  };\n\n  return (\n    <div className=\"status-app-wrapper\">\n      <span data-testid=\"sherpa-status-title\" className=\"status-text\">\n        {initial_mode_loading ||\n        remote_loading ||\n        dual_shock_loading ||\n        auto_button_loading ||\n        shutdown_loading ? (\n          <span className=\"text-placeholder-wrapper\">{status_placeholder}</span>\n        ) : (\n          sherpa_status\n        )}\n      </span>\n      <div className=\"buttons-wrapper\">\n        <AtiButton\n          className={`status-button desaturated-yellow ${\n            mode === \"remote\" ? \"current-mode-disable-button\" : \"\"\n          }`}\n          data-type=\"remote\"\n          onClick={(e) => {\n            !remote_loading && status_button_onclick(e);\n          }}\n          data-testid=\"remote-drive-button\"\n          disabled={\n            initial_mode_loading ||\n            shutdown_loading ||\n            dual_shock_loading ||\n            auto_button_loading ||\n            mode === \"remote\"\n              ? true\n              : false\n          }\n        >\n          {remote_loading ? spinner_div() : \"Drive via remote\"}\n        </AtiButton>\n        <AtiButton\n          className={`status-button desaturated-orange ${\n            mode === \"dualshock\" ? \"current-mode-disable-button\" : \"\"\n          }`}\n          data-type=\"dualshock\"\n          onClick={(e) => {\n            !dual_shock_loading && status_button_onclick(e);\n          }}\n          data-testid=\"dual-shock-button\"\n          disabled={\n            initial_mode_loading ||\n            remote_loading ||\n            shutdown_loading ||\n            auto_button_loading ||\n            mode === \"dualshock\"\n              ? true\n              : false\n          }\n        >\n          {dual_shock_loading\n            ? spinner_div()\n            : \"Drive via dualshock 4 controller\"}\n        </AtiButton>\n        <AtiButton\n          className={`status-button desaturated-green ${\n            mode === \"auto\" ? \"current-mode-disable-button\" : \"\"\n          }`}\n          data-type=\"auto\"\n          onClick={(e) => {\n            !auto_button_loading && show_station_modal();\n          }}\n          data-testid=\"auto-button\"\n          disabled={\n            initial_mode_loading ||\n            remote_loading ||\n            dual_shock_loading ||\n            shutdown_loading ||\n            mode === \"auto\"\n              ? true\n              : false\n          }\n        >\n          {auto_button_loading ? spinner_div() : \"Switch into autonomous mode\"}\n        </AtiButton>\n        <AtiButton\n          className={`status-button desaturated-red ${\n            mode === \"shutdown\" ? true : false\n          }`}\n          data-type=\"shutdown\"\n          onClick={(e) => {\n            !shutdown_loading && status_button_onclick(e);\n          }}\n          data-testid=\"shutdown-button\"\n          disabled={\n            initial_mode_loading ||\n            remote_loading ||\n            dual_shock_loading ||\n            auto_button_loading ||\n            mode === \"shutdown\"\n              ? true\n              : false\n          }\n        >\n          {shutdown_loading ? spinner_div() : \"Shutdown\"}\n        </AtiButton>\n      </div>\n      <StationModal data-testid=\"modal\">\n        <WebctlStationSelector\n          hide_modal={hide_station_modal}\n          add_alert={add_alert}\n          select_station_and_set_status={select_station_and_set_status}\n        />\n      </StationModal>\n    </div>\n  );\n}\n\nexport default Webctl;\n","import React, { useRef, useEffect, useCallback } from \"react\";\n\nfunction VideoFeed({ video_feed }) {\n  const video_ref = useRef<HTMLVideoElement>(null);\n\n  useEffect(() => {\n    if (video_feed !== null && video_ref.current) {\n      const video = video_ref.current;\n      video && (video.srcObject = video_feed);\n    }\n  }, [video_feed, video_ref]);\n  return (\n    <div className=\"video-wrapper\">\n      <video autoPlay playsInline ref={video_ref} height=\"100%\" />\n    </div>\n  );\n}\n\nexport default VideoFeed;\n","import React, { useEffect, useState, useRef } from \"react\";\nimport Konva from \"konva\";\nimport { Stage } from \"konva/types/Stage\";\nimport { Circle } from \"konva/types/shapes/Circle\";\nimport { Line } from \"konva/types/shapes/Line\";\nimport arrow from \"./icons/arrow.svg\";\n\nimport { convert_to_radians } from \"../../utilities/genericFunctions\";\n\nfunction Joystick({ set_direction }) {\n  const joystick_ref = useRef<HTMLDivElement>(null);\n  const stage = useRef<any>(null);\n  const joystick_layer = useRef<any>(null);\n  const outlines_layer = useRef<any>(null);\n  const buttons_layer = useRef<any>(null);\n  const JOYSTICK_MARGIN = 30;\n  const direction_ref = useRef<string | null>(null);\n  const buttons_ref = useRef<{ [key: string]: Line }>({});\n  const keys_pressed = useRef({});\n  const arrow_image = useRef(new Image());\n  const BUTTON_COLOR = \"#52595F\";\n  const CONTROLER_COLOR = \"#424A4D\";\n\n  const draw_joystick = () => {\n    const ctx = stage.current;\n    const stage_height = ctx.height();\n    const stage_width = ctx.width();\n    const c_x = stage_width / 2;\n    const c_y = stage_height / 2;\n\n    const circle_radius = 40;\n    const circle: Circle = new Konva.Circle({\n      x: stage_height / 2,\n      y: stage_width / 2,\n      radius: circle_radius,\n      fill: \"white\",\n      draggable: true,\n      stroke: BUTTON_COLOR,\n      strokeWidth: 5,\n      dragBoundFunc: function (pos) {\n        var x = stage_width / 2;\n        var y = stage_height / 2;\n        var radius = stage_width / 2 - circle_radius - JOYSTICK_MARGIN + 15;\n        var scale =\n          radius / Math.sqrt(Math.pow(pos.x - x, 2) + Math.pow(pos.y - y, 2));\n        if (scale < 1)\n          return {\n            y: Math.round((pos.y - y) * scale + y),\n            x: Math.round((pos.x - x) * scale + x),\n          };\n        else return pos;\n      },\n    });\n\n    joystick_layer.current = new Konva.Layer();\n    joystick_layer.current.add(circle);\n    ctx.add(joystick_layer.current);\n    ctx.batchDraw();\n\n    circle.on(\"dragmove\", () => {\n      const p1 = {\n        x: 0,\n        y: 0,\n      };\n\n      const p2 = {\n        x: -(c_x - circle.x()),\n        y: c_y - circle.y(),\n      };\n\n      let angle_deg = (Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180) / Math.PI;\n\n      let angle_save = angle_deg < -90 ? 90 - angle_deg - 360 : 90 - angle_deg;\n\n      set_direction(angle_save);\n    });\n\n    // const joystick_dragend = new Konva.Tween({\n    //   node: circle,\n    //   duration: 3,\n    //   easing: Konva.Easings.ElasticEaseInOut,\n    //   onUpdate: () => console.log(\"node attrs updated\"),\n    //   onFinish: () => console.log(\"finished\"),\n    //   x: stage_width / 2,\n    //   y: stage_height / 2,\n    // });\n\n    circle.on(\"dragend\", () => {\n      circle.x(stage_width / 2);\n      circle.y(stage_height / 2);\n      //   joystick_dragend.play();\n      set_direction(null);\n    });\n  };\n\n  const unhighlight_all_buttons = () => {\n    Object.values(buttons_ref.current).forEach((button) => {\n      button.fill(BUTTON_COLOR);\n    });\n  };\n\n  const update_buttons_highlight = () => {\n    unhighlight_all_buttons();\n    console.log(\"update_buttons_highlight\");\n    if (direction_ref.current && buttons_ref.current) {\n      console.log(\n        \"direction_ref.current && buttons_ref.current\",\n        buttons_ref.current[direction_ref.current]\n      );\n      const direction = direction_ref.current;\n      if (direction)\n        if (direction in buttons_ref.current)\n          buttons_ref.current[direction].fill(\"black\");\n    }\n    stage.current.batchDraw();\n  };\n\n  const draw_center_and_outer_circle = () => {\n    const ctx = stage.current;\n    const stage_height = ctx.height();\n    const stage_width = ctx.width();\n\n    const outer_circle_radius = stage_width / 2 - JOYSTICK_MARGIN;\n    const outer_circle: Circle = new Konva.Circle({\n      x: stage_height / 2,\n      y: stage_width / 2,\n      radius: outer_circle_radius,\n      fill: CONTROLER_COLOR,\n    });\n\n    const inner_circle_radius = 10;\n    const inner_circle: Circle = new Konva.Circle({\n      x: stage_height / 2,\n      y: stage_width / 2,\n      radius: inner_circle_radius,\n      fill: \"white\",\n    });\n\n    const outest_radius = stage_width / 2 - 2;\n    const outest_circle: Circle = new Konva.Circle({\n      x: stage_height / 2,\n      y: stage_width / 2,\n      radius: outest_radius,\n      fill: CONTROLER_COLOR,\n    });\n\n    outlines_layer.current = new Konva.Layer();\n    outlines_layer.current.add(outer_circle);\n    outlines_layer.current.add(outest_circle);\n    outlines_layer.current.add(inner_circle);\n    ctx.add(outlines_layer.current);\n    ctx.batchDraw();\n  };\n\n  const set_direction_vector_from_direction = (direction: String) => {\n    switch (direction) {\n      case \"east\": {\n        set_direction(90);\n        break;\n      }\n      case \"west\": {\n        set_direction(-90);\n        break;\n      }\n      case \"north-\": {\n        set_direction(-30);\n        break;\n      }\n      case \"north\": {\n        set_direction(0);\n        break;\n      }\n      case \"north+\": {\n        set_direction(30);\n        break;\n      }\n      case \"south-\": {\n        set_direction(150);\n        break;\n      }\n      case \"south\": {\n        set_direction(-180);\n        break;\n      }\n      case \"south+\": {\n        set_direction(-150);\n        break;\n      }\n      case \"north_east\": {\n        set_direction(60);\n        break;\n      }\n      case \"north_west\": {\n        set_direction(-60);\n        break;\n      }\n      case \"south_east\": {\n        set_direction(120);\n        break;\n      }\n      case \"south_west\": {\n        set_direction(-120);\n        break;\n      }\n    }\n  };\n\n  const draw_buttons = () => {\n    buttons_layer.current = new Konva.Layer();\n\n    const ctx = stage.current;\n    const stage_height = ctx.height();\n    const stage_width = ctx.width();\n\n    const center_x = stage_width / 2;\n    const center_y = stage_height / 2;\n\n    const outer_circle_radius = stage_width / 2 - JOYSTICK_MARGIN;\n    const outest_radius = stage_width / 2 - 2;\n\n    const no_of_segments = 12;\n    const each_segment = 360 / no_of_segments;\n    const start_angle = -90 - each_segment / 2;\n\n    let i;\n    let angle = start_angle;\n    const buttons = [\n      \"north\",\n      \"north+\",\n      \"north_east\",\n      \"east\",\n      \"south_east\",\n      \"south-\",\n      \"south\",\n      \"south+\",\n      \"south_west\",\n      \"west\",\n      \"north_west\",\n      \"north-\",\n    ];\n    let icon_rotation = 0;\n    for (i = 0; i < no_of_segments; i++) {\n      console.log(\"loop\");\n      let angle_rad = convert_to_radians(angle, 10);\n      const points: Array<number> = [];\n      let x = center_x + outer_circle_radius * Math.cos(angle_rad);\n      let y = center_y + outer_circle_radius * Math.sin(angle_rad);\n      points.push(x, y);\n\n      let each_angle;\n      for (\n        each_angle = angle;\n        each_angle <= angle + each_segment;\n        each_angle += each_segment / 5\n      ) {\n        const each_angle_rad = convert_to_radians(each_angle, 10);\n        x = center_x + outer_circle_radius * Math.cos(each_angle_rad);\n        y = center_y + outer_circle_radius * Math.sin(each_angle_rad);\n        points.push(x, y);\n      }\n\n      const icon_angle = angle + each_segment / 2;\n      const icon_angle_rad = convert_to_radians(icon_angle, 10);\n      const icon_radius =\n        (outest_radius - outer_circle_radius) / 2 + outer_circle_radius;\n\n      const icon_x = center_x + icon_radius * Math.cos(icon_angle_rad);\n      const icon_y = center_y + icon_radius * Math.sin(icon_angle_rad);\n\n      const icon = new Konva.Image({\n        x: icon_x,\n        y: icon_y,\n        id: i,\n        image: arrow_image.current,\n        width: 20,\n        height: 20,\n        rotation: icon_rotation,\n        offset: {\n          x: 10,\n          y: 10,\n        },\n      });\n      icon_rotation += each_segment;\n      angle = angle + each_segment;\n      angle_rad = convert_to_radians(angle, 10);\n\n      x = center_x + outest_radius * Math.cos(angle_rad);\n      y = center_y + outest_radius * Math.sin(angle_rad);\n      points.push(x, y);\n\n      for (\n        each_angle = angle;\n        each_angle >= angle - each_segment;\n        each_angle -= each_segment / 8\n      ) {\n        const each_angle_rad = convert_to_radians(each_angle, 10);\n        x = center_x + outest_radius * Math.cos(each_angle_rad);\n        y = center_y + outest_radius * Math.sin(each_angle_rad);\n        points.push(x, y);\n      }\n\n      const line = new Konva.Line({\n        points: points,\n        fill: BUTTON_COLOR,\n        stroke: CONTROLER_COLOR,\n        strokeWidth: 5,\n        closed: true,\n        id: i,\n      });\n      const group = new Konva.Group();\n      if (buttons[i] !== \"east\" && buttons[i] !== \"west\") {\n        group.add(line, icon);\n        group.on(\"touchstart mousedown\", (e) => {\n          console.log(\"e.target.attrs\", e.target.attrs);\n          const id = parseInt(e.target.attrs.id);\n          set_direction_vector_from_direction(buttons[id]);\n          direction_ref.current = buttons[id];\n          update_buttons_highlight();\n        });\n\n        group.on(\"touchend mouseup mouseleave touchmove\", (e) => {\n          const id = parseInt(e.target.attrs.id);\n          set_direction(null);\n          direction_ref.current = null;\n          update_buttons_highlight();\n        });\n        const id = line.attrs.id;\n        console.log(id);\n        buttons_ref.current[buttons[id]] = line;\n        buttons_layer.current.add(group);\n      }\n    }\n\n    ctx.add(buttons_layer.current);\n    ctx.batchDraw();\n  };\n\n  useEffect(() => {\n    let isMounted = true;\n    const joystick_container = joystick_ref.current;\n    console.log(\"joystick_container\", joystick_container);\n    if (joystick_container)\n      stage.current = new Konva.Stage({\n        container: \"joystick\",\n        width: joystick_container.offsetWidth,\n        height: joystick_container.offsetHeight,\n      });\n    arrow_image.current.src = String(arrow);\n    arrow_image.current.onload = function () {\n      draw_buttons();\n      draw_joystick();\n    };\n    draw_center_and_outer_circle();\n    console.log(\"buttons_ref\", buttons_ref);\n    document.addEventListener(\"keypress\", function (event) {\n      console.log(\n        `Key: ${event.key} with keycode ${event.keyCode} has been pressed down`\n      );\n      if (!event.repeat) {\n        if (\n          event.key === \"w\" ||\n          event.key === \"a\" ||\n          event.key === \"s\" ||\n          event.key === \"d\"\n        ) {\n          keys_pressed.current[event.key] = true;\n        }\n        const keys_pressed_object = keys_pressed.current;\n\n        if (keys_pressed_object[\"w\"] && keys_pressed_object[\"a\"]) {\n          direction_ref.current = \"north-\";\n          set_direction_vector_from_direction(\"north-\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"w\"] && keys_pressed_object[\"d\"]) {\n          direction_ref.current = \"north+\";\n          set_direction_vector_from_direction(\"north+\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"s\"] && keys_pressed_object[\"d\"]) {\n          direction_ref.current = \"south-\";\n          set_direction_vector_from_direction(\"south-\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"s\"] && keys_pressed_object[\"a\"]) {\n          direction_ref.current = \"south+\";\n          set_direction_vector_from_direction(\"south+\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"w\"]) {\n          direction_ref.current = \"north\";\n          set_direction_vector_from_direction(\"north\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"a\"]) {\n          direction_ref.current = \"north_west\";\n          set_direction_vector_from_direction(\"north_west\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"s\"]) {\n          direction_ref.current = \"south\";\n          set_direction_vector_from_direction(\"south\");\n          update_buttons_highlight();\n        } else if (keys_pressed_object[\"d\"]) {\n          direction_ref.current = \"north_east\";\n          set_direction_vector_from_direction(\"north_east\");\n          update_buttons_highlight();\n        }\n      }\n    });\n    document.addEventListener(\"keyup\", function (event) {\n      console.log(\n        `Key: ${event.key} with keycode ${event.keyCode} has been pressed up`\n      );\n      if (\n        event.key === \"w\" ||\n        event.key === \"a\" ||\n        event.key === \"s\" ||\n        event.key === \"d\"\n      ) {\n        direction_ref.current = null;\n        update_buttons_highlight();\n        set_direction(null);\n        delete keys_pressed.current[event.key];\n      }\n    });\n    return () => {\n      isMounted = false;\n    };\n  }, [joystick_ref]);\n\n  return (\n    <div className=\"joystick-container\" ref={joystick_ref}>\n      <div id=\"joystick\"></div>\n    </div>\n  );\n}\n\nexport default Joystick;\n","import React from 'react'\n\nfunction LidarView() {\n    return (\n        <div className=\"lidar-view-container\">\n            Lidar view\n        </div>\n    )\n}\n\nexport default LidarView;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport VideoFeed from \"./VideoFeed\";\nimport Joystick from \"./Joystick\";\nimport LidarView from \"./LidarView\";\nimport \"./remote_drive.scss\";\n\nfunction RemoteDrive() {\n  const [direction, set_direction] = useState<number | null>(null);\n  const [velocity, set_velocity] = useState<number | null>(null);\n  const [video_feed, set_video_feed] = useState<MediaStream | null>(null);\n  const [spectator, set_spectator] = useState(false);\n  const [disengage, set_disengage] = useState(false);\n  const video_ref = useRef<HTMLVideoElement>(null);\n  const data_channel_ref = useRef<RTCDataChannel | null>(null);\n\n  useEffect(() => {\n    console.log(\"video_feed\", video_feed);\n  }, [video_feed]);\n\n  async function connect_websocket(): Promise<WebSocket> {\n    return new Promise(function (resolve, reject) {\n      const protocol = window.location.protocol === \"https://\" ? \"wss\" : \"ws\";\n      const socket: WebSocket = new WebSocket(\n        `${protocol}://${window.location.hostname}:4000`\n      );\n      socket.binaryType = \"arraybuffer\";\n      socket.onopen = () => resolve(socket);\n      socket.onerror = (err) => reject(err);\n    });\n  }\n\n  const start_video = async (): Promise<RTCDataChannel> => {\n    const signaling = await connect_websocket();\n\n    // Create PeerConnection\n    const config = {\n      sdpSemantics: \"unified-plan\",\n      iceServers: [{ urls: [\"stun:stun.l.google.com:19302\"] }],\n    };\n\n    const peer_connection = new RTCPeerConnection(config);\n\n    peer_connection.addEventListener(\"track\", (evt) => {\n      if (evt.track.kind === \"video\") {\n        set_video_feed(evt.streams[0]);\n      }\n    });\n\n    peer_connection.addTransceiver(\"video\", { direction: \"recvonly\" });\n\n    peer_connection.onicecandidate = (event) => {\n      if (event.candidate) {\n        signaling.send(\n          JSON.stringify({\n            message_type: \"CANDIDATE\",\n            content: JSON.stringify(event.candidate),\n          })\n        );\n      }\n    };\n\n    // peer_connection.ondatachannel = receiveChannelCallback;\n    // const handle_receive_message = (event) => {\n    //   console.log(\"handleReceiveMessage\", event);\n    // };\n\n    // const handle_receive_channel_status_change = (event) => {\n    //   console.log(\"handle_receive_channel_status_change\", event);\n    // };\n\n    // function receiveChannelCallback(event) {\n    //   console.log(\"receiveChannelCallback\", event);\n    //   let receiveChannel = event.channel;\n    //   receiveChannel.onmessage = handle_receive_message;\n    //   receiveChannel.onopen = handle_receive_channel_status_change;\n    //   receiveChannel.onclose = handle_receive_channel_status_change;\n    // }\n\n    signaling.addEventListener(\"message\", async (event) => {\n      const { message_type, content } = JSON.parse(event.data);\n      if (message_type === \"spectator\") {\n        set_spectator(true);\n      } else if (message_type === \"CANDIDATE\") {\n        const candidate = new RTCIceCandidate(JSON.parse(content));\n        await peer_connection.addIceCandidate(candidate);\n      } else if (message_type === \"SDP\") {\n        await peer_connection.setRemoteDescription(content);\n      }\n    });\n\n    //data channel\n    let data_channel = peer_connection.createDataChannel(\"data\");\n    data_channel.binaryType = \"arraybuffer\";\n    data_channel.addEventListener(\"message\", (event) => {\n      console.log(\"event\", event);\n      // lidar_data = event.data;\n      // lidar_timestamp = performance.now();\n    });\n\n    const offer = await peer_connection.createOffer();\n    await peer_connection.setLocalDescription(offer);\n    signaling.send(JSON.stringify({ message_type: \"SDP\", content: offer }));\n\n    return data_channel;\n  };\n\n  useEffect(() => {\n    const async_func = async () => {\n      const data_channel = await start_video();\n      data_channel_ref.current = data_channel;\n      const data_channel_curr = data_channel_ref.current;\n\n      await new Promise(function (resolve, reject) {\n        data_channel_curr &&\n          (data_channel_curr.onopen = () => {\n            console.log(\"Data channel open!!\");\n            resolve(null);\n          });\n        data_channel_curr &&\n          (data_channel_curr.onerror = (err) => {\n            console.log(\"err\", err);\n            reject(err);\n          });\n      });\n    };\n    async_func();\n  }, []);\n\n  useEffect(() => {\n    if (direction !== null) {\n      set_velocity((90 - Math.abs(direction)) / 90);\n    } else {\n      set_velocity(null);\n    }\n\n    const data_channel = data_channel_ref.current;\n    console.log(\"data_channel\", data_channel && data_channel.readyState);\n    data_channel && data_channel.send(Float32Array.from([12, 13]).buffer);\n  }, [direction]);\n\n  return (\n    <div className=\"remote-drive-container\">\n      <VideoFeed video_feed={video_feed} />\n      <Joystick set_direction={set_direction} />\n      <LidarView />\n      angle: {direction} velocity: {velocity}\n      {JSON.stringify(spectator)}\n    </div>\n  );\n}\n\nexport default RemoteDrive;\n","import React, { useEffect, useState, useRef } from \"react\";\nimport {\n  DropdownInput,\n  TextInput,\n  AtiButton,\n  useFetch,\n  useAlerts,\n  pulse_spinner,\n  AtiProgress,\n} from \"ati-ui\";\nimport \"./map-creator.scss\";\nimport { useHistory } from \"react-router-dom\";\nimport { ProgressData } from \"./MapCreator.types\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\nimport { api_url } from \"../../conf\";\n\nfunction MapCreator() {\n  const history = useHistory();\n  const [form_state, set_form_state] = useState({});\n  const { add_alert } = useAlerts();\n  const [map_dir_options, set_map_dir_options] = useState<string[]>([]);\n  const [show_progress, set_show_progress] = useState(false);\n  const [show_reroute, set_show_reroute] = useState(false);\n  const [err, set_err] = useState<String | null>(null);\n  const is_mounted = useRef(false);\n  const progress_data = useRef<ProgressData>({\n    progress: null,\n    map_id: null,\n  });\n\n  const on_error = (err) => {\n    console.log(\"err\", err);\n    add_alert({\n      message: \"Some Unexpected error occurred!\",\n      status: \"danger\",\n    });\n  };\n\n  const [fetch_dirs, dirs_loading] = useFetch({\n    url: `${api_url}/map_creator/dirs`,\n    method: \"get\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      is_mounted.current && set_map_dir_options(data.dirs);\n    },\n  });\n\n  const on_fetch_success = ({ data }) => {\n    console.log(data.progress);\n    if (data.progress === \"complete\") {\n      is_mounted.current && set_show_progress(false);\n      is_mounted.current && set_show_reroute(true);\n    }\n    progress_data.current = data;\n  };\n\n  const [fetch_progress, progress_loading] = useFetch({\n    url: `${api_url}/map_creator/status`,\n    method: \"get\",\n    on_error: on_error,\n    on_success: on_fetch_success,\n  });\n\n  const [post_map_creator_data, post_loading] = useFetch({\n    url: `${api_url}/map_creator`,\n    method: \"post\",\n    on_error: on_error,\n\n    on_success: ({ data }) => {\n      is_mounted.current && set_show_progress(true);\n    },\n  });\n\n  useEffect(() => {\n    is_mounted.current = true;\n    const func = async () => {\n      await fetch_progress({request_headers: headers});\n      if (progress_data.current.progress !== null) {\n        is_mounted.current && set_show_progress(true);\n      } else {\n        await fetch_dirs();\n      }\n    };\n    func();\n    return () => {\n      is_mounted.current = false;\n    }\n  }, []);\n\n  useEffect(() => {\n    if (show_progress) {\n      progress_polling();\n    }\n  }, [show_progress]);\n\n  const progress_polling = async () => {\n    while (progress_data.current.progress !== \"complete\") {\n      console.log(progress_data.current.progress);\n      await new Promise((r) => setTimeout(r, 3000));\n      fetch_progress();\n    }\n  };\n\n  const load_map_editor = () => {\n    progress_data.current.map_id &&\n      history.push(`/map_editor_/${progress_data.current.map_id}`);\n  };\n\n  const handle_onchange = (e) => {\n    const target = e.target;\n    console.log(\"target\", target);\n    is_mounted.current && set_form_state((state) => ({\n      ...state,\n      [target.dataset.key]: target.value,\n    }));\n    if(e.target.id === \"map-name\"){\n      is_mounted.current && set_err(null);\n    }\n  };\n\n  const handle_onsubmit = (e) => {\n    e.preventDefault();\n    is_mounted.current && set_show_reroute(false);\n    post_map_creator_data({...form_state, request_headers: headers});\n  };\n\n  const create_map_dir_select_options = (dirs) => {\n    console.log(\"dirs\", dirs);\n    return dirs.map((dir) => ({ name: dir, value: dir }));\n  };\n\n  const handle_map_name_error = (err) => {\n    if (err.key === \"range_exceeded\") {\n      is_mounted.current && set_err(\"The map name should atleast have two characters.\")\n    } else if (err.key === \"regex_unmatch\") {\n      is_mounted.current && set_err(\"The map name should not have any spaces and should not start with a number.\")\n    }\n  }\n\n  console.log(create_map_dir_select_options(map_dir_options));\n  return (\n    <div className=\"map-creator-wrapper\">\n      <form onSubmit={handle_onsubmit}>\n        <fieldset\n          disabled={dirs_loading || post_loading || show_progress}\n          className=\"map-creator-container\"\n        >\n          <DropdownInput\n            id={\"map-directory\"}\n            onChange={handle_onchange}\n            data-key={\"run_directory\"}\n            label=\"select the run directory\"\n            options={create_map_dir_select_options(map_dir_options)}\n          />\n          <TextInput\n            id={\"map-name\"}\n            data-key={\"map_name\"}\n            onChange={handle_onchange}\n            label=\"Map name\"\n            regex={/^[a-zA-Z]\\w*/}\n            minLength={2}\n            onError={handle_map_name_error}\n            required\n          />\n          <AtiButton type=\"submit\" disabled={err !== null}>Generate</AtiButton>\n          {show_progress && (\n            <section className=\"progress-div\">\n              <AtiProgress progress={progress_data.current.progress} />\n              <span>loading...</span>\n            </section>\n          )}\n          {show_reroute && (\n            <AtiButton onClick={load_map_editor}> Load Map Editor</AtiButton>\n          )}\n          {(dirs_loading || post_loading) && pulse_spinner}\n          <span className=\"error-span\">{err}</span>\n        </fieldset>\n      </form>\n    </div>\n  );\n}\n\nexport default MapCreator;\n","import React from \"react\";\n\nconst Directory = ({\n  color = \"currentColor\",\n  className,\n  dimension,\n  directoryName,\n  ...rest\n}) => (\n  <div className={className}>\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={dimension}\n      height={dimension}\n      fill={color}\n      className={`bi bi-folder2`}\n      viewBox=\"0 0 16 16\"\n      {...rest}\n    >\n      <path d=\"M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v7a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 1 12.5v-9zM2.5 3a.5.5 0 0 0-.5.5V6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5zM14 7H2v5.5a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V7z\" />\n    </svg>\n    <span className=\"directory-svg-text\">{directoryName}</span>\n  </div>\n);\n\nexport { Directory };\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { useAlerts, useFetch, pulse_spinner } from \"ati-ui\";\nimport MapEditor from \"./MapEditor\";\nimport \"./map-editor.css\";\nimport { api_url } from \"../../conf\";\nimport { Directory } from \"./icons/Directory\";\nimport { useHistory } from \"react-router-dom\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\n\nfunction MapList() {\n  const { add_alert } = useAlerts();\n  const history = useHistory();\n  const [directories, set_directories] = useState<String[] | null>(null);\n  const is_mounted = useRef(false);\n\n  const on_success = (data) => {\n    add_alert({\n      message: \"Directories are loaded!\",\n      status: \"info\",\n    });\n    console.log(data, \"dir data\");\n    is_mounted.current && set_directories(data.dirs);\n  };\n\n  const on_error = (err) => {\n    add_alert({\n      message: \"Some Unexpected error occurred!\",\n      status: \"danger\",\n    });\n  };\n\n  const [fetch_dirs, dirs_loading] = useFetch({\n    url: `${api_url}/map_editor/dirs`,\n    method: \"get\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      on_success(data);\n    },\n  });\n\n  useEffect(() => {\n    is_mounted.current = true;\n    async function fetch_directories() {\n      await fetch_dirs({request_headers: headers()});\n    }\n    fetch_directories();\n    return () => {\n      is_mounted.current =  false;\n    }\n  }, []);\n\n  const show_maps = () => {\n    const dirs_list =\n      directories &&\n      directories.map((dir, index) => (\n        <Directory\n          className=\"directory-svg\"\n          key={index}\n          dimension=\"100\"\n          color=\"grey\"\n          data-id={dir[\"id\"]}\n          directoryName={dir[\"name\"]}\n          onClick={(e) => {\n            history.push(`/map_editor_/${dir[\"id\"]}`);\n          }}\n        />\n      ));\n    return dirs_list;\n  };\n\n  return (\n    <div className=\"map-editor-api-main-container\">\n      {dirs_loading ? pulse_spinner : <div className=\"show-maps-container\">{show_maps()}</div>}\n    </div>\n  );\n}\n\nexport default MapList;\n","import React from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\n// Navigation bar\nimport Navbar from \"../common/Navbar\";\n\n// Components\nimport MapEditorAPI from \"./map-editor/MapEditorAPI\";\nimport Webctl from \"./webctl/Webctl\";\nimport RemoteDrive from \"./remote-drive/RemoteDrive\";\nimport MapCreator from \"./map-creator/MapCreator\";\nimport MapList from \"./map-editor/MapList\";\n\nfunction DeploymentUINavigation({ match }) {\n  const url = match.url;\n  return (\n    <div>\n      <Navbar />\n      <Switch>\n        <Route exact path={url + \"/map_creator\"}>\n          <MapCreator />\n        </Route>\n        <Route exact path={`(${url}/map_editor_)`}>\n          <MapList />\n        </Route>\n        <Route exact path={url + \"/map_editor_/:id\"}>\n          <MapEditorAPI />\n        </Route>\n        <Route exact path={url + \"/webctl\"}>\n          <Webctl />\n        </Route>\n        <Route exact path={url + \"/remote_drive\"}>\n          <RemoteDrive />\n        </Route>\n      </Switch>\n    </div>\n  );\n}\n\nexport default DeploymentUINavigation;\n","import React, { useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { AtiForm, useFetch, useAlerts, pulse_spinner, AtiButton } from \"ati-ui\";\nimport { api_url } from \"../../conf\";\nimport { AXIOS_HEADER as headers } from \"../dashboard/utilities/Constants\";\nimport \"./Login.scss\";\n\nconst Login = () => {\n  const { add_alert } = useAlerts();\n  const history = useHistory();\n\n  useEffect(() => {\n    let token = localStorage.getItem(\"token\");\n    if (token) history.push(\"/map_creator\");\n  }, []);\n\n  const on_error = (err) => {\n    console.log(err, \"error on user login\");\n    add_alert({\n      message: \"Error on submit! Please retry!\",\n      status: \"danger\",\n    });\n  };\n\n  const [post_user, user_loading] = useFetch({\n    url: `${api_url}/login`,\n    method: \"post\",\n    on_error: on_error,\n    on_success: ({ data }) => {\n      localStorage.setItem(\"token\", data[\"token\"]);\n      history.push(\"/map_creator\");\n      add_alert({\n        message: \"Login success!\",\n        status: \"info\",\n      });\n    },\n  });\n\n  const on_submit = (request_object) => {\n    post_user({ request_body: request_object, request_headers: headers() });\n  };\n\n  return (\n    <div className=\"login-form-container\">\n      {user_loading ? (\n        pulse_spinner\n      ) : (\n        <>\n          <AtiForm\n            inputs={[\n              { id: \"username\", type: \"text\" },\n              { id: \"password\", type: \"password\" },\n            ]}\n            on_submit={on_submit}\n          />\n          <AtiButton\n            className=\"direct-map-editor-button\"\n            onClick={() => {\n              history.push(\"/map_editor\");\n            }}\n          >\n            Go to Map Editor\n          </AtiButton>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Login;\n","import React from 'react';\nimport { Route, Redirect } from 'react-router-dom';\n\nconst AuthenticateRoute = ({Component, ...rest}) => {\n  let token = localStorage.getItem(\"token\");\n  return (\n    <Route {...rest} render={routeProps =>\n      token ? (\n        <Component {...routeProps} />\n        ) : (\n        <Redirect to='/'/>\n      )\n    }\n    />\n  );\n};\n\nexport default AuthenticateRoute;\n","import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport MapEditor from \"./MapEditor\";\nimport { AtiButton } from \"ati-ui\";\nimport \"./map-editor.css\";\nimport { check_webui_json_file, check_waypoints_map_editor } from \"./utils\";\n\n\nfunction MapEditorFileUpload() {\n  const [image, set_image] = useState(null);\n  const [data, set_data] = useState(null);\n  const [waypoints_data, set_waypoints_data] = useState(null);\n  const [valid, set_valid] = useState(false);\n  const [load_map_editor, set_load_map_editor] = useState(false);\n  const [individual_file_upload, set_individual_file_upload] = useState(false);\n  const history = useHistory();\n\n  useEffect(() => {\n    check_map_valid();\n  }, [image, data]);\n\n  const handleFileJSONChange = (file) => {\n    let reader = new FileReader();\n    try {\n      reader.readAsText(file);\n      reader.onload = function (e) {\n        const reader_result = JSON.parse(reader.result);\n        console.log(reader_result, 'reader_result');\n        if (check_webui_json_file(reader_result)) {\n          set_data(reader_result);\n        } else {\n          alert(\"Please upload valid webui_map.json\");\n          e.target.value = \"\";\n          set_data(null);\n        }\n      };\n    } catch (err) {\n      console.log(\"err\", err);\n    }\n    reader.onerror = function () {\n      console.log(reader.error);\n    };\n  };\n\n  const handleFileWaypointsJSONChange = (file, directory = false) => {\n    let reader = new FileReader();\n    reader.readAsText(file);\n    try {\n      reader.onload = function (e) {\n        const reader_result = JSON.parse(reader.result);\n        if (reader_result.map_editor) {\n          let check_reader_result = check_waypoints_map_editor(reader_result.map_editor);\n          set_waypoints_data(check_reader_result);\n        } else {\n          alert(\n            \"please upload a waypoints JSON generated from the webUI map editor\"\n          );\n          e.target.value = \"\";\n          set_waypoints_data(null);\n        }\n      };\n    } catch (err) {\n      console.log(\"err\", err);\n    }\n\n    reader.onerror = function () {\n      console.log(reader.error);\n    };\n  };\n\n  const handleFileImageChange = (file) => {\n    let reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = function () {\n      if (file.type.match(\"image.*\")) {\n        set_image(reader.result);\n      } else {\n        alert(\"please upload a valid image\");\n        set_image(null);\n      }\n    };\n\n    reader.onerror = function () {\n      console.log(reader.error);\n    };\n  };\n\n  const check_map_valid = () => {\n    if (image && data) {\n      individual_file_upload ? set_valid(true) : set_load_map_editor(true);\n    } else {\n      set_valid(false);\n    }\n  };\n\n  const upload_multiple_files = (e) => {\n    const files = e.target.files;\n    Object.entries(files).forEach(([key, file]) => {\n      let file_extension = file.name.split('.').pop();\n      if (file_extension === \"png\" && file.name === \"webui_map.png\") {\n        handleFileImageChange(file)\n      } else if (file_extension === 'json' && file.name === \"webui_map.json\") {\n        handleFileJSONChange(file);\n      } else if (file_extension === 'json' && file.name === \"waypoints.json\") handleFileWaypointsJSONChange(file);\n    })\n  }\n\n  const to_render = () => {\n    if (load_map_editor) {\n      const scale = data.maps[0].scale;\n      const size = data.maps[0].size;\n      const origin = data.maps[0].origin;\n      const map_name = data.map_name;\n      const trip_type = data.trip_type || \"p2p\";\n\n      return (\n        <MapEditor\n          scale={scale}\n          size={size}\n          origin={origin}\n          map_name={map_name}\n          image={image}\n          trip_type={trip_type}\n          waypoints_data={waypoints_data}\n        />\n      );\n    } else {\n      return (\n        <div className=\"file-upload-main-container\">\n          {individual_file_upload ?\n            <div className=\"directory-upload-container\">\n              <section>\n                <label>webui_map image:</label>{\" \"}\n                <input onChange={(e) => handleFileImageChange(e.target.files[0])} type=\"file\" accept=\".png\" />\n              </section>\n              <section>\n                <label>webui_map json:</label>{\" \"}\n                <input onChange={(e) => handleFileJSONChange(e.target.files[0])} type=\"file\" accept=\".json\" />\n              </section>\n              <section>\n                <label>waypoints json(optional):</label>{\" \"}\n                <small>\n                  * load routes and stations from waypoints generated ONLY by the\n                  current map editor:{\" \"}\n                </small>\n                <input onChange={(e) => handleFileWaypointsJSONChange(e.target.files[0])} type=\"file\" accept=\".json\" />\n              </section>\n              <section>\n                <button\n                  onClick={() => {\n                    valid && set_load_map_editor(true);\n                  }}\n                  disabled={!valid}\n                  className=\"load-map-editor-button\"\n                  style={!valid ? { cursor: \"not-allowed\", backgroundColor: \"lightgrey\", color: \"#f2f2f2\"}: {}}\n                >\n                  Load Map Editor\n                </button>\n              </section>\n            </div> : <>\n              <section className=\"directory-upload-container\">\n                <label>Select the directory:</label>\n                <input\n                  type=\"file\"\n                  onChange={upload_multiple_files}\n                  webkitdirectory=\"\"\n                  mozdirectory=\"\"\n                  directory=\"\"\n                />\n              </section>\n              <AtiButton className=\"direct-map-editor-button\" onClick={() => { history.push(\"/\") }}>\n                Back to login\n              </AtiButton>\n            </>}\n          <button className=\"file-upload-text-button\" onClick={() => { set_individual_file_upload(!individual_file_upload); set_valid(false) }}>{individual_file_upload ? \"Return to upload files from directory\" : \"Do you want to upload files individually? click here\"}</button>\n        </div>\n      );\n    }\n  };\n\n  return <>{to_render()}</>;\n}\n\nexport default MapEditorFileUpload;\n","import React from \"react\";\nimport \"./App.css\";\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\nimport DeploymentUINavigation from \"./components/DeploymentUINavigation\";\nimport Login from \"./components/login/DeploymentUILogin\";\nimport AuthenticateRoute from \"./components/login/AuthenticateRoute\";\nimport MapEditorFileUpload from \"./components/map-editor/MapEditorFileUpload\";\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\nimport { setTokenSourceMapRange } from \"typescript\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router>\n        <Switch>\n          <Route exact path=\"/\">\n            <Login />\n          </Route>\n          <Route exact path=\"/map_editor\">\n            <MapEditorFileUpload />\n          </Route>\n          <AuthenticateRoute\n            path={\n              \"(/?[map_editor_|map_editor_/:id|remote_drive|webctl|map_creator]?)\"\n            }\n            Component={DeploymentUINavigation}\n          />\n        </Switch>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { createSlice } from '@reduxjs/toolkit';\n\nexport const slice = createSlice({\n  name:'stationInfoReducer',\n  initialState:{\n    value:{}\n  },\n  reducers:{\n    set_station_info:(state,action)=>{\n      state.value = { ...action.payload }\n    }    \n  }\n})\nexport const {set_station_info} = slice.actions;\nexport const getStationData= state => state.stationInfoReducer.value;\nexport default slice.reducer;","import { createSlice } from \"@reduxjs/toolkit\";\nconst default_users_state = {\n  users: {},\n};\n\nconst slice = createSlice({\n  name: \"usersReducer\",\n  initialState: default_users_state,\n  reducers: {\n    set_users_state: (state, action) => {\n      state.users = action.payload.users_object;\n    },\n    delete_user: (state, action) => {\n      delete state.users[action.payload.deleted_user_id];\n    },\n    add_user: (state, action) => {\n      console.log(\"user_reducer add_user\", state, action);\n      const addedUser = action.payload.user_object;\n      state.users[addedUser.id] = addedUser;\n    },\n    update_user: (state, action) => {\n      let updatedUser = state.users[action.payload.userId];\n      if (action.payload.user_info) {\n        const updatedUserInfo = action.payload.user_info;\n        state.users[updatedUserInfo.id] = {\n          ...updatedUser,\n          ...updatedUserInfo,\n        };\n      } else if (action.payload.user_roles) {\n        updatedUser.roles = action.payload.user_roles;\n        state.users[updatedUser.id] = updatedUser;\n      }\n    },\n  },\n});\n\nexport const {\n  set_users_state,\n  delete_user,\n  add_user,\n  update_user,\n} = slice.actions;\nexport const getUserData = (state) => state.usersReducer.users;\nexport default slice.reducer;\n","import { createSlice } from '@reduxjs/toolkit';\nconst slice = createSlice({\n  name:'confReducer',\n  initialState:{\n    value:{}\n  },\n  reducers:{\n    set_conf_state:(state,action)=> {\n      state.value = action.payload\n    }\n  }\n})\nexport const {set_conf_state} = slice.actions;\nexport const getConfData = state => state.confReducer.value;\nexport default slice.reducer;","import { createSlice } from \"@reduxjs/toolkit\";\nconst default_roles_state = {\n  roles: {},\n};\n\nconst slice = createSlice({\n  name: \"rolesReducer\",\n  initialState: default_roles_state,\n  reducers: {\n    set_roles_state: (state, action) => {\n      state.roles = action.payload.roles_object;\n    },\n    delete_role: (state, action) => {\n      delete state.roles[action.payload.deleted_role_id];\n    },\n    add_role: (state, action) => {\n      const addedRole = action.payload.role_object;\n      state.roles[addedRole.id] = addedRole;\n    },\n    update_role: (state, action) => {\n      // console.log(\"action\", action);\n      let updatedRole = state.roles[action.payload.roleId];\n      // console.log(\"updatedRole\", updatedRole);\n      if (action.payload.role_info) {\n        const updatedRoleInfo = action.payload.role_info;\n        state.roles[updatedRoleInfo.id] = {\n          ...updatedRole,\n          ...updatedRoleInfo,\n        };\n      } else if (action.payload.role_functions) {\n        updatedRole.functions = action.payload.role_functions;\n        state.roles[updatedRole.id] = updatedRole;\n      }\n    },\n  },\n});\n\nexport const {\n  set_roles_state,\n  delete_role,\n  add_role,\n  update_role,\n} = slice.actions;\nexport const getRoleData = (state) => state.rolesReducer.roles;\nexport default slice.reducer;\n","import { createSlice } from \"@reduxjs/toolkit\";\nconst default_functions_state = {\n  functions: {},\n};\n\nconst slice = createSlice({\n  name: \"functionsReducer\",\n  initialState: default_functions_state,\n  reducers: {\n    set_functions_state: (state, action) => {\n      state.functions = { ...action.payload };\n    },\n  },\n});\n\nexport const { set_functions_state } = slice.actions;\nexport const getFunctionData = (state) => state.functionsReducer.functions;\nexport default slice.reducer;\n","import { createSlice } from \"@reduxjs/toolkit\";\nconst default_current_user_state = {\n  users: {},\n};\n\nconst slice = createSlice({\n  name: \"currentUserReducer\",\n  initialState: default_current_user_state,\n  reducers: {\n    set_current_users_state: (state, action) => {\n      state.users = action.payload.users_object;\n    },\n  },\n});\n\nexport const { set_current_users_state } = slice.actions;\nexport const getCurrentUserData = (state) => state.currentUserReducer.user;\nexport default slice.reducer;\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nconst slice = createSlice({\n    name:'userFunctionReducer',\n    initialState:{\n        value:[]\n    },\n    reducers:{\n        user_function_list:(state,action)=>{\n            state.value = action.payload;\n        }\n    }\n})\nexport const {user_function_list} = slice.actions;\nexport const getUserFunctionList = state => state.userFunctionReducer.value;\nexport default slice.reducer;","import { combineReducers } from \"redux\";\nimport stationInfoReducer from \"./stationInfoReducer\";\nimport usersReducer from \"./userReducer\";\nimport confReducer from \"./confReducer\";\nimport rolesReducer from \"./roleReducer\";\nimport functionsReducer from \"./functionReducer\";\nimport currentUserReducer from \"./currentUserReducer\";\nimport userFunctionReducer from \"./userFunctionReducer\";\nimport navReducer from \"./navReducer\";\n\nconst rootReducer = combineReducers({\n  stationInfoReducer,\n  confReducer,\n  usersReducer,\n  rolesReducer,\n  functionsReducer,\n  currentUserReducer,\n  userFunctionReducer,\n  navReducer,\n});\n\nexport type RootState = ReturnType<typeof rootReducer>\n\nexport default rootReducer;\n","import { rest } from \"msw\";\nimport { api_url } from \"../../../conf\";\nconst DELAY_TIME = 2000;\nlet i = 0;\n\nexport const handlers = [\n  rest.get(`${api_url}/map_creator/dirs`, (req, res, ctx) => {\n    return res(\n      ctx.delay(DELAY_TIME),\n      ctx.json({ dirs: [\"foo/baar/foo\", \"bar/foo/foo\", \"bar/bar/foo\"] })\n    );\n  }),\n\n  rest.post(`${api_url}/map_creator`, (req, res, ctx) => {\n    const body = Object(req.body);\n    return res(ctx.delay(DELAY_TIME), ctx.json({ ...body }));\n  }),\n\n  rest.get(`${api_url}/map_creator/status`, (req, res, ctx) => {\n    const body = Object(req.body);\n    if (i === 10) {\n      i = 0;\n      return res(\n        ctx.delay(DELAY_TIME),\n        ctx.json({ progress: \"complete\", map_id: 134 })\n      );\n    } else if (i === 0) {\n      i = 1;\n      return res(ctx.delay(DELAY_TIME), ctx.json({ progress: null }));\n    }\n    i = i + 1;\n    return res(ctx.delay(DELAY_TIME), ctx.json({ progress: (i / 10) * 100 }));\n  }),\n];\n","import { rest } from \"msw\";\nimport { api_url } from \"../../../../conf\";\nconst DELAY_TIME = 2000;\n\n\nexport const handlers = [\n  rest.post(api_url, (req, res, ctx) => {\n    const body  = JSON.stringify(req.body);\n    const { action } = JSON.parse(body);\n    switch(action) {\n      case \"remote\": {\n        return res(ctx.delay(DELAY_TIME), ctx.json({ state: \"remote drive\" }));\n      }\n      case \"dualshock\" : {\n        return res(ctx.delay(DELAY_TIME), ctx.json({ state: \"manual drive\" }));\n      }\n      case \"auto\" : {\n        return res(ctx.delay(DELAY_TIME), ctx.json({ state: \"auto drive\", station : 'station 111'  }));\n      }\n      case \"shutdown\" : {\n        return res(ctx.delay(DELAY_TIME), ctx.json({ state: \"shutdown\" }));\n      }\n      default : {\n        return \n      }\n    }\n  }),\n\n  rest.get(`${api_url}/stations`, (req, res, ctx) => {\n    return res(ctx.delay(DELAY_TIME), ctx.json({ stations: [\"station1\", \"station2\"] }));\n  }),\n\n  rest.get(`${api_url}/mode`, (req, res, ctx) => {\n    return res(ctx.delay(DELAY_TIME), ctx.json({ mode: \"remote\" }));\n  }),\n\n];\n","export const map_data = {\n  path: [\n    [500, 20],\n    [500, 800],\n    [800, 800],\n  ],\n  mule_data: [\n    {\n      id: 1,\n      uid: \"dhasdhkhsak\",\n      name: \"mini1\",\n      x: 2675/4,\n      y: 2087/4,\n      theta: 90,\n      battery_percentage: 30,\n    },\n    {\n      id: 2,\n      uid: \"dhasdhdsdkhsak\",\n      name: \"mini2\",\n      x: 2675/2,\n      y: 2087/2,\n      theta: 180,\n      battery_percentage: 30,\n    },\n  ],\n  error_zones: [\n    [250 + 500, 550 + 300],\n    [600 + 500, 800 + 300],\n    [1000 + 500, 100 + 300],\n  ],\n  obstacle_zones: [\n    [250 + 500, 550 + 500],\n    [600 + 500, 800 + 500],\n    [1000 + 500, 100 + 500],\n  ],\n  map_name: \"vh\",\n  trip_type: \"round_trip\",\n  maps: {\n    \"0\": {\n      file_name: \"webui_map-gf.png\",\n      origin: {\n        x: 1421,\n        y: 1707,\n      },\n      scale: {\n        x: 56.863616170590845,\n        y: -56.863616170590845,\n      },\n      size: {\n        x: 2675,\n        y: 2087,\n      },\n      viewbox: \"0 0 2844 2309\",\n    },\n    \"1\": {\n      file_name: \"webui_map-1f.png\",\n      origin: {\n        x: 1393,\n        y: 863,\n      },\n      scale: {\n        x: 46.159394157951674,\n        y: -46.159394157951674,\n      },\n      size: {\n        x: 2848,\n        y: 2560,\n      },\n      viewbox: \"0 0 2848 2560\",\n    },\n  },\n  stations: [\n    {\n      id: 1,\n      name: \"Nursing Station\",\n      isStarting: true,\n      isCharging: true,\n      x: 330,\n      y: 330,\n    },\n    {\n      id: 2,\n      name: \"Bed 1\",\n      group: \"ward A\",\n      isCharging: false,\n      x: 1050,\n      y: 1050,\n    },\n    {\n      id: 3,\n      name: \"Bed 2\",\n      group: \"ward A\",\n      x: 2550,\n      y: 660,\n    },\n  ],\n};\n","import { rest } from \"msw\";\nimport webui_map from \"../../../resources/webui_map.png\";\nimport { map_data } from \"../../../resources/webui_map_vh\";\nimport { api_url } from \"../../../conf\";\nconst DELAY_TIME = 2000;\nlet i = 0;\n\nexport const handlers = [\n  rest.get(`${api_url}/map_editor/dirs`, (req, res, ctx) => {\n    return res(\n      ctx.delay(DELAY_TIME),\n      ctx.json({\n        dirs: [\n          { id: 1, name: \"IISC\" },\n          { id: 2, name: \"srf\" },\n          { id: 546, name: \"hyundai\" },\n          { id: 11, name: \"qatar\" },\n          { id: 23, name: \"tvs\" },\n          { id: 5, name: \"sf\" },\n          { id: 8, name: \"office\" },\n          { id: 9, name: \"basement\" },\n          { id: 99, name: \"seg\" },\n          { id: 1, name: \"IISC\" },\n          { id: 2, name: \"srf\" },\n          { id: 546, name: \"hyundai\" },\n          { id: 11, name: \"qatar\" },\n          { id: 23, name: \"tvs\" },\n          { id: 5, name: \"sf\" },\n          { id: 8, name: \"office\" },\n          { id: 9, name: \"basement\" },\n          { id: 99, name: \"seg\" },\n          { id: 1, name: \"IISC\" },\n          { id: 2, name: \"srf\" },\n          { id: 546, name: \"hyundai\" },\n          { id: 11, name: \"qatar\" },\n          { id: 23, name: \"tvs\" },\n          { id: 5, name: \"sf\" },\n          { id: 8, name: \"office\" },\n          { id: 9, name: \"basement\" },\n          { id: 11, name: \"qatar\" },\n          { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },\n          // { id: 1, name: \"IISC\" },\n          // { id: 2, name: \"srf\" },\n          // { id: 546, name: \"hyundai\" },\n          // { id: 11, name: \"qatar\" },\n          // { id: 23, name: \"tvs\" },\n          // { id: 5, name: \"sf\" },\n          // { id: 8, name: \"office\" },\n          // { id: 9, name: \"basement\" },\n          // { id: 99, name: \"seg\" },  \n        ],\n      })\n    );\n  }),\n\n  rest.post(`${api_url}/map_editor/upload`, (req, res, ctx) => {\n    const body = Object(req.body);\n    return res(\n      ctx.delay(DELAY_TIME),\n      ctx.json({\n        message: \"upload success\",\n      })\n    );\n  }),\n\n  rest.post(`${api_url}/map_editor/:id`, (req, res, ctx) => {\n    const body = Object(req.body);\n    let webui_map_image = webui_map;\n    let webui_map_json = map_data;\n    let waypoints = null;\n    return res(\n      ctx.delay(DELAY_TIME),\n      ctx.json({\n        webui_map_image: webui_map_image,\n        webui_map_json: webui_map_json,\n        waypoints: \"\",\n      })\n    );\n  }),\n\n];\n","import { rest } from \"msw\";\nimport { api_url } from \"../../../conf\";\nconst DELAY_TIME = 2000;\n\nexport const handlers = [\n  rest.post(`${api_url}/login`, (req, res, ctx) => {\n    const body = Object(req.body);\n    return res(ctx.delay(DELAY_TIME), ctx.json({ token: \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\" }));\n  }),\n  rest.post(`${api_url}/logout`, (req, res, ctx) => {\n    return res(ctx.delay(DELAY_TIME), ctx.json({ user:  \"delete\"}));\n  }),\n];\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport { createStore } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport rootReducer from \"./reducers/rootReducer\";\nimport { AlertsProvider } from \"ati-ui\";\nimport { handlers } from \"./components/webctl/tests/mocks/handlers\";\nimport { handlers as map_creator_handlers } from \"./components/map-creator/mocks/handlers\";\nimport { handlers as map_editor_handlers } from \"./components/map-editor/mocks/handlers\"\nimport { handlers as login_handlers } from \"./components/login/mocks/handlers\";\n\nimport { setupWorker } from \"msw\";\n\nif (process.env.NODE_ENV === \"development\") {\n  const worker = setupWorker(...handlers, ...map_creator_handlers, ...map_editor_handlers, ...login_handlers);\n  worker.start();\n}\n\nconst store = createStore(rootReducer);\n\nReactDOM.render(\n  <AlertsProvider>\n    <App />\n  </AlertsProvider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}