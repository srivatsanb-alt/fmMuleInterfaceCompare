/*! For license information please see main.f45306a9.chunk.js.LICENSE.txt */
(this["webpackJsonpati-motors-react-frontend"]=this["webpackJsonpati-motors-react-frontend"]||[]).push([[0],{139:function(e,t,n){},140:function(e,t,n){e.exports=n.p+"static/media/ati-logo.df8b7ac6.png"},141:function(e,t,n){e.exports=n.p+"static/media/person.9ede6360.svg"},142:function(e,t,n){e.exports=n.p+"static/media/gear.0444aa22.svg"},148:function(e,t,n){e.exports=n.p+"static/media/arrow-clockwise.01f21af9.svg"},149:function(e,t,n){e.exports=n.p+"static/media/arrow-counter-clockwise.75ffb11b.svg"},150:function(e,t,n){e.exports=n.p+"static/media/icon-move.9064ef70.svg"},151:function(e,t,n){e.exports=n.p+"static/media/station.dcd3b9f0.svg"},152:function(e,t,n){e.exports=n.p+"static/media/arrow-down.3d5e35e3.svg"},153:function(e,t,n){e.exports=n.p+"static/media/arrow.6990715c.svg"},154:function(e,t,n){e.exports=n.p+"static/media/webui_map.bdd14664.png"},158:function(e,t,n){e.exports=n(335)},163:function(e,t,n){},164:function(e,t,n){},165:function(e,t,n){},324:function(e,t,n){},328:function(e,t,n){},329:function(e,t,n){},330:function(e,t,n){},331:function(e,t,n){},335:function(e,t,n){"use strict";n.r(t);var r=n(18),a=n(0),o=n.n(a),c=n(73),i=n.n(c),u=(n(163),n(164),n(38)),s=n(24),l=n(2),d=n(140),m=n.n(d);n(165);n(141);n(142),n(155);var p=n(29),f=Object(p.a)({name:"navReducer",initialState:{current_nav:"dashboard",to_show_sidebar:!1},reducers:{set_nav_state:function(e,t){console.log("action.payload",t.payload),e.current_nav=t.payload},set_to_show_sidebar:function(e,t){console.log("set_to_show_sidebar",t.payload),e.to_show_sidebar=t.payload}}}),_=f.actions,h=(_.set_nav_state,_.set_to_show_sidebar,f.reducer);var b="http://".concat(window.location.hostname,":5000");"ws://".concat(window.location.hostname,":5000"),"http://".concat(window.location.hostname,":8075");"https:"===window.location.protocol?(b="/api","wss://".concat(window.location.hostname,":443/api/"),"wss://".concat(window.location.hostname,":443")):(b="http://".concat(window.location.hostname,"/api"),"ws://".concat(window.location.hostname,"/api/"),"ws://".concat(window.location.hostname));var g=function(){return{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json",Accept:"*/*"}},v=n(345),y=n(59),w=n(48),x=n.n(w),j=(n(175),n(20),n(67),n(176),n(103)),k=n.n(j),O=(n(37),n(108),n(104)),E=n.n(O),N=function(){return(N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function S(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function C(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{u(r.next(e))}catch(t){o(t)}}function i(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}u((r=r.apply(e,t||[])).next())}))}function R(e,t){var n,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(a=(a=c.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(i){o=[6,i],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}function M(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!==typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}function I(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=void 0===r?"":r,c=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,viewBox:"0 0 16 16"},c,{className:"bi bi-x "+(a&&a)}),o.a.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"}))}function D(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,viewBox:"0 0 16 16"},a,{className:"bi bi-exclamation-triangle "+(r&&r)}),o.a.createElement("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"}),o.a.createElement("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"}))}function z(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,viewBox:"0 0 16 16"},a,{className:"bi bi-check-square "+(r&&r)}),o.a.createElement("path",{d:"M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z"}),o.a.createElement("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"}))}function F(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,viewBox:"0 0 16 16"},a,{className:"bi bi-info-square "+(r&&r)}),o.a.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),o.a.createElement("path",{d:"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"}))}function A(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,viewBox:"0 0 16 16"},a,{className:"bi bi-check-square "+(r&&r)}),o.a.createElement("path",{d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),o.a.createElement("path",{d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"}))}M(".pointer-none {\n  pointer-events: none; }\n\n.alerts-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n  display: flex;\n  justify-content: center;\n  z-index: 99999; }\n  .alerts-overlay .alerts-wrapper::-webkit-scrollbar {\n    display: none; }\n  .alerts-overlay .alerts-wrapper {\n    padding: 1rem;\n    display: flex;\n    flex-direction: column;\n    pointer-events: none;\n    row-gap: 1rem;\n    overflow: scroll;\n    -ms-overflow-style: none;\n    scrollbar-width: none; }\n    .alerts-overlay .alerts-wrapper .alert {\n      pointer-events: auto;\n      padding-inline-start: 0.7rem;\n      padding-inline-end: 0.5rem;\n      padding-block: 0.3rem;\n      min-height: 3rem;\n      min-width: 15rem;\n      background: var(--background-color);\n      color: var(--text-color);\n      box-shadow: var(--medium-box-shadow);\n      border-radius: var(--button-border-radius);\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-start;\n      column-gap: 1rem;\n      align-items: center;\n      border-left: 0.2rem solid var(--muted-text-color); }\n      .alerts-overlay .alerts-wrapper .alert .status-icon {\n        pointer-events: none;\n        height: 60%; }\n      .alerts-overlay .alerts-wrapper .alert .message {\n        pointer-events: none;\n        white-space: pre-line;\n        line-height: 0.8rem; }\n      .alerts-overlay .alerts-wrapper .alert .cancel-button {\n        height: 16px;\n        margin-left: auto; }\n      .alerts-overlay .alerts-wrapper .alert .cancel-button:hover {\n        background-color: rgba(0, 0, 0, 0.1);\n        border-radius: var(--border-radius); }\n    .alerts-overlay .alerts-wrapper .warning {\n      border-left: 0.2rem solid orange;\n      background: #fce8c3;\n      color: #505d79; }\n    .alerts-overlay .alerts-wrapper .info {\n      border-left: 0.2rem solid blue;\n      background: #cce3fd;\n      color: #505d79; }\n    .alerts-overlay .alerts-wrapper .danger {\n      border-left: 0.2rem solid red;\n      background: #f7cfcb;\n      color: #505d79; }\n    .alerts-overlay .alerts-wrapper .success {\n      border-left: 0.2rem solid green;\n      background: #c5f7dd;\n      color: #505d79; }\n");var T=Object.freeze({__proto__:null,default:"assets/files/success-cb875012169b942931f25db283cb384b.wav"}),L=Object.freeze({__proto__:null,default:"assets/files/info-93f7468c9b28221ca04245e61f337c51.wav"}),P=Object.freeze({__proto__:null,default:"assets/files/warning-ad90b6f80ed25faa280afe1ed443151f.wav"}),q=Object.freeze({__proto__:null,default:"assets/files/error-03792dc44aca6c771a5489e1e4578077.wav"}),H=Object.freeze({__proto__:null,default:"assets/files/normal-3b45f51763c4d64be3c839218987da3d.wav"}),V=[],W=Object(a.createContext)(V),B=W.Provider,J=new y.Howl({src:[T]}),U=new y.Howl({src:[L]}),Y=new y.Howl({src:[P]}),G=new y.Howl({src:[q]}),X=new y.Howl({src:[H]}),K=function(e){var t=e.children;console.log("AlertsProvider");var n=Object(a.useReducer)((function(e,t){switch(t.type){case"add_alert":var n=e,r=t.payload,a=r.callback,o=r.id,c=S(r,["callback","id"]),i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,a++)r[a]=o[c];return r}([N({id:o},c)],n);switch(t.payload.status){case"success":J.play();break;case"info":U.play();break;case"warning":Y.play();break;case"danger":G.play();break;default:X.play()}return a&&a(o),i;case"remove_alert":n=e;return console.log("alerts",n,"id",t.payload.id),i=n.filter((function(e){return e.id!=t.payload.id}));default:throw new Error}}),V),r=n[0],c=n[1],i=function(e){c({type:"add_alert",payload:e})},u=function(e){c({type:"remove_alert",payload:{id:e}})},s=o.a.useMemo((function(){return{state:r,dispatch_add_alert:i,dispatch_remove_alert:u}}),[r]),l=o.a.useMemo((function(){return{dispatch_add_alert:i,dispatch_remove_alert:u}}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(B,{value:s},o.a.createElement(Z,null)),o.a.createElement(B,{value:l},t))},Q=function(){var e=Object(a.useContext)(W),t=e.dispatch_add_alert,n=e.dispatch_remove_alert;return{dispatch_add_alert:t,add_alert:function(e){var r=e.message,a=e.status,o=e.time,c=void 0===o?5:o,i=e.on_click,u=e.on_cancel;return C(void 0,void 0,void 0,(function(){var e,o;return R(this,(function(s){return e=Object(v.a)(),o={id:e,message:r,status:a},i?o.on_click=i:o.callback=function(e){return C(void 0,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3*c)}))];case 1:return t.sent(),n(e),[2]}}))}))},u&&(o.on_cancel=u),t(o),[2,e]}))}))},dispatch_remove_alert:n}},Z=function(){var e=Object(a.useContext)(W).state,t=Q().dispatch_remove_alert,n=e;return o.a.createElement("div",{className:"alerts-overlay"},o.a.createElement("div",{className:"alerts-wrapper","data-testid":"alerts-wrapper"},n.map((function(e,n){var r=e.message,a=e.id,c=e.status,i=e.on_cancel,u=e.on_click;return o.a.createElement("div",{className:c?"alert "+c:"alert","data-index":a,onClick:function(e){e.target===e.currentTarget&&u&&(u(),t(e.target.dataset.index))},key:n},function(e){switch(e){case"success":return o.a.createElement(A,{className:"status-icon"});case"warning":return o.a.createElement(D,{className:"status-icon"});case"info":return o.a.createElement(F,{className:"status-icon"});case"danger":return o.a.createElement(z,{className:"status-icon"});default:return o.a.createElement(o.a.Fragment,null)}}(c),o.a.createElement("span",{className:"message"},r),o.a.createElement("div",{onClick:function(e){i&&i(),t(e.target.dataset.index)},className:"cancel-button","data-index":a},o.a.createElement("div",{className:"pointer-none"},o.a.createElement(I,null))))}))))};M(".ati-button {\n  width: min-content;\n  background: transparent;\n  color: var(--text-color);\n  padding: 0.5rem 1rem;\n  border: 2px solid var(--text-color);\n  border-radius: var(--button-border-radius);\n  font-weight: bold;\n  min-width: 5rem;\n  cursor: pointer; }\n\n.ati-button:hover {\n  background: var(--button-background-color);\n  color: var(--button-text-color);\n  border: 2px solid var(--button-border-color); }\n\n.ati-button:disabled {\n  background: var(--muted-text-color);\n  color: var(--muted-text-color);\n  border: 2px solid currentColor; }\n\n.ati-button:active {\n  transform: scale(0.98); }\n\n.underlined-button {\n  width: min-content;\n  background-color: transparent;\n  border: none;\n  font-weight: bold;\n  text-decoration: underline;\n  text-decoration-thickness: 1px;\n  padding: 0.5rem 0rem;\n  cursor: pointer;\n  color: var(--text-color); }\n\n.underlined-button:hover {\n  text-decoration-thickness: 2px; }\n\n.underlined-button:active {\n  transform: scale(0.98); }\n\n.pill {\n  width: min-content;\n  background: #451a58;\n  color: var(--button-text-color);\n  font-size: x-small;\n  font-weight: bold;\n  border-radius: var(--button-border-radius);\n  padding: 0.2rem 0.5rem;\n  border: none; }\n\n.pill:active {\n  transform: scale(0.99); }\n\n.datepicker-pill,\n.booking-strips {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; }\n");M(".wrapper {\n  display: flex;\n  flex-direction: row;\n  justify-self: center;\n  align-self: center; }\n\n.loader {\n  background-color: var(--text-color);\n  border-radius: 50%;\n  width: 1.5rem;\n  height: 1.5rem;\n  opacity: 0;\n  animation: pulse 0.5s ease-in-out infinite;\n  display: flex;\n  align-self: center;\n  justify-self: center; }\n\n@keyframes pulse {\n  0% {\n    transform: scale(0);\n    opacity: 0; }\n  50% {\n    transform: scale(1);\n    opacity: 1; }\n  100% {\n    transform: scale(0.5);\n    opacity: 0; } }\n");var $=o.a.createElement("div",{className:"wrapper"},o.a.createElement("div",{className:"loader"}));function ee(e){var t=e.children,n=e.loading,r=e.className,a=S(e,["children","loading","className"]);return o.a.createElement(o.a.Fragment,null,n?$:o.a.createElement("button",N({},a,{className:"ati-button "+(r&&r)}),t))}M(".custom-card {\n  background: var(--background-color) !important;\n  box-shadow: var(--small-box-shadow);\n  border-radius: var(--card-border-radius);\n  color: var(--text-color);\n  padding: 2rem;\n  text-align: justify;\n  max-width: 200px; }\n  .custom-card .mule-name-status-div {\n    display: flex;\n    justify-content: space-between; }\n    .custom-card .mule-name-status-div .mule-icon-name-container {\n      display: flex;\n      align-items: center; }\n      .custom-card .mule-name-status-div .mule-icon-name-container .mule-name-container {\n        margin-left: 0.5rem;\n        font-size: 1.2rem; }\n  .custom-card .online-status-main {\n    display: flex;\n    justify-content: space-between; }\n    .custom-card .online-status-main .online-status-span {\n      color: var(--text-color);\n      padding: 0.3rem;\n      border-radius: 3px; }\n  .custom-card .card-btn {\n    margin-top: 1.75rem;\n    display: flex;\n    justify-content: space-between; }\n\n.mule-distance-card {\n  background: var(--background-color);\n  border-radius: var(--card-border-radius);\n  box-shadow: var(--small-box-shadow);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n  padding: 2rem;\n  width: 300px; }\n\n.mule-distance-card-header-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center; }\n\n.mule-distance-card span {\n  color: var(--text-color); }\n\n.mule-distance-card .mule-distance-card-header:first-child {\n  font-size: 2rem;\n  font-weight: bold; }\n\n.mule-distance-card .mule-distance-card-header:nth-child(2) {\n  font-size: 3rem;\n  font-weight: 400; }\n\n.mule-distance-card ul {\n  margin: 0;\n  list-style: none;\n  width: 100%;\n  padding-inline: 1rem;\n  padding-block: 1rem;\n  display: flex;\n  flex-direction: column;\n  row-gap: 1rem;\n  margin-top: 2rem;\n  max-height: 200px;\n  overflow-y: scroll;\n  overflow-x: hidden; }\n\nul::-webkit-scrollbar {\n  display: none; }\n\nul::-webkit-scrollbar-track {\n  box-shadow: inset 0 0 6px var(--dark-color);\n  border-radius: var(--card-border-radius);\n  cursor: pointer !important; }\n\nul::-webkit-scrollbar-thumb {\n  background-color: var(--dark-color);\n  outline: 1px solid var(--muted-dark-color);\n  border-radius: var(--card-border-radius);\n  cursor: pointer !important; }\n\nul {\n  -ms-overflow-style: none; }\n\n.mule-distance-card ul li {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border: 1px solid var(--dark-color);\n  border-radius: var(--card-border-radius);\n  color: var(--text-color);\n  padding-inline: 2rem;\n  padding-block: 0.7rem;\n  box-shadow: var(--small-box-shadow);\n  border: 1px solid var(--text-color); }\n\n.dashboard-no-data-container {\n  display: grid;\n  justify-content: center;\n  align-content: center; }\n\n.dashboard-loading {\n  background: var(--background-color);\n  border-radius: var(--card-border-radius);\n  box-shadow: var(--small-box-shadow);\n  display: flex;\n  flex-direction: column;\n  height: 250px;\n  width: 300px;\n  row-gap: 1rem;\n  padding: 2rem; }\n  .dashboard-loading .dashboard-loading-1 {\n    height: 40%;\n    width: 70%;\n    align-self: center;\n    padding-block-start: 0.5rem; }\n  .dashboard-loading .dashboard-loading-2 {\n    height: 30%; }\n");o.a.createElement(x.a,N({},{showLoadingAnimation:!0,rows:1,ready:!1})),o.a.createElement(x.a,N({},{showLoadingAnimation:!0,rows:2,ready:!1})),o.a.createElement(x.a,N({},{showLoadingAnimation:!0,rows:4,ready:!1}));function te(e){var t=this,n=e.on_submit,r=e.on_cancel,c=e.inputs,i=e.utilities,u=e.warning,s=(Object(a.useRef)(null),Object(a.useState)({})),l=s[0],d=s[1],m=Object(a.useState)(!1),p=m[0],f=m[1],_=Object(a.useRef)(!1);Object(a.useEffect)((function(){return _.current=!0,function(){_.current=!1}}),[]);var h=function(e){e.persist(),_.current&&d((function(t){var n;return N(N({},t),((n={})[e.target.id]=e.target.value,n))}))};return o.a.createElement("form",{"data-testid":"form",autoComplete:"off",className:"ati-form",onSubmit:function(e){return C(t,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return e.preventDefault(),_.current&&f(!0),[4,n(l)];case 1:return t.sent(),_.current&&f(!1),[2]}}))}))}},r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(I,{className:"cancel-button","data-testid":"cancel-button",onClick:function(){r&&r()}}),o.a.createElement("div",{className:"space-div"})),o.a.createElement("section",{"data-testid":"inputs",className:"inputs"},function(e){return e.map((function(e,t){return o.a.createElement("section",{key:"input-"+t},o.a.createElement("label",null,(n=e.id,k.a.capitalize(k.a.lowerCase(String(n))))),o.a.createElement("input",{id:e.id,onChange:h,type:e.type,required:!0}));var n}))}(c)),o.a.createElement("section",null,i),o.a.createElement(ee,{loading:p,className:"form-button","data-testid":"submit-button",type:"submit"},"Submit"),u&&o.a.createElement("section",{"data-testid":"warning",className:"warning"}," ",o.a.createElement("span",null,u)))}M(".ati-form {\n  margin-top: 8rem;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  min-width: 30rem;\n  max-width: 40rem;\n  padding: 2rem;\n  flex-direction: column;\n  row-gap: 1rem;\n  height: 15rem;\n  border: none;\n  background-color: #f2f2f2;\n  border-radius: var(--border-radius); }\n  .ati-form .space-div {\n    height: 0rem; }\n  .ati-form .cancel-button {\n    position: absolute;\n    top: 0.8rem;\n    right: 0.8rem;\n    color: var(--muted-text-color);\n    padding: 0.2rem;\n    border-radius: var(--border-radius); }\n  .ati-form .form-button {\n    align-self: center; }\n  .ati-form .cancel-button:hover {\n    background-color: var(--muted-dark-color); }\n  .ati-form .inputs {\n    display: flex;\n    flex-direction: column;\n    justify-self: center;\n    row-gap: 0.5rem;\n    width: 100%; }\n    .ati-form .inputs section {\n      display: flex;\n      flex-direction: column;\n      border: 2px solid var(--text-color);\n      overflow: hidden;\n      padding-inline: 0.5rem;\n      padding-block: 0.2rem;\n      row-gap: 0.2rem;\n      border-radius: var(--border-radius);\n      background-color: #ffffff; }\n      .ati-form .inputs section label {\n        font-size: 0.8rem;\n        color: var(--text-color);\n        text-align: start; }\n      .ati-form .inputs section input {\n        border: none;\n        padding-block: 0rem;\n        transition: padding-block 0.2s ease-in-out;\n        background: transparent;\n        color: var(--text-color); }\n      .ati-form .inputs section input:focus {\n        outline: none;\n        padding-block: 0.5rem;\n        transition: padding-block 0.2s ease-in-out; }\n");function ne(){var e=Object(a.useState)(!1),t=e[0],n=e[1],r=Object(a.useRef)(!1);Object(a.useEffect)((function(){return r.current=!0,function(){r.current=!1}}),[]);var c=function(){r.current&&n(!1)};return[function(e){var n=e.children;return t?o.a.createElement("div",{className:"overlay",onClick:function(e){e.target===e.currentTarget&&c()}},o.a.createElement("div",{className:"modal"},n)):o.a.createElement(o.a.Fragment,null)},function(){r.current&&n(!0)},c]}M(".overlay {\n  position: absolute;\n  top: 0;\n  right: 0;\n  background-color: transparent;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  animation: blur-animation 0.1s linear forwards; }\n  .overlay .modal {\n    animation: pop 0.2s ease-in-out forwards; }\n\n@keyframes blur-animation {\n  0% {\n    backdrop-filter: blur(3px); }\n  100% {\n    backdrop-filter: blur(6px); } }\n\n@keyframes pop {\n  0% {\n    transform: scale(0.8);\n    opacity: 0; }\n  90% {\n    transform: scale(1.05);\n    opacity: 1; }\n  100% {\n    transform: scale(1); } }\n");M('/* large screen navbar*/\n.nav-bar {\n  background: var(--dark-color);\n  border-right: 1px solid #e5e5e5;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  height: 100%;\n  width: 70px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding-block: 0.5rem;\n  z-index: 100;\n  border: none;\n  transition: width 0.2s ease-in-out; }\n\n.nav-bar:hover {\n  width: 200px; }\n\n.nav-bar section {\n  padding-left: 1.5rem; }\n\n.nav-bar button {\n  padding-inline: 1.5rem; }\n\n.nav-bar-links {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  flex-grow: 2;\n  width: 100%;\n  margin-block: 1rem;\n  padding: 0;\n  list-style-type: none; }\n\n.nav-bar-link {\n  color: var(--text-color);\n  text-decoration: none;\n  display: flex;\n  column-gap: 0.5rem;\n  align-items: center;\n  height: 2rem;\n  padding-left: 1.5rem;\n  padding-block: 1rem; }\n\n.btn-log-out {\n  background: transparent;\n  border: none;\n  padding: 0;\n  margin: 0;\n  width: 100%;\n  height: 3rem;\n  margin-block-end: 0.5rem; }\n\n.nav-bar-link:hover {\n  color: #fff !important;\n  background: #2a333b !important; }\n\n.highlight-border-red {\n  border-left: 3px solid var(--ati-logo-text-color); }\n\n/* small screen navbar*/\n.small-nav-bar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-block: 1rem;\n  background: var(--dark-color);\n  z-index: 999;\n  width: 100%;\n  transition: "top 0.6s"; }\n\nul {\n  margin: 0;\n  padding-inline-start: 0; }\n\n.small-nav-bar section {\n  margin-inline-start: 1rem; }\n\n.small-nav-bar > div {\n  margin-inline-end: 0.5rem;\n  width: 2rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center; }\n\n.small-nav-bar button {\n  cursor: pointer;\n  background: transparent;\n  border: none; }\n\n.menu-nav {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  margin-top: 3rem;\n  list-style: none;\n  background: var(--dark-color);\n  height: 100%;\n  overflow: hidden;\n  z-index: 10; }\n\n.menu-nav.show-menu {\n  display: block;\n  width: 100%;\n  animation: slide-down 0.1s forwards ease-in; }\n\n.hide-menu {\n  display: none; }\n\n.nav-bar-open-name {\n  margin-left: 2rem; }\n\n.webui-nav-bar {\n  padding-inline: 1rem;\n  display: flex;\n  column-gap: 1rem;\n  justify-content: space-between;\n  align-items: center;\n  min-height: 4rem;\n  z-index: 999;\n  background: var(--background-color);\n  box-shadow: var(--bottom-box-shadow); }\n  .webui-nav-bar .webui-nav-bar-links {\n    max-width: 40rem;\n    width: 100%;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    list-style: none; }\n    .webui-nav-bar .webui-nav-bar-links li {\n      text-align: center;\n      padding-inline: 7.5%;\n      cursor: pointer; }\n      .webui-nav-bar .webui-nav-bar-links li .webui-nav-bar-link {\n        text-decoration: none !important;\n        color: var(--text-color); }\n      .webui-nav-bar .webui-nav-bar-links li .webui-nav-bar-link:hover {\n        color: var(--toned-color) !important; }\n    .webui-nav-bar .webui-nav-bar-links li + li {\n      border-left: 2px solid var(--muted-text-color); }\n  .webui-nav-bar .utilities-bar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    column-gap: 0.5rem; }\n\n@media screen and (max-width: 850px) {\n  .webui-nav-bar-links {\n    flex-wrap: wrap;\n    row-gap: 0.25rem; }\n  .webui-nav-bar {\n    height: 5rem; } }\n\n.sidebar-active-link {\n  color: var(--text-color) !important;\n  font-weight: bold; }\n\n.no-sidebar-active-link {\n  color: #ffffff !important;\n  font-weight: bold;\n  border-left: 5px solid var(--ati-logo-text-color) !important; }\n\n@keyframes slide-down {\n  0% {\n    height: 0%; }\n  100% {\n    height: 100%; } }\n');M(".custom-sanjay-strip {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  margin-top: 0.7rem;\n  padding-inline: 1rem;\n  padding-block: 0.525rem;\n  align-items: center;\n  background: var(--background-color);\n  color: var(--text-color);\n  box-shadow: var(--small-box-shadow);\n  border-radius: var(--border-radius);\n  flex-wrap: wrap;\n  row-gap: 1rem;\n  min-height: 3.5rem; }\n\n.custom-sanjay-strip-container-1 {\n  display: flex;\n  align-items: center;\n  justify-content: space-between; }\n\n.custom-sanjay-strip-name-initial-container {\n  color: var(--text-color);\n  border-radius: 50%;\n  border: 1px solid var(--text-color);\n  font-weight: bold;\n  padding: 1rem; }\n\n.custom-sanjay-strip-user-name-email-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  margin-inline: 1rem; }\n\n.custom-sanjay-strip-name-container {\n  font-weight: bold;\n  font-size: 1.2rem;\n  text-transform: capitalize;\n  text-align: center; }\n\n.custom-sanjay-strip-superuser-container {\n  align-self: flex-start;\n  margin-left: 0.5rem;\n  padding: 0.3rem;\n  margin-top: 0.3rem;\n  color: var(--text-color);\n  background: var(--background-color);\n  border-radius: var(--border-radius); }\n\n.custom-sanjay-strip-container-2 {\n  margin-right: 2rem;\n  width: 20%;\n  display: flex;\n  justify-content: flex-end;\n  column-gap: 1rem; }\n\n.custom-sanjay-strip-superuser-null-container {\n  display: none; }\n\n@media screen and (max-width: 725px) {\n  .custom-sanjay-strip {\n    width: 100%;\n    padding-block: 0.525rem 1.5rem;\n    row-gap: 2.5rem; }\n  .custom-sanjay-strip-container-1 {\n    width: 100%;\n    flex-direction: column;\n    align-items: center;\n    column-gap: 1rem;\n    row-gap: 0.5rem;\n    margin-right: 1.5em; }\n  .custom-sanjay-strip-superuser-container {\n    align-self: center; }\n  .custom-sanjay-strip-name-initial-container {\n    border-radius: 50%;\n    padding: 1.5rem;\n    font-size: x-large;\n    font-weight: 100; }\n  .custom-sanjay-strip-container-2 {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    column-gap: 2rem;\n    row-gap: 0.5rem; }\n  .custom-sanjay-strip-container-2 > * {\n    flex: 1;\n    width: 80%; }\n  .custom-sanjay-strip-user-name-email-container,\n  .custom-sanjay-strip-superuser-container {\n    margin: 0; }\n  .custom-sanjay-strip-user-name-email-container > span {\n    align-self: center; } }\n\n/*\n \nBooking\n \n*/\n.booking-custom-strips {\n  width: 97.5%;\n  display: grid;\n  grid-template-columns: 30% 70%;\n  background: var(--background-color);\n  padding: 1rem;\n  margin-block-end: 0.2rem;\n  box-shadow: var(--small-box-shadow);\n  border-radius: var(--border-radius);\n  min-height: 3.5rem;\n  align-items: center; }\n\n.booking-custom-strips-2 {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center; }\n\n.station-name-containers {\n  display: flex;\n  justify-content: flex-start;\n  margin-bottom: 0.25rem; }\n\n.station-name-containers .station-names {\n  color: var(--text-color);\n  font-weight: bold; }\n\n.time-containers {\n  display: flex;\n  justify-content: flex-start;\n  margin-bottom: 0.25rem;\n  color: var(--text-color); }\n\n.time-containers span {\n  color: var(--text-color);\n  font-size: smaller; }\n\n.booking-containers {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center; }\n\n.booking-containers > span {\n  color: var(--text-color); }\n\n.booking-containers > b {\n  margin-left: 0.25rem;\n  color: var(--text-color); }\n\n@media screen and (max-width: 850px) {\n  .booking-custom-strips {\n    grid-template-columns: 35% 65%; }\n    .booking-custom-strips .booking-custom-strips-2 {\n      margin-left: 1rem; } }\n\n@media screen and (max-width: 650px) {\n  .booking-custom-strips {\n    grid-template-columns: 50% 50%; }\n    .booking-custom-strips .booking-custom-strips-2 {\n      margin-left: 0; } }\n\n@media screen and (max-width: 485px) {\n  .booking-custom-strips {\n    width: 95%;\n    display: flex;\n    flex-direction: column;\n    background: var(--background-color);\n    box-shadow: var(--small-box-shadow);\n    padding: 1rem;\n    flex-wrap: wrap;\n    align-items: normal; }\n    .booking-custom-strips .booking-custom-strips-1 > * {\n      margin-bottom: 0.5rem; }\n      .booking-custom-strips .booking-custom-strips-1 > * .booking-containers {\n        align-self: flex-end; }\n    .booking-custom-strips .booking-custom-strips-2 {\n      display: flex;\n      justify-content: flex-start;\n      align-items: center;\n      margin-top: 1rem;\n      row-gap: 0.25rem; } }\n\n.ongoing-trip-status-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  row-gap: 0.2rem;\n  width: 100%; }\n  .ongoing-trip-status-container .ongoing-trip-status-container-1 {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end; }\n  .ongoing-trip-status-container .ongoing-trip-status-container-2 {\n    display: flex;\n    justify-content: space-between;\n    color: var(--text-color); }\n\n.mule-icon {\n  margin: 0;\n  height: 18px;\n  align-self: flex-start; }\n\n.progress-wrapper {\n  position: relative;\n  width: 100%;\n  height: 0.3rem;\n  background: #eeeeee;\n  border-radius: var(--border-radius); }\n  .progress-wrapper .progress {\n    position: absolute;\n    background: var(--button-background-color);\n    height: 100%;\n    border-radius: var(--border-radius);\n    transition: width 0.5s ease;\n    background-size: 200% 200%;\n    animation: gradient 5s ease infinite; }\n\n@keyframes gradient {\n  0% {\n    background-position: 0% 50%; }\n  50% {\n    background-position: 100% 50%; }\n  100% {\n    background-position: 0% 50%; } }\n\n.loading-strip {\n  display: flex;\n  justify-content: space-between;\n  min-height: 3.5rem;\n  border-radius: var(--border-radius);\n  margin-block-end: 0.5rem;\n  box-shadow: var(--small-box-shadow);\n  padding: 0.5rem 0.825rem;\n  background: var(--background-color); }\n\n.loading-strip-1-trips {\n  width: 30%; }\n\n.loading-strip-2-trips {\n  width: 60%; }\n\n.loading-strip-1-sanjay {\n  width: 60%; }\n\n.loading-strip-2-sanjay {\n  width: 20%; }\n\n@media screen and (max-width: 725px) {\n  .loading-strip {\n    height: 200px;\n    flex-direction: column;\n    row-gap: 0.5rem;\n    padding: 1.5rem; }\n  .loading-strip > * {\n    width: 100%; } }\n");o.a.createElement(x.a,N({},{showLoadingAnimation:!0,rows:3,ready:!1}));M(".custom-table {\n  display: flex;\n  flex-direction: column;\n  color: var(--text-color);\n  background-color: rgba(0, 0, 0, 0.11);\n  border-radius: var(--border-radius);\n  box-shadow: var(--small-box-shadow);\n  overflow: hidden;\n  border-spacing: 0;\n  width: 100%;\n  height: 100%; }\n  .custom-table thead {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n    border-radius: var(--border-radius) var(--border-radius) 0 0;\n    margin-bottom: 0.2rem;\n    background: var(--background-color); }\n    .custom-table thead tr {\n      display: flex;\n      width: 100%;\n      flex-direction: row; }\n      .custom-table thead tr th {\n        width: 100%;\n        padding-inline: 1rem;\n        padding-block: 0.6rem;\n        text-align: left; }\n  .custom-table tbody {\n    overflow: auto;\n    width: 100%;\n    display: flex;\n    flex-direction: column; }\n    .custom-table tbody tr {\n      align-items: center;\n      background: var(--background-color);\n      display: flex;\n      width: 100%;\n      margin-bottom: 0.1rem; }\n    .custom-table tbody tr:last-child {\n      border-radius: 0 0 var(--border-radius) var(--border-radius); }\n    .custom-table tbody td {\n      width: 100%;\n      padding-inline: 1rem;\n      padding-block: 0.6rem; }\n\n@media screen and (max-width: 600px) {\n  .custom-table {\n    border: 0; }\n    .custom-table thead {\n      border: none;\n      clip: rect(0 0 0 0);\n      height: 1px;\n      margin: -1px;\n      overflow: hidden;\n      padding: 0;\n      position: absolute;\n      width: 1px; }\n    .custom-table tbody tr {\n      align-items: normal; }\n    .custom-table tr {\n      border-bottom: 3px solid #ddd;\n      display: flex;\n      flex-direction: column; }\n    .custom-table td {\n      width: auto !important;\n      border-bottom: 1px solid #ddd;\n      display: flex;\n      justify-content: space-between;\n      font-size: 0.8em; }\n    .custom-table td::before {\n      content: attr(data-label);\n      text-transform: uppercase;\n      margin-right: 1rem; }\n    .custom-table td:last-child {\n      border-bottom: 0; } }\n");M("* {\n  transition: background 0.1s ease-in-out; }\n");M('@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,700;1,700&display=swap");\n* {\n  font-family: "Roboto", sans-serif; }\n\n:root {\n  --text-color: #505d79;\n  --muted-text-color: #a3a6b68c;\n  --background-color: linear-gradient(135deg, white 51%, #fef9fd 100%);\n  --dark-color: #1a1c20;\n  --button-background-color: linear-gradient(to right, #ad5389, #3c1053);\n  --toned-color: #6e7079;\n  --datepicker-background-color: datepicker-background-color;\n  --strips-border-radius: 10px;\n  --small-box-shadow: -2px 2px 4px rgba(0, 0, 0, 0.11), 1px 0px 2px rgba(0, 0, 0, 0.11);\n  --medium-box-shadow: 0px 0px 10px -1px rgba(0, 0, 0, 0.15);\n  --large-box-shadow: 0 0 2px rgba(0, 0, 0, 0.15), 0 0 4px rgba(0, 0, 0, 0.15), 0 0 8px rgba(0, 0, 0, 0.15), 0 0 16px rgba(0, 0, 0, 0.15), 0 0 32px rgba(0, 0, 0, 0.15), 0 0 64px rgba(0, 0, 0, 0.15), 0 0 128px rgba(0, 0, 0, 0.15);\n  --bottom-box-shadow: 0 8px 6px -6px rgba(0, 0, 0, 0.15);\n  --muted-dark-color: #1a1c2018;\n  --ati-logo-text-color: #cd381c;\n  --border-radius: 10px;\n  --button-border-radius: 5px;\n  --button-text-color: #e3ebfe;\n  --card-border-radius: 20px;\n  --button-border-color: #505d79; }\n\n.text-row {\n  background: var(--muted-text-color) !important; }\n');var re={"Content-Type":"application/json",Accept:"*/*"},ae=function(e){var t=e.url,n=e.method,r=void 0===n?"get":n,o=e.headers,c=void 0===o?re:o,i=e.body,u=e.on_error,s=e.on_success,l=Object(a.useState)(!1),d=l[0],m=l[1],p=Object(a.useRef)(!1);console.log("headers",c),Object(a.useEffect)((function(){return p.current=!0,function(){p.current=!1}}),[]);return[function(e){var n=void 0===e?{request_headers:c,request_body:i,request_method:r,with_credentials:!1}:e,a=n.request_headers,o=void 0===a?c:a,l=n.request_body,d=void 0===l?i:l,f=n.request_method,_=void 0===f?r:f,h=n.with_credentials,b=void 0!==h&&h;return C(void 0,void 0,void 0,(function(){var e,n,r;return R(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),p.current&&m(!0),b&&(E.a.defaults.withCredentials=!0),e={url:t,method:_,headers:o,data:d},[4,E()(e)];case 1:return n=a.sent(),p.current&&m(!1),s(n),[3,3];case 2:return r=a.sent(),m(!1),u(r),[3,3];case 3:return[2]}}))}))},d]};function oe(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,className:"bi bi-eye "+(r&&r),viewBox:"0 0 16 16"},a),o.a.createElement("path",{d:"M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"}),o.a.createElement("path",{d:"M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"}))}function ce(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=S(e,["color","className"]);return o.a.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:n,className:"bi bi-eye-slash "+(r&&r),viewBox:"0 0 16 16"},a),o.a.createElement("path",{d:"M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"}),o.a.createElement("path",{d:"M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"}),o.a.createElement("path",{d:"M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"}))}M(".checkbox-input {\n  display: flex;\n  align-items: center;\n  column-gap: 0.3rem; }\n  .checkbox-input input {\n    height: 18px;\n    width: 18px; }\n\n.number-input, .text-input {\n  display: flex;\n  flex-direction: column;\n  border: 2px solid var(--text-color);\n  overflow: hidden;\n  padding-inline: 0.5rem;\n  padding-block: 0.2rem;\n  row-gap: 0.2rem;\n  border-radius: var(--border-radius); }\n  .number-input label, .text-input label {\n    font-size: 0.8rem;\n    color: var(--text-color);\n    text-align: start; }\n  .number-input input, .text-input input {\n    border: none;\n    padding-block: 0rem;\n    transition: padding-block 0.2s ease-in-out;\n    background: transparent;\n    color: var(--text-color); }\n  .number-input input:focus, .text-input input:focus {\n    outline: none;\n    padding-block: 0.5rem;\n    transition: padding-block 0.2s ease-in-out; }\n  .number-input .password-container, .text-input .password-container {\n    display: flex;\n    justify-content: space-between;\n    align-items: center; }\n\n.select-input {\n  display: flex;\n  flex-direction: column;\n  border: 2px solid var(--text-color);\n  overflow: hidden;\n  padding-inline: 0.5rem;\n  padding-block: 0.2rem;\n  row-gap: 0.2rem;\n  border-radius: var(--border-radius); }\n  .select-input label,\n  .select-input span {\n    font-size: 0.8rem;\n    color: var(--text-color);\n    text-align: start; }\n  .select-input select {\n    background-color: transparent;\n    border: none;\n    width: 100%;\n    border: none;\n    padding-block: 0rem;\n    transition: padding-block 0.2s ease-in-out;\n    color: var(--text-color); }\n  .select-input select:focus {\n    outline: none;\n    padding-block: 0.5rem;\n    transition: padding-block 0.2s ease-in-out; }\n");function ie(e){var t=e.label,n=e.onChange,r=e.onError,c=e.minLength,i=e.maxLength,u=e.type,s=e.regex,l=S(e,["label","onChange","onError","minLength","maxLength","type","regex"]),d=Object(a.useState)(!0),m=d[0],p=d[1],f=Object(a.useRef)(!1);Object(a.useEffect)((function(){return f.current=!0,"password"===u&&p(!1),function(){f.current=!1}}),[]);var _=function(){f.current&&p(!m)},h=function(e){return s.test(e)};return o.a.createElement("section",{className:"text-input"},t.length>0&&o.a.createElement("label",null,t),o.a.createElement("div",{className:"password-container"},o.a.createElement("input",N({type:m?"text":"password",onChange:function(e){c&&e.target.value.length<c||i&&e.target.value.length>i?r&&r({message:"value exceeds the range given",key:"range_exceeded",event:e}):s&&!h(e.target.value)?r&&r({message:"Given string is not matching the regular expression",key:"regex_unmatch",event:e}):n(e)},minLength:c,maxLength:i},l)),"password"===u&&(m?o.a.createElement(ce,{className:"password-icon",onClick:_}):o.a.createElement(oe,{className:"password-icon",onClick:_}))))}var ue=function(e){var t=e.label,n=e.options,r=e.onChange,a=S(e,["label","options","onChange"]);return o.a.createElement("section",{onChange:function(e){r(e)},className:"select-input"},t&&o.a.createElement("label",null,t),n.length>0?o.a.createElement("select",N({},a,{type:"checkbox"}),function(e){return e.map((function(e,t){return o.a.createElement("option",{key:t,value:e.value},e.name)}))}(n)):o.a.createElement("span",null," no options available... "))},se=function(e){var t=e.progress;return o.a.createElement("div",{className:"progress-wrapper"},o.a.createElement("div",{className:"progress",style:{width:t+"%"}}))};var le=function(){var e=Object(s.g)(),t=Q().add_alert,n=Object(a.useState)(!0),r=Object(l.a)(n,2),c=r[0],i=r[1],d=Object(s.h)();Object(a.useEffect)((function(){console.log(d.pathname),"/map_editor"===d.pathname?i(!1):i(!0)}),[d]);var p=ae({url:"".concat(b,"/logout"),method:"post",on_error:function(e){t({message:e.message,status:"danger"})},on_success:function(t){t.data;localStorage.removeItem("token"),e.push("/")}}),f=Object(l.a)(p,2),_=f[0],h=(f[1],[{name:"Map Creator",link:"/map_creator"},{name:"Map Editor",link:"/map_editor_"},{name:"Sherpa Status",link:"/webctl"}]);return o.a.createElement("nav",{className:"navbar"},o.a.createElement("img",{className:"logo",alt:"logo",src:String(m.a)}),o.a.createElement("ul",{className:"nav-links"},c&&h.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement(u.b,{className:"nav-link sherpa-nav-link",activeClassName:"nav-link-active sherpa-nav-link",exact:0===t,to:e.link},e.name))})),c&&o.a.createElement("li",{className:"nav-link logout-link",onClick:function(){return _({request_headers:g()})}},"Logout")))},de=n(6),me=n(16),pe=n(5),fe=n.n(pe),_e=n(21),he=n(13),be=n.n(he),ge=n(19),ve=n(343);function ye(e,t,n){if(t&&n){var r=ve.a.mul(t,n);return ve.a.add(e,r)}}function we(e,t){var n=ve.a.sub(e,t);return ve.a.div(n,n.norm())}var xe=function(e,t){for(var n,r,a,o=e.clone(),c=0,i=e.rows;c<=i-3;)n=e.getRowVector(c),r=e.getRowVector(c+1),a=e.getRowVector(c+2),o.removeRow(2*c+1),o.addRow(2*c+1,ye(r,we(n,r),t)),o.addRow(2*c+2,ye(r,we(r,a).mul(-1),t)),c+=1;return o},je=function(e){return e.map((function(e){return Math.abs(e)}))},ke=function(e){var t,n=e.length,r=[];for(t=1;t<n;t++)r.push(e[t]-e[t-1]);return r},Oe=function(e,t){var n;return e.length===t.length&&(n=e.map((function(e,n){return e*t[n]}))),n},Ee=function(e,t){return e.map((function(e){return Math.pow(e,t)}))};function Ne(e,t,n,r){var a,o,c,i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50,s=ve.a.columnVector(e),l=ve.a.columnVector(n),d=ve.a.sub(l,s),m=Se(t,r,d,u),p=ve.a.cos(m),f=ve.a.sin(m),_=[];p.cumulativeSum(),f.cumulativeSum();try{p.get(p.size-1,0)}catch(b){console.log("err: theta_cos",p),console.log("err: u1, u2, ts",t,r,d),console.log("err: p1,p2",e,n)}a=parseFloat(d.get(0,0))/(parseFloat(p.get(p.size-1,0))+1e-4),o=parseFloat(d.get(1,0))/(parseFloat(f.get(f.size-1,0))+1e-4);for(var h=0;h<m.size;h++)c=e[0]+a*parseFloat(p.get(h,0)),i=e[1]+o*parseFloat(f.get(h,0)),_.push(c,i);return _}function Se(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,a=n.norm()+1,o=Math.round(a*r*1.4,0),c=Math.atan2(t[1],t[0]),i=Math.atan2(e[1],e[0]);c-i>Math.PI?c-=2*Math.PI:c-i<-Math.PI&&(c+=2*Math.PI);var u=Ce(i,c,o),s=ve.a.columnVector(u);return s}function Ce(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5001,r=0,a=1,o=(a-r)/(n-1),c=[],i=r,u=0;u<n;u++){var s=(e-t)*(1-3*Math.pow(i,2)+2*Math.pow(i,3))+t;c.push(s),i+=o}return c}function Re(e,t){return e.map((function(e){return parseFloat(e.toFixed(t))}))}var Me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return parseFloat((e*Math.PI/180).toFixed(t))};function Ie(e,t){var n=new ve.a(e.getRowVector(t)).to1DArray();n=Re(n,3);var r=new ve.a(e.getRowVector(t+1)).to1DArray();return["straight",n,r=Re(r,3),0]}function De(e,t){var n=Re(e.getRowVector(t).to1DArray(),3),r=ve.a.sub(e.getRowVector(t),e.getRowVector(t-1));r=Re(ve.a.div(r,r.norm()).to1DArray(),3);var a=Re(e.getRowVector(t+1).to1DArray(),3),o=ve.a.sub(e.getRowVector(t+2),e.getRowVector(t+1));return["turn",n,r,a,o=Re(ve.a.div(o,o.norm()).to1DArray(),3),function(e,t,n,r){var a=Math.atan2(e[1],e[0]),o=Math.atan2(t[1],t[0]);o-a>Math.PI?o-=2*Math.PI:o-a<-Math.PI&&(o+=2*Math.PI);var c=Ce(a,o),i=Math.PI/2;return function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t];return n}(je(ke(c)))/i<.33?0:3}(r,o)]}function ze(e){console.info("path make_route",e);for(var t=e.rows,n=[],r=0;r<t-1;)r%2===0||r===t-2?n.push(Ie(e,r)):n.push(De(e,r)),r+=1;return n}var Fe=function(e){var t=[];try{for(var n in e){var a;"straight"===e[n][0]?t=(a=t).concat.apply(a,Object(r.a)(e[n].slice(1,-1))):"turn"===e[n][0]&&(t=t.concat(Ne.apply(void 0,Object(r.a)(e[n].slice(1,-1)))))}}catch(o){console.log("error in parse routes:",o)}finally{return t}},Ae=function(e,t){var n,r=ke(e),a=ke(t),o=ke(r),c=ke(a),i=function(e,t){var n;return e.length===t.length&&(n=e.map((function(e,n){return e-t[n]}))),n}(Oe(r.slice(1,r.length),c),Oe(a.slice(1,r.length),o)),u=Ee(function(e,t){var n;return e.length===t.length&&(n=e.map((function(e,n){return e+t[n]}))),n}(Ee(r.slice(1,r.length),2),Ee(a.slice(1,r.length),2)),1.5);return je((n=u,i.map((function(e,t){return e/n[t]}))))};var Te=function(e,t,n,r){var a=new ve.a([e,t,n,r]),o=a.getRowVector(1).to1DArray(),c=ve.a.sub(a.getRowVector(1),a.getRowVector(0));c=ve.a.div(c,c.norm()).to1DArray();var i=a.getRowVector(2).to1DArray(),u=ve.a.sub(a.getRowVector(3),a.getRowVector(2));return[o,c,i,u=ve.a.div(u,u.norm()).to1DArray()]},Le=function(e,t,n){console.log("px,py",e,t);var a=Ae(e,t);console.log("curva",a);var o,c=(o=a,Math.max.apply(Math,Object(r.a)(o)));return console.info("max_curva",c,n,c>n),c>n};function Pe(e,t,n,r){return[e-n,t-r]}function qe(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}var He=function(e,t,n,r,a,o){var c=!1,i=Ve(n,r,a,o),u=Ve(e,t,n,r),s=Ve(e,t,a,o);return console.log("Math.abs(distance_p1_p2 - distance_p_p1 - distance_p_p2)",Math.abs(i-u-s)),Math.abs(i-u-s)<=5&&(c=!0),c},Ve=function(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))},We=function(e){var t=e.route_ref,n=e.show,r=void 0===n||n,a=e.route_id,o=void 0===a?null:a;Object.values(t).forEach((function(e){var t=Object(l.a)(e.line.children,2),n=(t[0],t[1]);o&&e.route_id===o||(r?n.show():n.hide())}))},Be=n(148),Je=n.n(Be),Ue=n(149),Ye=n.n(Ue),Ge=n(150),Xe=n.n(Ge);var Ke=function(e){var t=Object(a.useRef)(3),n=Object(a.useState)(!1),r=Object(l.a)(n,2),c=r[0],i=r[1],u=Object(a.useState)(null),s=Object(l.a)(u,2),d=s[0],m=s[1],p=Object(a.useRef)(new Image),f=function(){m(e.map_image.current.rotation())};Object(a.useEffect)((function(){var e=!0;return p.current.src=Xe.a,p.current.onload=function(){e&&(i(!0),f())},function(){return e=!1}}),[]),Object(a.useEffect)((function(){var t;return t=!1,Object.keys(e.icon_list.current).forEach((function(n){e.icon_list.current[n].draggable(t)})),e.map_image.current&&c&&function(){!function(){if(e.stage.current){Object.keys(e.station_coord.current).length;e.pivot_ref.current=new be.a.Image({x:e.stage.current.width()/2,y:e.stage.current.height()/2,image:p.current,width:40,height:40,offset:{x:20,y:20},dragBoundFunc:function(t){var n=t.y,r=t.x,a=e.stage.current.width(),o=e.stage.current.height();return t.y>o-20?n=o-20:t.y<20&&(n=20),t.x>a-20?r=a-20:t.x<20&&(r=20),{x:r,y:n}},draggable:!0}),e.pivot_ref.current.on("dragend",(function(t){var n=t.target.attrs,r=n.x,a=n.y;e.pivot.current={x:r,y:a}}))}}();var t=e.stage.current.width()/2,n=e.stage.current.height()/2;e.pivot.current={x:t,y:n},e.layer.current.add(e.pivot_ref.current),e.layer.current.draw()}(),function(){e.map_image.current&&e.is_mounted.current&&(e.pivot_ref.current&&e.pivot_ref.current.destroy(),e.layer.current.draw())}}),[e.map_image.current,c]);var _=function(e){t.current=e.target.value};function h(){e.map_image.current.x(e.map_cord.current.x),e.map_image.current.y(e.map_cord.current.y),e.layer.current&&e.layer.current.batchDraw()}function b(){return g.apply(this,arguments)}function g(){return(g=Object(_e.a)(fe.a.mark((function n(){var r,a,o,c=arguments;return fe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=c.length>0&&void 0!==c[0]?c[0]:-1,a=t.current*r*Math.PI/180,o=e.shift_coord_update_pos(e.map_cord.current.x,e.map_cord.current.y,e.pivot.current.x,e.pivot.current.y),o=e.rotate_point(o[0],o[1],a),o=e.shift_coord_update_pos(o[0],o[1],-e.pivot.current.x,-e.pivot.current.y),e.map_cord.current=Object(me.a)(Object(me.a)({},e.map_cord.current),{},{x:o[0],y:o[1]});case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function v(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;b(n),h(),e.map_image.current.rotate(n*t.current),e.update_icon_pos(),e.redraw_all_routes(),e.circle_hide_tool_tip(),e.grid_state&&(e.clear_grid(),e.draw_grid(!0)),f(),e.reset_zindex(),e.layer.current&&e.layer.current.batchDraw()}var y=function(n){var r=t.current,a=e.map_image.current.attrs.rotation;t.current=a,v(-1),t.current=n.target.value,v(1),t.current=r,m(n.target.value),e.layer.current.batchDraw()};return o.a.createElement("div",null,o.a.createElement("div",{className:"map-side-column"},o.a.createElement("div",{className:"align-map-input-form"},o.a.createElement("section",{className:"align-map-input-form-section"},o.a.createElement("div",{className:"align-map-input"},o.a.createElement("label",{className:"step-size-label"},"Step size:"),o.a.createElement("input",{type:"number",onChange:_,step:.5,placeholder:t.current,className:"step-size-input"}),o.a.createElement("p",null,"deg"))),o.a.createElement("div",{className:"map-editor-rounded-button-div"},o.a.createElement("button",{className:"map-editor-rounded-button",onClick:function(){return v(1)},title:"clockwise"},o.a.createElement("img",{className:"arrow-clockwise-icon",src:Je.a})),o.a.createElement("button",{className:"map-editor-rounded-button",onClick:function(){return v(-1)},title:"anti-clockwise"},o.a.createElement("img",{className:"arrow-anti-clockwise-icon",src:Ye.a})))),o.a.createElement("section",null,o.a.createElement("label",null,"Total rotation :"),o.a.createElement("input",{placeholder:d||"0",value:d||"",onChange:y,type:"number",className:"total-rotation-input"}))))},Qe=n(28),Ze=n(151),$e=n.n(Ze),et=function(e,t,n,r,a){var o=r[a=parseInt(a)].route_id;return delete r[a],t.node.splice(t.node.indexOf(a),1),o in e&&e[o].node.splice(e[o].node.indexOf(a),1),a in n&&delete n[a],[e,t,n,r]},tt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],a=!1;return e.node.some((function(e){if(t[e].post_process)r.push(e);else if(parseInt(e)===parseInt(n))a=!0;else if(parseInt(e)===parseInt(n)||a){if(a)return!0}else r=[]})),r},nt=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(a){var o,c=tt(t,r,a),i=Object(Qe.a)(c);try{for(i.s();!(o=i.n()).done;){var u=o.value,s=r[u].node;s.destroy();var d=et(e,t,n,r,u),m=Object(l.a)(d,4);e=m[0],t=m[1],n=m[2],r=m[3]}}catch(p){i.e(p)}finally{i.f()}}};var rt=function(e){var t,n,c,i=Object(a.useState)(null),u=Object(l.a)(i,2),s=u[0],d=u[1],m=Object(a.useState)(null),p=Object(l.a)(m,2),f=p[0],_=p[1],h=Object(a.useRef)(null),b=Object(a.useState)(null),g=Object(l.a)(b,2),v=(g[0],g[1]),y=Object(a.useRef)(new Image),w=Object(a.useRef)(null),x=Object(a.useRef)(null),j=Object(a.useRef)(null),k=Object(a.useRef)(null),O=Object(a.useRef)(null),E=Object(a.useRef)(null),N=Object(a.useRef)(null),S=Object(a.useRef)(null),C=Object(a.useRef)(null),R=Object(a.useRef)(null),M=Object(a.useRef)("add_station"),I=Object(a.useState)("add_station"),D=Object(l.a)(I,2),z=D[0],F=D[1],A=Object(a.useState)(!1),T=Object(l.a)(A,2),L=T[0],P=T[1],q=Q(),H=q.add_alert;function V(t){Object.keys(e.icon_list.current).forEach((function(n){e.icon_list.current[n].draggable(t)}))}q.dispatch_remove_alert,Object(a.useEffect)((function(){return e.map_image.current.on("touch.event2 tap.event2 click.event2",B),y.current.src=$e.a,y.current.onload=function(){P(!0),Object.keys(e.station_coord.current).length>0&&0===Object.keys(e.icon_list.current).length&&(J(),e.reset_map_scale())},function(){e.is_mounted.current&&(e.map_image.current.off("touch.event2 tap.event2 click.event2"),W(!1),V(!1),e.unhighlight_stations())}}),[]),Object(a.useEffect)((function(){me(),V("edit_station"===M.current),"edit_station"===M.current&&le()&&(de(),j.current&&(j.current.value=e.icon_name.current[h.current].attrs.text),k.current&&(k.current.value=-e.icon_list.current[h.current].attrs.rotation))}),[z]),Object(a.useEffect)((function(){"edit_station"===M.current&&$(h.current)}),[h.current]);var W=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?U():Y()},B=function(t){if("add_station"===M.current&&""!==w.current.value&&void 0!==w.current.value&&!pe(w.current.value)&&!fe(w.current.value)){var n=t.target.getStage().getPointerPosition(),r=G(n.x,n.y);h.current=r,v(r),w.current.placeholder=e.icon_name.current[r].attrs.text,x.current.innerHTML="Enter a station name to start adding...",e.layer.current.batchDraw(),k.current.placeholder=e.station_coord.current[r].rotation,E.current.placeholder=e.station_coord.current[r].station_tags?e.station_coord.current[r].station_tags.toString():""}},J=function(){Object.keys(e.station_coord.current).forEach((function(t){var n=e.station_coord.current[t];G(n.x,n.y,t)})),W(!1),V(!1),e.unhighlight_stations()},U=function(){Object.values(e.icon_list.current).forEach((function(t){t.on("click.event2 touch.event2 tap.event2 dragstart.event2",te),t.on("dragmove.event2",re),t.on("dragend.event2",e.reset_tmp_route_node_path)}))},Y=function(){Object.values(e.icon_list.current).forEach((function(e){e.off("click.event2 touch.event2 tap.event2 dragstart.event2 dragmove.event2 dragend.event2")}))};function G(r,a,o){if(Boolean(w.current&&""!==w.current.value)||o){"edit_station"!==M.current&&V(!1);var i=function(r,a,o){var i=parseInt(k.current.value),u=o||function(){var t=Object.keys(e.station_coord.current),n=parseInt(t.slice(-1)[0])+1;return n||(n=1),n}();var s=new be.a.Group({x:r,y:a,draggable:!0,dragBoundFunc:function(t){var n=t.y,r=t.x,a=e.stage.current.width(),o=e.stage.current.height();return t.y>o-10?n=o-10:t.y<10&&(n=10),t.x>a-10?r=a-10:t.x<10&&(r=10),{x:r,y:n}},id:u,rotation:o?-e.station_coord.current[o].rotation+e.map_image.current.rotation():i?-i+e.map_image.current.rotation():-90+e.map_image.current.rotation()}),d=new be.a.Image({image:y.current,width:20,height:20,offset:{x:10,y:10},id:u});if(t=new be.a.Circle({radius:20,fill:"orange",opacity:.5,id:u}),c=new be.a.Text({x:r,y:a-e.Y_OFFSET_NAME,text:o?e.station_coord.current[o].name:w.current.value,fontSize:20,fontFamily:"Calibri",id:u,fill:"black",listening:!1}),s.add(t),s.add(d),n=s,!o){var m=e.get_untransformed_coordinates(r,a),p=Object(l.a)(m,2),f=p[0],_=p[1];e.station_coord.current[u]={x:f,y:_,name:w.current.value,rotation:i||90,inplace:N.current.checked||!1,clockwise:R.current.value||0,charging:S.current.checked||!1,post_process:O.current.checked||!1,hidden:C.current.checked||!1},oe(),w.current.value="",X(f,_,!0),K(u),e.layer.current.batchDraw()}return e.icon_list.current[u]=n,e.icon_name.current[u]=c,e.highlight_stations(u,"orange"),W(!1),n.on("click.event2 touch.event2 tap.event2 dragstart.event2",te),n.on("dragmove.event2",re),n.on("dragend.event2",e.reset_tmp_route_node_path),e.add_tooltip_event_listener_to(u),u}(r,a,o);return e.layer.current.add(n),e.layer.current.add(c),e.layer.current.batchDraw(),i}}var X=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r){var a=e.get_map_coordinate(t,n),o=Object(l.a)(a,2),c=o[0],i=o[1];d(c.toFixed(3)),_(i.toFixed(3))}else{var u=e.get_untransformed_coordinates(t,n),s=Object(l.a)(u,2),m=s[0],p=s[1],f=e.get_map_coordinate(m,p),h=Object(l.a)(f,2),b=h[0],g=h[1];d(b.toFixed(3)),_(g.toFixed(3))}},K=function(e){h.current=e,v(e)},Z=function(t,n,r){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(a)if(o){var c=e.get_transformed_coordinates(t,n),i=Object(l.a)(c,2),u=i[0],s=i[1];e.station_coord.current[r].x=t,e.station_coord.current[r].y=n,e.icon_name.current[r].x(u),e.icon_name.current[r].y(s-e.Y_OFFSET_NAME)}else{var d=e.get_untransformed_coordinates(t,n),m=Object(l.a)(d,2),p=m[0],f=m[1];e.station_coord.current[r].x=p,e.station_coord.current[r].y=f,e.icon_name.current[r].x(t),e.icon_name.current[r].y(n-e.Y_OFFSET_NAME)}ee(r)},$=function(t){j.current&&(j.current.value=e.icon_name.current[t].attrs.text),k.current&&(k.current.value=e.station_coord.current[t].rotation),S.current&&(S.current.checked=e.station_coord.current[t].charging),C.current&&(C.current.checked=e.station_coord.current[t].hidden),E.current&&(E.current.value=e.station_coord.current[t].station_tags?e.station_coord.current[t].station_tags.toString():"")},ee=function(t){N.current&&(N.current.checked=e.station_coord.current[t].inplace),R.current&&(R.current.value=e.station_coord.current[t].clockwise,R.current.innerHTML=1==e.station_coord.current[t].clockwise?"Clockwise":"Anticlockwise"),O.current&&(O.current.checked=e.station_coord.current[t].post_process)},te=function(t){var n=t.target.attrs.id,r=e.station_coord.current[n],a=r.x,o=r.y;Z(a,o,n,!1,!0),X(a,o,!0),"edit_station"===M.current?e.highlight_stations(n):e.highlight_stations(n,"orange"),K(parseInt(n))},ne=function(){for(var t in e.route_ref.current){var n=e.route_ref.current[t];parseInt(n.from_station)!==parseInt(h.current)&&parseInt(n.to_station)!==parseInt(h.current)||(e.load_temp_route(t),e.tmp_route_details.current.line&&e.tmp_route_details.current.line.destroy(),e.line.current=e.draw_route(!1),e.save_temp_route(t))}e.line.current=null},re=function(t){var n=t.target.attrs,r=n.x,a=n.y,o=n.id;e.update_tooltip(r,a),Z(r,a,o),X(r,a),ae(parseInt(o)),ne(),e.reset_zindex(),e.layer.current.batchDraw()},ae=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object.values(e.route_ref.current).forEach((function(n){var a=n.node;if(a.length>0&&(n.from_station==t||n.to_station==t)){var o,c=[],i=t==n.from_station,u=e.node_ref.current,s=null,l=null,d=Object(Qe.a)(a);try{for(d.s();!(o=d.n()).done;){var m=o.value;u[m].post_process||(s||(s=m),l=m)}}catch(h){d.e(h)}finally{d.f()}c=i&&s?a.slice(0,a.indexOf(s)):!i&&l?a.slice(a.indexOf(l)+1):Object(r.a)(a);var p,f=Object(Qe.a)(c);try{for(f.s();!(p=f.n()).done;){var _=p.value;a.splice(a.indexOf(_),1),delete e.node_ref.current[_]}}catch(h){f.e(h)}finally{f.f()}}}))},oe=function(){R.current.innerHTML=1==R.current.value?"Clockwise":"Anticlockwise"},ce=function(){h.current?(e.station_coord.current[h.current].inplace=N.current.checked,!N.current.checked&&O.current.checked&&(alert("In-place must always be selected to enable trolley hitch/release point"),O.current.checked=!1,e.station_coord.current[h.current].post_process=N.current.checked)):!N.current.checked&&O.current.checked&&(alert("In-place must always be selected to enable trolley hitch/release point"),O.current.checked=!1)},ie=function(){h.current&&(e.station_coord.current[h.current].charging=S.current.checked)},ue=function(){h.current&&(e.station_coord.current[h.current].hidden=C.current.checked)},se=function(t){t.preventDefault(),R.current.value=1-R.current.value,oe(),h.current&&(e.station_coord.current[h.current].clockwise=parseInt(R.current.value))},le=function(){return!!h.current},de=function(){if(h.current){var t=e.station_coord.current[h.current],n=t.x,r=t.y,a=t.charging,o=t.rotation,c=t.clockwise,i=t.inplace,u=t.post_process,s=t.hidden,m=e.get_map_coordinate(n,r),p=Object(l.a)(m,2),f=p[0],b=p[1];d(f),_(b),R.current.innerHTML=1==c?"Clockwise":"Anticlockwise",S.current.checked=a,O.current.checked=u,k.current.value=o,N.current.checked=i,C.current.checked=s}},me=function(){h.current=null,v(null),d(null),_(null),N.current&&(N.current.checked=!1),R.current&&(R.current.innerHTML="Anticlockwise"),S.current&&(S.current.checked=!1),O.current&&(O.current.checked=!1),k.current&&(k.current.value=90),C.current&&(C.current.checked=!1),E.current&&(E.current="")},pe=function(t){var n=!1;for(var r in e.icon_name.current)if(e.icon_name.current[r].attrs.text===t&&r!==h.current){n=!0;break}return n},fe=function(e){return!(e.length>=2)},_e=function(e){!function(e){""!==e.target.value?(d(null),_(null),N.current.checked=!1,O.current.checked=!1,k.current.value=90,k.current.placeholder=90,R.current.innerHTML="Anticlockwise"):de()}(e),x.current&&(""!==e.target.value?(he("","Touch the map to add the station at that position..."),pe(e.target.value)?he("text-danger","Station name already exists please try a different one"):fe(e.target.value)&&he("text-danger","Station name length must be greater than 2")):he("","Enter a station name to start adding..."))},he=function(e,t){x.current.innerHTML=t,x.current.className=e},ge=function(t){var n,r,a=t.target.value;"x_coord"===t.target.id?(d(a),n=parseFloat(a),r=parseFloat(f),ye(n,r)):(t.target.id="y_coord")&&(_(a),r=parseFloat(a),n=parseFloat(s),ye(n,r)),ne(),ae(parseInt(h.current)),e.reset_tmp_route_node_path(),e.circle_hide_tool_tip()},ve=function(){N.current.checked?h.current&&(e.station_coord.current[h.current].post_process=O.current.checked):(alert("In-place should be enabled to select trolley hitch point"),O.current.checked=!1)},ye=function(t,n){if(h.current){var r=e.get_pixel_coordinate(t||0,n||0),a=Object(l.a)(r,2),o=a[0],c=a[1];e.station_coord.current[h.current].x=o,e.station_coord.current[h.current].y=c;var i=e.get_transformed_coordinates(o,c),u=Object(l.a)(i,2),s=u[0],d=u[1];e.icon_name.current[h.current].y(d-e.Y_OFFSET_NAME),e.icon_name.current[h.current].x(s),e.icon_list.current[h.current].x(s),e.icon_list.current[h.current].y(d),e.reset_zindex(),e.layer.current.batchDraw()}},we=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("section",null,o.a.createElement("label",null,"x :"),o.a.createElement("input",{id:"x_coord",type:"number",step:"0.005",placeholder:"xcoord",value:null===s?"":s,onChange:ge,className:"coord-input"})),o.a.createElement("section",null,o.a.createElement("label",null,"y :"),o.a.createElement("input",{id:"y_coord",type:"number",step:"0.005",placeholder:"ycoord",value:null===f?"":f,onChange:ge,className:"coord-input"})))},xe=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{id:"post_process",ref:O,onChange:ve,type:"checkbox",defaultChecked:h.current&&e.station_coord.current[h.current].post_process})," ","Trolley hitch/release")},je=function(){var t="Anticlockwise";return t=h.current&&1==e.station_coord.current[h.current].clockwise?"Clockwise":"Anticlockwise",o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"sherpa-rotation-text-container"},o.a.createElement("span",null,"Sherpa rotation direction "),o.a.createElement("small",null,"* sherpa entering the station")),o.a.createElement("button",{className:"inplace-clockwise",onClick:se,ref:R,value:h.current&&e.station_coord.current[h.current].clockwise||0},t))};return o.a.createElement("div",null,function(){var t=function(t){if(e.icon_name.current[t])return e.icon_name.current[t].attrs.text},n=function(t){if(e.station_coord.current[t])return e.station_coord.current[t].rotation},r=function(t){if(e.station_coord.current[t])return e.station_coord.current[t].station_tags?e.station_coord.current[t].station_tags.toString():""},a=function(e){e.target.value=t(h.current)||""},c=function(){h.current&&(pe(j.current.value)?he("text-danger","Station name already exists please try a different one"):""===j.current.value?he("text-danger","Station name can't be empty"):fe(j.current.value)?he("text-danger","Station name length must be greater than 2"):(he("",""),e.icon_name.current[h.current].text(j.current.value),e.station_coord.current[h.current].name=j.current.value,e.layer.current.batchDraw()))},i=o.a.createElement("label",{className:"station-angle-container"},o.a.createElement("small",null,"Station Angle:"),o.a.createElement("input",{className:"station-angle-input",type:"number",id:"theta",min:"-180",max:"180",placeholder:n(h.current),ref:k,onFocus:function(e){e.target.value=n(h.current)||""},onChange:function(t){if(h.current){var n=parseInt(t.target.value||0);n>=-180&&n<=180?(e.icon_list.current[h.current].rotation(-n+e.map_image.current.rotation()),e.station_coord.current[h.current].rotation=n,e.layer.current.batchDraw()):H({message:"Invalid station angle!",status:"danger"})}}})),u=o.a.createElement("label",{className:"station-tags-container"},o.a.createElement("small",null,"Station Tags:"),o.a.createElement("input",{className:"station-tags-input",type:"text",placeholder:r(h.current),ref:E,onFocus:function(e){e.target.value=r(h.current)||""},onChange:function(t){h.current&&(e.station_coord.current[h.current].station_tags=[t.target.value])}})),s=function(t){h.current&&(e.icon_list.current[h.current].destroy(),e.icon_name.current[h.current].destroy(),delete e.station_coord.current[h.current],delete e.icon_list.current[h.current],delete e.icon_name.current[h.current],_(null),d(null),Object.values(e.route_ref.current).forEach((function(t){parseInt(h.current)!==parseInt(t.from_station)&&parseInt(h.current)!==parseInt(t.to_station)||e.delete_path(t.route_id)})),h.current=null,v(null),k.current.value=null,E.current.value="",j.current.value="---",e.tooltip.current&&e.tooltip.current.hide(),e.layer.current.batchDraw())},l=function(){return o.a.createElement("button",{className:"edit-mode-button",onClick:function(){"edit_station"===M.current?(e.unhighlight_stations(),W(!1),M.current="add_station",F("add_station")):"add_station"===M.current&&(e.unhighlight_stations(),W(),M.current="edit_station",F("edit_station"))}},"edit_station"===M.current?"+ Add Station":"Edit Station")};return L?o.a.createElement(o.a.Fragment,null,"add_station"===M.current&&o.a.createElement("div",{className:"map-side-column"},o.a.createElement("form",{action:"#",className:"input-form"},o.a.createElement("input",{id:"name",ref:w,type:"text",placeholder:le()?t(h.current):"Station Name",onChange:_e}),o.a.createElement("small",{ref:x,className:""},"Enter a station name to start adding..."),i,u,o.a.createElement("section",{className:"form-checkbox-input"},je()),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"inplace",ref:N,onChange:ce,type:"checkbox",placeholder:"Station Name"})," ","Yes, it has an in-place"," "),o.a.createElement("section",{className:"form-checkbox-input"},xe()),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"charging",ref:S,onChange:ie,type:"checkbox"})," ","Charging station"," "),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"hide_station",type:"checkbox",ref:C,onChange:ue})," ","Hide station"," "),we(),o.a.createElement("small",{className:{fontSize:"0.3rem"}},"* Add a station and drag it to a position")),l()),"edit_station"===M.current&&o.a.createElement("div",{className:"map-side-column"},l(),o.a.createElement("div",{className:"input-form"},le()?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{id:"station_name",placeholder:t(h.current)||"---",ref:j,onFocus:a,onKeyUp:c}),o.a.createElement("small",{ref:x,className:""}),i,u,o.a.createElement("section",{className:"form-checkbox-input"},je()),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"inplace_edit",ref:N,onChange:ce,defaultChecked:h.current&&e.station_coord.current[h.current].inplace,type:"checkbox"})," ","Yes, it has an in-place"," "),o.a.createElement("section",{className:"form-checkbox-input"},xe()),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"charging",ref:S,onChange:ie,type:"checkbox",defaultChecked:h.current&&e.station_coord.current[h.current].charging})," ","Charging station"," "),o.a.createElement("section",{className:"form-checkbox-input"}," ",o.a.createElement("input",{id:"hide_station",type:"checkbox",ref:C,onChange:ue})," ","Hide station"," "),we(),o.a.createElement("button",{className:"map-editor-button",onClick:s},"Delete Station")):o.a.createElement("small",null,"* please select a station first")))):o.a.createElement(o.a.Fragment,null,"loading...")}())};function at(e){return 180*e/Math.PI}var ot=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=[],a=Object(Qe.a)(e);try{for(a.s();!(t=a.n()).done;){var o,c=Object(l.a)(t.value,2),i=c[0],u=c[1],s=[],d=Object(Qe.a)(u);try{for(d.s();!(o=d.n()).done;){var m=o.value,p=m;if("turn"===m[0]){var f=Math.atan2(m[2][1],m[2][0]),_=Math.atan2(m[4][1],m[4][0]);at(Math.abs(f-_))<n&&(p[-1]=0)}s.push(p)}}catch(h){d.e(h)}finally{d.f()}r.push([i,s])}}catch(h){a.e(h)}finally{a.f()}return r};var ct=function(e){return!!(e.maps&&e.maps[0].scale&&e.maps[0].size&&e.maps[0].origin&&e.map_name)},it=function(e){var t;for(var n in e)if(t=e[n],Array.isArray(t))ut(t);else if("object"===typeof t)Object.entries(t).forEach((function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]);st(n)}));else if("string"===typeof t){var r=Number(t);isFinite(r)&&(e[n]=Number(r))}return e},ut=function(e){e.forEach((function(t,n){if("string"===typeof t){var r=Number(t);isFinite(r)&&(e[n]=Number(r))}}))},st=function(e){Object.entries(e).forEach((function(t){var n=Object(l.a)(t,2),r=n[0],a=n[1];if("string"===typeof a){var o=Number(a);isFinite(o)&&(e[r]=Number(o))}else Array.isArray(a)&&ut(a)}))},lt=function(e){var t=Math.sin(e),n=Math.cos(e);return Math.atan2(t,n)};function dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"forward",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=[e[1][1]-e[0][1],e[1][0]-e[0][0]];"reverse"===a&&(c=c.map((function(e){return-1*e})));var i=Math.atan2.apply(Math,Object(r.a)(c)),u=lt(t*Math.PI/180),s=lt(o?i-u:u-i);console.log("station_angle_rad",u),console.log("path_angle",i),console.log("inplace_angle",s);var l=0;return Math.abs(s)>.4&&(Math.abs(s)<Math.PI/4*3||(1==n^s<0&&(l=s<0?1:-1),s+=2*l*Math.PI),["inplace",parseFloat(s.toFixed(3))])}var mt=n(152),pt=n.n(mt);var ft=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],i=n[1],u=Object(a.useState)(""),s=Object(l.a)(u,2),d=s[0],m=s[1],p=Object(a.useRef)(!1),f=Object(a.useState)("add_route"),_=Object(l.a)(f,2),h=_[0],g=_[1],v=Object(a.useState)(null),y=Object(l.a)(v,2),w=(y[0],y[1]),x=Object(a.useState)(.75),j=Object(l.a)(x,2),k=j[0],O=j[1],E=Object(a.useRef)(!1),N=Object(a.useState)("from"),S=Object(l.a)(N,2),C=(S[0],S[1]),R=Object(a.useRef)(null),M=(Object(a.useRef)(null),Object(a.useRef)(null)),I=Object(a.useRef)(null),D=Object(a.useRef)(null),z=Object(a.useRef)(null),F=Object(a.useRef)([]),A=ne(),T=Object(l.a)(A,3),L=T[0],P=T[1],q=T[2],H=Object(a.useRef)({webui_map_json:!0,stations_csv:!0,stations_attributes_json:!0,waypoints_json:!0}),V={},W=Object(a.useRef)(null),B=Object(a.useRef)(["multiple","p2p"]),J=Object(a.useRef)(null),U=(Object(a.useRef)(e.trip_type),Q()),Y=U.add_alert,G=U.dispatch_remove_alert;Object(a.useEffect)((function(){switch(oe(),e.add_delete_mode){case"post_process":Ye(),re(),te({color:"cyan",post_process:!0});break;case"add":Ye(),re(),te({});break;case"delete":re(),Ge();break;case null:Ye()}}),[e.add_delete_mode]);var X=function(t){var n,r=0,a=Object(Qe.a)(e.tmp_route_details.current.node);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o===t)break;e.tmp_node_details.current[o].post_process||r++}}catch(c){a.e(c)}finally{a.f()}return r},K=function(t){t&&(e.tmp_node_details.current[t].node.x(e.tmp_node_details.current[t].x),e.tmp_node_details.current[t].node.y(e.tmp_node_details.current[t].y),e.layer.current.batchDraw())},Z=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.on("dragmove",(function(t){var r=t.target.attrs,a=r.x,o=r.y,c=r.id;e.circle_hide_tool_tip();var i=e.tmp_route_details.current.route_id,u=e.tmp_route_details.current.node,s=u.indexOf(parseInt(c));if(n){if(!isFinite(he(a,o)))return K(c),!1;var d,m=!1,p=0;if(u[s-1]){d=u[s-1],p=X(d);var f={x:e.tmp_cp_details.current[4*p+2],y:e.tmp_cp_details.current[4*p+3]};Ve(a,o,f.x,f.y)<10&&(m=!0),f={x:e.tmp_cp_details.current[4*p],y:e.tmp_cp_details.current[4*p+1]},Ve(a,o,f.x,f.y)<10&&(m=!0)}if(!m&&u[s+1]){d=u[s+1],p=X(d);var _={x:e.tmp_cp_details.current[4*p],y:e.tmp_cp_details.current[4*p+1]};Ve(a,o,_.x,_.y)<10&&(m=!0),_={x:e.tmp_cp_details.current[4*p+2],y:e.tmp_cp_details.current[4*p+3]},Ve(a,o,_.x,_.y)<10&&(m=!0)}if(!m&&u[s+1]){d=u[s+1];var h={x:e.tmp_node_details.current[d].x,y:e.tmp_node_details.current[d].y};Ve(a,o,h.x,h.y)<10&&(m=!0)}if(!m&&u[s-1]){d=u[s-1];var b={x:e.tmp_node_details.current[d].x,y:e.tmp_node_details.current[d].y};Ve(a,o,b.x,b.y)<10&&(m=!0)}if(m)return K(c),!1}if(c in e.tmp_node_details.current){var g=e.get_untransformed_coordinates(a,o),v=Object(l.a)(g,2),y=v[0],w=v[1];e.tmp_node_details.current[c].x=y,e.tmp_node_details.current[c].y=w}n||(e.line.current&&(e.remove_control_points(),e.line.current.destroy(),e.remove_invalid_turns(),e.layer.current.batchDraw()),e.line.current=e.draw_route(),e.route_ref.current[i].line=e.line.current,$(e.check_valid_route()),ee(e.line.current,i),nt(e.route_ref.current,e.tmp_route_details.current,e.node_ref.current,e.tmp_node_details.current,c),e.reset_zindex(),e.layer.current.batchDraw(),e.set_add_delete_mode(null))}))},$=function(t){e.tmp_route_details.current.invalid_route=t},ee=function(t,n){t.children[1].on(" click.e1 tap.e1 touch.e1",(function(){return pe(n)})),e.highlight_current_line()},te=function(t){var n=t.color,r=void 0===n?"orange":n,a=t.post_process,o=void 0!==a&&a;e.line.current&&e.line.current.on("click.e1 tap.e1 touch.e1",(function(e){return Xe(e,r,o)}))},re=function(){Object.values(e.route_ref.current).forEach((function(t){t.route_id!==e.tmp_route_details.current.route_id&&t.line.children[1].off("click.e1 tap.e1 touch.e1")}))},oe=function(){e.line.current&&e.line.current.off("click.e1 tap.e1 touch.e1"),e.tmp_route_details.current.line&&e.map_image.current.off("click.e1 tap.e1 touch.e1"),e.tmp_route_details.current.line&&e.tmp_route_details.current.line.off("click.e1 tap.e1 touch.e1")},ce=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?Object.values(e.icon_list.current).forEach((function(e){e.on("click.e1 tap.e1 touch.e1",ie)})):Object.values(e.icon_list.current).forEach((function(e){e.off("click.e1 tap.e1 touch.e1")}))},ie=function(t){var n=t.target.attrs.id,r=e.icon_name.current[n].attrs.text;E.current?(I.current=n,p.current||(p.current=!0),m(r),e.unhighlight_stations(),D.current&&(e.unhighlight_stations(),e.highlight_stations(D.current,"skyblue")),e.highlight_stations(n,"aquamarine")):(D.current=n,i(r),!p.current&&se(),e.unhighlight_stations(),I.current&&(e.unhighlight_stations(),e.highlight_stations(I.current,"aquamarine")),e.highlight_stations(n,"skyblue"))},ue=function(){var t,n;null!==D.current&&null!==I.current&&(e.tmp_route_details.current.to_station=I.current,e.tmp_route_details.current.from_station=D.current,t=D.current,n=I.current);var r=!1;return t&&n&&(t!==n?r=!0:alert("select two different stations to add a route")),r},se=function(){E.current=!0,C("to")};Object(a.useEffect)((function(){return We({route_ref:e.route_ref.current,show:!0}),Object(_e.a)(fe.a.mark((function t(){return fe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.route_toggle_ref.current=!1,Te(),ce(!1),Le(),e.unhighlight_stations(),We({route_ref:e.route_ref.current,show:!1}),W.current&&(G(W.current),W.current=null);case 7:case"end":return t.stop()}}),t)})))}),[]),Object(a.useEffect)((function(){return e.unhighlight_stations(),"edit_route"===h?ce(!1):"add_route"===h?(ce(),le()):ce(!1),function(){e.is_mounted.current&&le()}}),[h,e.saved_route_loaded]),Object(a.useEffect)((function(){return"edit_route"!==h&&(e.route_toggle_ref.current=!1,Te(),e.route_toggle_button_on(),e.route_toggle_button_ref.current.style.display="none"),function(){e.is_mounted.current&&e.route_toggle_button_on(),e.is_mounted.current&&(e.route_toggle_button_ref.current.style.display="none")}}),[h]);var le=function(){Object.values(e.route_ref.current).forEach((function(e){e.line&&e.line.children[1]&&e.line.children[1].off("click.e1 tap.e1 touch.e1")}))},pe=function(t){t=parseInt(t),Je(t),Object.values(e.route_ref.current).some((function(n){if(parseInt(n.route_id)===t)return i(e.icon_name.current[n.from_station].attrs.text),e.highlight_stations(n.from_station,"skyblue"),m(e.icon_name.current[n.to_station].attrs.text),e.highlight_stations(n.to_station,"aquamarine"),!0}))},he=function(t,n){var r,a=[e.station_coord.current[e.tmp_route_details.current.from_station].x,e.station_coord.current[e.tmp_route_details.current.from_station].y],o=e.tmp_route_details.current.node,c=e.tmp_node_details.current,i=0,u=0,s=Object(Qe.a)(o);try{for(s.s();!(r=s.n()).done;){var d=r.value;if(c[d].post_process)a=a.concat([c[d].x,c[d].y]),u+=1;else{i=o.indexOf(d)-u,i*=4;for(var m=e.tmp_cp_details.current.slice(i,i+4),p=0;p<m.length;p+=2){var f=e.get_untransformed_coordinates(m[p],m[p+1]),_=Object(l.a)(f,2);m[p]=_[0],m[p+1]=_[1]}a=a.concat(m)}}}catch(w){s.e(w)}finally{s.f()}a=a.concat([e.station_coord.current[e.tmp_route_details.current.to_station].x,e.station_coord.current[e.tmp_route_details.current.to_station].y]);for(var h,b={},g=1/0,v=u>0?2:4,y=0;y<=a.length-v;y+=v)He(t,n,a[y],a[y+1],a[y+2],a[y+3])&&(b[y]={x:t,y:n,x1:a[y],y1:a[y+1],x2:a[y+2],y2:a[y+3]});return(h=Object.keys(b)).length>1?g=parseInt(ye(b)):1===h.length&&(g=parseInt(h[0])),Math.floor((g+2)/4)},be=function(){return z.current=e.line.current,!!e.line.current},ye=function(e){var t,n,r=null,a=null;for(var o in e){var c=e[o],i=c.x,u=c.y,s=c.x1,l=c.y1,d=c.x2,m=c.y2;t=o,n=Ve(s,l,i,u)+Ve(i,u,d,m)-Ve(s,l,d,m),a?n<a&&(a=n,r=t):(a=n,r=t)}return r};function we(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"red",n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=e.get_untransformed_coordinates(n,r),i=Object(l.a)(c,2),u=i[0],s=i[1],d=he(u,s);if(o&&!isFinite(d))return alert("Selected point should be on the route"),!1;var m=e.get_id(),p=e.get_circle(m,t,n,r,5,!o),f=null;return e.stage.current&&(e.tmp_node_details.current[m]={x:u,y:s,node:p,post_process:o,node_id:m,route_id:e.tmp_route_details.current.route_id},"node"in e.tmp_route_details.current?a?(d=he(u,s),e.tmp_route_details.current.node.splice(d,0,m)):e.tmp_route_details.current.node.push(m):e.tmp_route_details.current.node=[m],Z(p,o),e.layer.current.add(p),e.layer.current.batchDraw()),{tmp_station_name:f}}var je=function(){if(""!==e.tmp_route_details.current.to_station&&""!==e.tmp_route_details.current.from_station)return e.tmp_route_details.current.from_station>-1&&e.tmp_route_details.current.to_station>-1},ke=function(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"orange",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e.line.current&&(we(a,t,n,r,o),o||(e.remove_control_points(),Ue(),$(e.check_valid_route())),o||(e.remove_control_points(),Ue(!1)),e.reset_zindex(),Oe())},Oe=function(){Object.values(e.route_ref.current).forEach((function(e){e.line.children[1].on("click.e1 tap.e1 touch.e1",(function(){return pe(e.route_id,!0)}))}))},Ee=function(t,n,r){var a=[e.route_ref.current[t].from_station,e.route_ref.current[t].to_station],o=a[0],c=a[1];return parseInt(n)===parseInt(o)&&parseInt(r)===parseInt(c)},Ne=function(t,n){var r=!1;if(Object.keys(e.route_ref.current).length>0)for(var a in e.route_ref.current)if(Ee(a,t,n)){r=!0;break}return r},Se=function(){var t,n=e.tmp_route_details.current.from_station,r=e.tmp_route_details.current.to_station,a=[];if(Object.keys(e.route_ref.current).length>0)for(var o in e.route_ref.current)if(Ee(o,r,n)){a=e.route_ref.current[o];break}var c=a.node||[],i=a.radius||1.5,u=a.direction||"forward";for(Ce(i,u),t=c.length-1;t>=0;t--){var s=c[t],d=e.node_ref.current[s],m=e.get_transformed_coordinates(d.x,d.y),p=Object(l.a)(m,2),f=p[0],_=p[1];ke(f,_,!0)}},Ce=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"forward";e.tmp_route_details.current.node=[],e.tmp_route_details.current.radius=t,e.tmp_route_details.current.direction=n,e.line.current=e.draw_route();var r=Te(!1);g("edit_route"),pe(r)},Re=function(){var t=Object(_e.a)(fe.a.mark((function t(){return fe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ue()){t.next=19;break}if(Ne(e.tmp_route_details.current.from_station,e.tmp_route_details.current.to_station)){t.next=16;break}if(!je()){t.next=13;break}if(!Ne(e.tmp_route_details.current.to_station,e.tmp_route_details.current.from_station)){t.next=10;break}return W.current&&(G(W.current),W.current=null),t.next=7,Y({message:"You have already added a route from ".concat(e.tmp_route_details.current.to_station," to ").concat(e.tmp_route_details.current.from_station,"\n              \n click here to mirror the route or cancel to draw a default route"),status:"info",on_click:Se,on_cancel:Ce});case 7:W.current=t.sent,t.next=11;break;case 10:Ce();case 11:t.next=14;break;case 13:alert("select two stations");case 14:t.next=19;break;case 16:alert("route already present!!!"),Le(),e.unhighlight_stations();case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ie=function(){return o.a.createElement("select",{className:"routes-drop-down",onChange:function(e){return Be(e.target.value)},value:""==c&&""==d?-99:R.current},o.a.createElement("option",{value:-99}),Object.entries(e.route_ref.current).map((function(t){var n=Object(l.a)(t,2),r=n[0],a=n[1];return o.a.createElement("option",{value:a.route_id,key:r}," ","".concat(e.icon_name.current[a.from_station].attrs.text,"->").concat(e.icon_name.current[a.to_station].attrs.text))})))},De=function(){e.tmp_route_details.current&&e.tmp_route_details.current.node&&e.tmp_route_details.current.node.forEach((function(t){e.tmp_node_details.current[t].node&&e.tmp_node_details.current[t].node.destroy(),e.layer.current.batchDraw()}))},Fe=function(){var t=Object(l.a)(e.line.current.children,2),n=t[0];t[1];n&&(n.stroke("black"),n.strokeWidth(2))},Ae=function(){var t=e.tmp_route_details.current.route_id;e.remove_control_points(),De(),e.line.current&&e.line.current.destroy(),e.remove_invalid_turns(),z.current=null,e.tmp_route_details.current.node=Object(ge.cloneDeep)(e.reference_route_ref.current.node),e.tmp_route_details.current.radius=e.reference_route_ref.current.radius,e.reference_route_ref.current.node.forEach((function(t){var n=e.reference_route_ref.current.node_ref[t];t in e.tmp_node_details.current?(e.tmp_node_details.current[t].x=n.x,e.tmp_node_details.current[t].y=n.y):e.tmp_node_details.current[t]=Object(ge.cloneDeep)(n)}));var n=e.reference_route_ref.current.invalid_route;e.tmp_route_details.current.invalid_route=n,e.route_ref.current[t].line=e.draw_route(!1),e.line.current=e.route_ref.current[t].line,Je(Te(!1)),e.highlight_stations(e.tmp_route_details.current.from_station,"skyblue"),e.highlight_stations(e.tmp_route_details.current.to_station,"aquamarine"),e.layer.current.batchDraw()},Te=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e.line.current){var n=Pe();return e.line.current.route_id=n,e.save_temp_route(n),e.remove_control_points(),Fe(),De(),e.layer.current.batchDraw(),oe(),e.set_add_delete_mode(null),e.unhighlight_stations(),e.reset_tmp_route_node_path(),e.set_route_added((function(e){return e+1})),w(null),O(""),t&&Le(),null!==e.reference_route_ref.current&&e.reference_route_ref.current.line.destroy(),e.reference_route_ref.current=null,e.redraw_all_routes(!e.route_toggle_ref.current),e.reset_zindex(),n}},Le=function(){i(""),m(""),I.current=null,D.current=null,R.current=null,E.current=!1,p.current=!1},Pe=function(){return"route_id"in e.tmp_route_details.current?e.tmp_route_details.current.route_id:e.get_id()},qe=function(){Object.entries(e.tmp_node_details.current).forEach((function(t){var n=Object(l.a)(t,2),r=n[0],a=n[1],o=e.get_transformed_coordinates(e.node_ref.current[r].x,e.node_ref.current[r].y),c=Object(l.a)(o,2),i=c[0],u=c[1],s=e.get_circle(r,a.post_process?"cyan":"orange",i,u,5,!a.post_process);e.tmp_node_details.current[r].node=s,Z(s,a.post_process),e.layer.current.add(s)}))},Be=function(t){t>=0?(i(e.icon_name.current[e.route_ref.current[t].from_station].attrs.text),m(e.icon_name.current[e.route_ref.current[t].to_station].attrs.text),pe(t)):(i(""),m(""),Te()),e.set_add_delete_mode(null)},Je=function(){var t=Object(_e.a)(fe.a.mark((function t(){var n,r,a,o=arguments;return fe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=o.length>0&&void 0!==o[0]?o[0]:null,e.unhighlight_stations(),Te(!1),n>=0&&(De(),e.load_temp_route(n),qe(),e.draw_control_points(),e.line.current=e.tmp_route_details.current.line,e.reference_route_ref.current=Object(ge.cloneDeep)(e.tmp_route_details.current),r=Object(ge.cloneDeep)(e.node_ref.current),a={},e.reference_route_ref.current.node.forEach((function(e){a[parseInt(e)]=r[e]})),e.reference_route_ref.current.node_ref=a,e.reference_route_ref.current.line=e.draw_route(!1,!0),e.redraw_all_routes(!e.route_toggle_ref.current),w(e.tmp_route_details.current.path),O(e.tmp_route_details.current.radius),R.current=n,e.reset_zindex());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ue=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e.tmp_route_details.current.route_id;e.line.current&&e.line.current.destroy(),t&&e.remove_invalid_turns(),n in e.route_ref.current&&"line"in e.route_ref.current[n]&&(e.line.current=e.draw_route(),e.route_ref.current[n].line=e.line.current,ee(e.line.current,n))},Ye=function(){Object.values(e.tmp_node_details.current).forEach((function(e){e.node&&e.node.off("click.e1 tap.e1 touch.e1")}))},Ge=function(){0!==Object.keys(e.tmp_node_details.current).length?Object.entries(e.tmp_node_details.current).forEach((function(t){var n=Object(l.a)(t,2),r=n[0],a=n[1];"node"in a&&a.node.on("click.e1 tap.e1 touch.e1",(function(t){a.post_process?(a.node.destroy(),et(e.route_ref.current,e.tmp_route_details.current,e.node_ref.current,e.tmp_node_details.current,r),e.layer.current.batchDraw(),e.set_add_delete_mode(null)):function(t){e.tmp_node_details.current[t].node.destroy(),e.remove_control_points(),nt(e.route_ref.current,e.tmp_route_details.current,e.node_ref.current,e.tmp_node_details.current,t);var n=et(e.route_ref.current,e.tmp_route_details.current,e.node_ref.current,e.tmp_node_details.current,t),r=Object(l.a)(n,4);e.route_ref.current=r[0],e.tmp_route_details.current=r[1],e.node_ref.current=r[2],e.tmp_node_details.current=r[3],Ue(),Oe(),$(e.check_valid_route()),e.remove_control_points(),Ue(!1),e.reset_zindex(),e.set_add_delete_mode(null)}(r)}))})):alert("no nodes present")},Xe=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"orange",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.target.getStage(),o=a.getPointerPosition();ke(o.x,o.y,!0,n,r),e.set_add_delete_mode(null)},Ke=function(t){t.color;var n=t.post_process,r=void 0!==n&&n;if(r&&function(){var t=!1;return e.tmp_node_details.current&&Object.values(e.tmp_node_details.current).some((function(e){return t=e.post_process})),t}())return alert("Route already has a trollery hitch/drop point"),!1;e.tmp_route_details.current.line?r?e.set_add_delete_mode("post_process"):e.set_add_delete_mode("add"):alert("please select a route")},Ze=function(e){"from"===e.target.id?(E.current=!1,C("from")):"to"===e.target.id&&(E.current=!0,C("to"))},$e=function(){var t=function(){return Object.keys(e.station_coord.current).map((function(t,n){return o.a.createElement("option",{key:n,value:t},e.station_coord.current[t].name)}))},n=function(){var t;return Object.keys(e.station_coord.current).every((function(n){var r=e.station_coord.current[n];return!r.common_dispatch_station||(t=Object(me.a)(Object(me.a)({},r),{},{id:n}),!1)})),t},r=function(){var t;return Object.keys(e.station_coord.current).every((function(n){var r=e.station_coord.current[n];return!r.empty_trolley_station||(t=Object(me.a)(Object(me.a)({},r),{},{id:n}),!1)})),t},a=n(),c=r();return o.a.createElement("div",{className:"input-form"},o.a.createElement("h4",{style:{color:"#01051B",textAlign:"center"}},"Utilities"),o.a.createElement("section",{className:"commom-dispatch-container"},o.a.createElement("label",{className:"select-route-dropdown-label"},"Trip Type"),o.a.createElement("select",{defaultValue:"default",className:"routes-drop-down",onChange:function(e){var t=e.target.value;t&&(J.current=t)}},o.a.createElement("option",{value:"default",disabled:!0},"Default trip type: ".concat(e.trip_type)),B.current.map((function(e,t){return o.a.createElement("option",{key:t,value:e},e)})))),o.a.createElement("section",{className:"commom-dispatch-container"},o.a.createElement("label",{className:"select-route-dropdown-label"},"Common dispatch station"),o.a.createElement("select",{defaultValue:"default",className:"routes-drop-down",onChange:function(t){var r=t.target.value;r&&function(t){var r=n();r&&delete e.station_coord.current[r.id].common_dispatch_station,e.station_coord.current[t].common_dispatch_station=!0}(r)}},o.a.createElement("option",{value:"default",disabled:!0},a?a.name:"Please select a common dispatch station"),t())),o.a.createElement("section",{className:"commom-dispatch-container"},o.a.createElement("label",{className:"select-route-dropdown-label"},"empty trolley station"),o.a.createElement("select",{defaultValue:"default",className:"routes-drop-down",onChange:function(t){var n=t.target.value;n&&function(t){var n=r();n&&delete e.station_coord.current[n.id].empty_trolley_station,e.station_coord.current[t].empty_trolley_station=!0}(n)}},o.a.createElement("option",{value:"default",disabled:!0},c?c.name:"Please select a empty trolley station"),t())),it(),o.a.createElement(L,null,rt()))},tt=function(e){var t=e.target;H.current=Object(me.a)(Object(me.a)({},H.current),{},Object(de.a)({},t.dataset.file,t.checked))};Object(a.useEffect)((function(){}),[H]);var rt=function(){var e=["webui_map_json","waypoints_json","stations_csv","stations_attributes_json"].map((function(e,t){return o.a.createElement("section",{key:t},o.a.createElement("label",null,e),o.a.createElement("input",{"data-file":e,key:t,onChange:tt,type:"checkbox",defaultChecked:H.current[e]}))}));return o.a.createElement("div",{className:"download-modal"},e,o.a.createElement("button",{onClick:function(){at()}},"Download Files"))},at=function(){var e=ht();H.current.stations_csv&&vt(e,"stations.csv"),H.current.stations_attributes_json&&vt(JSON.stringify(ft()),"station_attributes.json"),H.current.webui_map_json&&vt(JSON.stringify(_t()),"webui_map.json"),H.current.waypoints_json&&vt(JSON.stringify(gt()),"waypoints.json"),M.current.disable=!1,q()},ct=function(){M.current.disable=!0,e.route_toggle_ref.current=!1,Te(),e.route_toggle_button_on(),function(){for(var t=Object.values(e.route_ref.current),n=0;n<t.length;n++)if(t[n].invalid_route)return!0;return!1}()?Y({message:"Invalid routes found!\n\n It is recommended to recheck the routes.\n\n Click here if you still want to download files.",status:"danger",on_click:P}):P()},it=function(){return o.a.createElement("button",{className:"map-editor-button",ref:M,onClick:ct},"Download Files")},ut=function(t){t.preventDefault();parseFloat(t.target.value);e.tmp_route_details.current.radius=parseFloat(t.target.value),O(t.target.value),e.remove_control_points(),Ue(),e.highlight_current_line(),e.set_add_delete_mode(null),e.reset_zindex()},st=function(t){var n=t.target.checked?"forward":"reverse";e.tmp_route_details.current.direction=n,w(n)},lt=function(){var t=o.a.createElement("small",null,"* please select a route first");return be()?(t=o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"form-checkbox-input"},o.a.createElement("input",{id:"forward",type:"checkbox",onChange:st,checked:"forward"===e.tmp_route_details.current.direction})," ","Forward route"," "),o.a.createElement("section",{className:"form-checkbox-input"},"Curve Radius:",o.a.createElement("input",{className:"input-radius",onChange:ut,id:"path_radius",type:"number",value:e.tmp_route_details.current.radius||k,step:.01}),"metres"),o.a.createElement("div",{className:"add-delete-node-div"},o.a.createElement("label",null,"Click on a route to start adding nodes"),o.a.createElement("button",{className:"btn map-editor-button",onClick:function(){Ke({})},style:"add"===e.add_delete_mode?{background:"cyan",color:"#000"}:{}},"Add Node")),o.a.createElement("div",{className:"add-delete-node-div"},o.a.createElement("label",null,"Add Trolley hitch/release point"),o.a.createElement("button",{className:"btn map-editor-button",onClick:function(){Ke({color:"cyan",post_process:!0})},style:"post_process"===e.add_delete_mode?{background:"cyan",color:"#000"}:{}},"Add Pause")),o.a.createElement("div",{className:"add-delete-node-div"},o.a.createElement("button",{className:"btn map-editor-button",onClick:function(){e.set_add_delete_mode("delete")},style:"delete"===e.add_delete_mode?{background:"indianred",color:"#000"}:{}}," ","Remove Node/Pause")),o.a.createElement("div",{className:"add-delete-node-div"},o.a.createElement("label",{style:{textAlign:"center"}},"Click to reset path"),o.a.createElement("button",{className:"btn map-editor-button",onClick:Ae},"Reset Path")),o.a.createElement("div",{className:"input-form-button-div"},o.a.createElement("button",{className:"btn map-editor-button",onClick:function(){e.route_toggle_ref.current=!1,Te()}}," ","Done"))),e.route_toggle_button_ref.current.style.display="block"):e.route_toggle_button_ref.current.style.display="none",o.a.createElement("div",{className:"input-form"},o.a.createElement("div",{className:"edit-route-input"},o.a.createElement("label",{className:"select-route-dropdown-label"},"Select a route to edit"),Ie(),o.a.createElement("label",{className:"route-selection-choice"},"Or"),o.a.createElement("label",{className:"edit-route-input-label"},"Click on a route to start editing it"),o.a.createElement("input",{readOnly:!0,type:"text",className:"edit-route-input-select edit-route-input-select-from",placeholder:"From",value:c}),o.a.createElement("img",{src:pt.a}),o.a.createElement("input",{readOnly:!0,type:"text",className:"edit-route-input-select edit-route-input-select-to",placeholder:"To",value:d})),t)},mt=function(){return o.a.createElement("div",{className:"input-form"},Ie(),"delete_route"===e.add_delete_mode?o.a.createElement("small",null,"* click on a route to delete"):be()?o.a.createElement("small",null,"* click on delete route button to delete highlighted route"):o.a.createElement("small",null,"* click on delete mode button to activate delete mode"),o.a.createElement("button",{className:"map-editor-button",onClick:function(){be()&&function(t){var n=e.route_ref.current[t],r=[n.from_station,n.to_station];n.line.children[1].off("click.e1 tap.e1 touch.e1"),window.confirm("Are you sure to delete the selected route:'\n    ".concat(e.station_coord.current[r[0]].name," -> ").concat(e.station_coord.current[r[1]].name))&&n.route_id>=0?(i(""),m(""),e.delete_path(n.route_id),null!==e.reference_route_ref.current&&e.reference_route_ref.current.line.destroy(),e.reference_route_ref.current=null,e.remove_invalid_turns(),e.unhighlight_stations(),e.set_add_delete_mode(null)):(e.remove_path_event_listeners(),e.set_add_delete_mode(null))}(e.tmp_route_details.current.route_id)},style:"delete_route"===e.add_delete_mode?{background:"cyan"}:{}},"Delete Selected Route"))},ft=function(){var t={};return Object.keys(e.station_coord.current).forEach((function(e){t[String(V[e])]=[-1,-1,-1,parseInt(e)]})),t},_t=function(){var t,n,r=[],a={file_name:"webui_map.png",scale:e.scale,size:e.size,origin:e.origin,viewbox:"0 0 ".concat(e.size.x," ").concat(e.size.y)};Object.keys(e.station_coord.current).forEach((function(a,o){var c=e.station_coord.current[a],i=e.get_map_coordinate(c.x,c.y),u=Object(l.a)(i,2),s=u[0],d=u[1],m=Me(c.rotation),p=c.name,f=c.charging,_=void 0!==c.hidden&&c.hidden,h=void 0!==c.station_tags?c.station_tags[0].split(","):[];c.common_dispatch_station&&(t=V[parseInt(a)]),c.empty_trolley_station&&(n=V[parseInt(a)]);var b={id:V[parseInt(a)],name:p,x:s,y:d,theta:m};if(f&&(b.isCharging=f),b.hidden=_,1===h.length&&""===h[0]&&(h=[]),h.length>1){var g=h.map((function(e){return/^\s/.test(t=e)?t.replace(/\s+$/g,""):t;var t}));h=g}h&&(b.station_tags=h),r.push(b)})),F.current=r;var o={map_name:e.map_name,trip_type:J.current?J.current:e.trip_type,maps:{0:a},stations:r};return t&&(o.common_dispatch_station=t),n&&(o.empty_trolley_station=n),o},ht=function(){var t="x,y,theta\n",n=1;return Object.keys(e.station_coord.current).forEach((function(r){var a=e.station_coord.current[r];V[r]=n;var o=e.get_map_coordinate(a.x,a.y),c=Object(l.a)(o,2),i=c[0],u=c[1];t+="".concat(i,",").concat(u,",").concat(Me(a.rotation),"\n"),n+=1})),t},bt=function(){var t=[];return Object.values(e.route_ref.current).forEach((function(n){var r,a,o=[],c=[],i=[],u=!1,s=[V[parseInt(n.from_station)],V[parseInt(n.to_station)]];if(o.push(s),i=function(t){var n=[],r=[],a=e.route_ref.current[t];if(t>=0){r.push(e.get_map_coordinate(e.station_coord.current[a.from_station].x,e.station_coord.current[a.from_station].y));var o,c=Object(Qe.a)(a.node);try{for(c.s();!(o=c.n()).done;){var i=o.value;r.push(e.get_map_coordinate(e.node_ref.current[i].x,e.node_ref.current[i].y)),e.node_ref.current[i].post_process&&(n.push(r),r=r.slice(-1))}}catch(u){c.e(u)}finally{c.f()}r.push(e.get_map_coordinate(e.station_coord.current[a.to_station].x,e.station_coord.current[a.to_station].y))}return n.push(r),n}(n.route_id),"reverse"===n.direction||e.station_coord.current[n.from_station].inplace){var l=dt(i[0].slice(0,2),e.station_coord.current[n.from_station].rotation,!parseInt(e.station_coord.current[n.from_station].clockwise),n.direction,!0);l&&c.push(l)}for(var d in i)r=new ve.a(i[d]),a=ze(xe(r,n.radius)),d>0?(c.push("post_process"),c.push([[n.direction,a]]),u=!0):(c.push([n.direction,a]),u=!1);if("reverse"===n.direction||e.station_coord.current[n.to_station].inplace){var m=dt(i.slice(-1)[0].slice(-2),e.station_coord.current[n.to_station].rotation,parseInt(e.station_coord.current[n.to_station].clockwise),n.direction);m&&(u?c.slice(-1)[0].push(m):e.station_coord.current[n.to_station].post_process?c.push("post_process",[m]):c.push(m))}o.push(c),t.push(o)})),t},gt=function(){var t={},n=[];Object.values(e.station_coord.current).forEach((function(e){n.push([e.x,e.y,Me(e.rotation)])}));for(var a=[],o=bt(),c=0,i=n;c<i.length;c++){var u=i[c],s=e.get_map_coordinate(u[0],u[1]);a.push([].concat(Object(r.a)(s),[u[2]]))}var d=Object(ge.cloneDeep)(e.route_ref.current),m={};Object.entries(e.route_ref.current).map((function(e){return m[e[0]]={from_station:V[parseInt(e[1].from_station)],to_station:V[parseInt(e[1].to_station)],route_id:e[1].route_id,radius:e[1].radius,node:e[1].node,invalid_route:e[1].invalid_route,direction:e[1].direction}})),Object.values(d).forEach((function(e){"line"in e&&delete d[e.route_id].line,"cp_ref"in e&&delete d[e.route_id].cp_ref}));var p=Object(ge.cloneDeep)(e.station_coord.current);Object.keys(p).forEach((function(t){var n=e.get_map_coordinate(p[t].x,p[t].y),r=Object(l.a)(n,2),a=r[0],o=r[1];p[t].x=a,p[t].y=o}));var f=Object(ge.cloneDeep)(e.node_ref.current);Object.keys(f).forEach((function(t){var n=e.get_map_coordinate(f[t].x,f[t].y),r=Object(l.a)(n,2),a=r[0],o=r[1];f[t].x=a,f[t].y=o})),t.stations=a,t.routes=ot(o);for(var _=Object(ge.cloneDeep)(p),h={},b=function(){var e=Object(l.a)(v[g],2),t=(e[0],e[1]);F.current.forEach((function(e){var n=e.id;t.name===e.name&&(h[n]=Object(me.a)(Object(me.a)({},t),{},{station_tags:e.station_tags,hidden:e.hidden}))}))},g=0,v=Object.entries(_);g<v.length;g++)b();return t.map_editor={map_data:{scale:e.scale,size:e.size,origin:e.origin},ver:2,stations:h,routes:m,nodes:Object(ge.cloneDeep)(f)},t},vt=function(e,t){var n=document.createElement("a"),r=new Blob([e],{type:"text/plain;charset=utf-8"});n.href=URL.createObjectURL(r),n.download=t,document.body.appendChild(n),n.click()},yt=ae({url:"".concat(b,"/map_editor/upload"),method:"post",on_error:function(e){Y({message:"Error occurred when uploading files!",status:"danger"})},on_success:function(e){var t=e.data;Y({message:t.message,status:"info"})}}),wt=Object(l.a)(yt,2),xt=(wt[0],wt[1],function(e){return o.a.createElement("button",{className:"edit-mode-button",onClick:function(){g(e)}},o.a.createElement("span",{className:"text-capitalize"},e.split("_").join(" ")))});return o.a.createElement("div",{className:"map-side-column"},function(){switch(h){case"add_route":return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"input-form"},o.a.createElement("section",{className:"add-route-station-input-section"},o.a.createElement("label",null,"Click the station in map begin the route."),o.a.createElement("input",{readOnly:!0,type:"text",className:"add-route-station-input-from",id:"from",value:c,onClick:Ze,placeholder:"From",style:E.current?{}:{background:"skyblue"}}),o.a.createElement("label",null,"Click the station to end route."),o.a.createElement("input",{readOnly:!0,type:"text",className:"add-route-station-input-to",id:"to",value:d,onClick:Ze,placeholder:"To",style:E.current?{background:"aquamarine"}:{}})),o.a.createElement("button",{className:"map-editor-button",onClick:Re},"Add Route")),xt("edit_route"),xt("delete_route"),$e());case"edit_route":return o.a.createElement(o.a.Fragment,null,xt("add_route"),lt(),xt("delete_route"),$e());case"delete_route":return o.a.createElement(o.a.Fragment,null,xt("add_route"),xt("edit_route"),mt(),$e())}}())};n(324);var _t=function(e){var t,n=e.origin,c=e.scale,i=e.size,u=Object(a.useRef)({x:0,y:0}),s=e.image,d=Object(a.useRef)({x:0,y:0}),m=Object(a.useRef)(0),p=Object(a.useRef)(!1),f=Object(a.useRef)({x:0,y:0,rotation:0,scale:1}),_=600/i.y,h=Object(a.useRef)({}),b=Object(a.useRef)({}),g=Object(a.useRef)({}),v=Object(a.useRef)([]),y=Object(a.useRef)(null),w=Object(a.useState)(0),x=Object(l.a)(w,2),j=(x[0],x[1]),k=Object(a.useRef)(null),O=Object(a.useRef)(null),E=Object(a.useState)(!1),N=Object(l.a)(E,2),S=N[0],C=N[1],R=Object(a.useState)("Align Map"),M=Object(l.a)(R,2),I=M[0],D=M[1],z=Object(a.useRef)(null),F=Object(a.useState)(null),A=Object(l.a)(F,2),T=A[0],L=A[1],P=Object(a.useRef)(null),q=Object(a.useRef)(null),H=Object(a.useRef)([]),V=Object(a.useRef)([]),W=Object(a.useState)(!0),B=Object(l.a)(W,2),J=B[0],U=B[1],Y=Object(a.useRef)(null),G=Object(a.useRef)(null),X=Object(a.useRef)(null),K=Object(a.useRef)({}),Q=Object(a.useRef)({}),Z=Object(a.useRef)({}),$=Object(a.useRef)({}),ee=Object(a.useRef)({}),te=Object(a.useRef)(0),ne=Object(a.useRef)(null),re=Object(a.useRef)(null),ae=Object(a.useRef)(!1),oe=Object(a.useRef)(null),ce=Object(a.useRef)([]),ie=Object(a.useRef)([]),ue=Object(a.useRef)(!1),se=function(e,t,n){return[e/n*_,t/n*_]},le=function(e){for(var t in e.stations){var n=e.stations[t];if(e.stage){var r=se(n.x,n.y,e.stage.scale),a=Object(l.a)(r,2),o=a[0],c=a[1];n.x=o,n.y=c}}for(var i in e.nodes){var u=e.nodes[i];if(e.stage){var s=se(u.x,u.y,e.stage.scale),d=Object(l.a)(s,2),m=d[0],p=d[1];u.x=m,u.y=p}}if(e.map_corner){var f=se(e.map_corner[0],e.map_corner[1],e.stage.scale),_=Object(l.a)(f,2),h=_[0],b=_[1];e.map_corner=[h,b]}},pe=function(e){for(var t in e.stations){var n=e.stations[t],r=De(n.x,n.y),a=Object(l.a)(r,2),o=a[0],c=a[1];n.x=o,n.y=c}for(var i in e.nodes){var u=e.nodes[i],s=De(u.x,u.y),d=Object(l.a)(s,2),m=d[0],p=d[1];u.x=m,u.y=p}if(e.map_corner){var f=se(e.map_corner[0],e.map_corner[1],e.stage.scale),_=Object(l.a)(f,2),h=_[0],b=_[1];e.map_corner=[h,b]}},he=function(e){!function(e){2===e.ver?pe(e):le(e)}(e),e.map_corner&&void 0!==e.map_rotation&&(Object.values(e.stations).forEach((function(t){var n=t.x-e.map_corner[0],r=t.y-e.map_corner[1],a=qe(n,r,-(e.map_rotation*Math.PI/180)),o=Object(l.a)(a,2);n=o[0],r=o[1],t.x=n,t.y=r})),Object.values(e.nodes).forEach((function(t){var n=t.x-e.map_corner[0],r=t.y-e.map_corner[1],a=qe(n,r,-(e.map_rotation*Math.PI/180)),o=Object(l.a)(a,2);n=o[0],r=o[1],t.x=n,t.y=r}))),K.current=Object(ge.cloneDeep)(e.stations),$.current=Object(ge.cloneDeep)(e.nodes),ee.current=Object(ge.cloneDeep)(e.routes);var t=Object.keys(ee.current);te.current=t.length>0?parseInt(t.slice(-1)[0])+1:1,Object.keys(ee.current).forEach((function(e){yt(e),ee.current[e].line=Ot(!1),Et(e)})),We({route_ref:ee.current,show:!1}),Ft(),D("Station")};Object(a.useEffect)((function(){return p.current=!0,function(){p.current=!1}}),[]),Object(a.useEffect)((function(){var t=!0;return S||(k.current=new be.a.Stage({container:"konva-div",width:z.current.offsetWidth-40,height:z.current.offsetHeight-40}),O.current=new be.a.Stage({container:"konva-div-ruler",width:z.current.offsetWidth,height:z.current.offsetHeight}),t&&function(){Y.current=new be.a.Layer,G.current=new be.a.Layer;var t=new Image;t.src=s,t.onload=function(){X.current=new be.a.Image({x:f.current.x,y:f.current.y,image:t,width:i.x*_,height:i.y*_,offset:{x:0,y:0},draggable:!1,rotation:f.current.rotation}),X.current.on("tap.event1",et),X.current.on("mousemove",$e),X.current.on("mouseleave",et),Y.current.add(X.current),O.current.add(G.current),k.current.add(Y.current),Ve(!0),Y.current.draw(),oe.current.style.display="none",X.current&&mt(),X.current&&lt(),C(!0),e.waypoints_data?he(e.waypoints_data):Wt()}}()),function(){return t=!1}}),[z.current,S]);var ye=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=(e/_-n.x)/c.x,o=(t/_-n.y)/c.y;return Re([a,o],r)},we=function(e,t){var n,r=X.current.attrs.rotation*Math.PI/180,a=X.current.scaleX();return(n=qe((n=Pe(e,t,X.current.attrs.x,X.current.attrs.y))[0],n[1],-r))[0]=n[0]/a,n[1]=n[1]/a,n},je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Math.abs(k.current.width()-e)>k.current.width()-100?Ie("left",n):Math.abs(k.current.width()-e)<100?Ie("right",n):Math.abs(k.current.height()-t)<100?Ie("down",n):Ie("up",n)},ke=function(e){var t={};return Object.keys(e).forEach((function(n){t[n]=e[n].node})),t},Oe=function(e,t){return Object.keys(e).forEach((function(n){n in t&&(t[n].node=e[n])})),t},Ee=function(){b.current&&b.current.node&&(b.current.node.forEach((function(e){var t=g.current[e],n=Ae(t.x,t.y),r=Object(l.a)(n,2),a=r[0],o=r[1];t.node.x(a),t.node.y(o)})),Y.current.batchDraw())},Se=function(){ie.current&&(ie.current.forEach((function(e){e.destroy()})),ie.current=[])},Ce=function(){var e,t,n,r,a,o,c=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Se(),b.current&&Object.keys(b.current).length>0&&(e=Object(ge.cloneDeep)(b.current),r=b.current.route_id,o=ke(g.current||{}),t=Object(ge.cloneDeep)(g.current),n=v.current,Dt()),Object.keys(ee.current).forEach((function(i){Ft(),yt(i,!0),b.current.line&&b.current.line.destroy(),parseInt(r)===parseInt(i)&&(b.current=e,g.current=Oe(o,t),v.current=n);var u=Ot(parseInt(r)===parseInt(i));parseInt(r)===parseInt(i)&&(a=u,pt()),ee.current[i].line=u,y.current=u,y.current.children[1].hide(),c||parseInt(i)===parseInt(r)||y.current.children[0].hide(),Et(i)})),ne.current){var i=jt(!0),u=Object(l.a)(ne.current.line.children,2),s=u[0],d=u[1];s.points(i),d.points(i)}Ft(),e&&(b.current=e,b.current.line=a,y.current=a,g.current=Oe(o,t),v.current=n,Ee()),y.current&&Me()},Me=function(){var e=Object(l.a)(y.current.children,2),t=e[0],n=e[1];t&&(t.stroke("red"),t.strokeWidth(5)),n&&n.hide()},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];P.current&&("right"===e||"left"===e?(P.current.children[0].pointerWidth(35),P.current.children[0].pointerHeight(t?0:3)):(P.current.children[0].pointerWidth(t?0:3),P.current.children[0].pointerHeight(35)),P.current.children[0].pointerDirection(e))},De=function(e,t){return[(e*c.x+n.x)*_,(t*c.y+n.y)*_]},Ae=function(e,t){var n,r=X.current.attrs.rotation*Math.PI/180;return e=(n=qe(e*=X.current.scaleX(),t*=X.current.scaleX(),r))[0],t=n[1],[e+=X.current.x(),t+=X.current.y()]},He=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=X.current.attrs.rotation*Math.PI/180,o=O.current.height(),c=O.current.width();if(t){var i=r?e-o*Math.tan(a):e+c*Math.tan(a),u=r?[e,0,i,o]:[0,e,c,i],s=new be.a.Line({points:u,stroke:r?"black":"#787878",strokeWidth:n,lineCap:"round",opacity:.5});Y.current.add(s),H.current.push(s)}var l=r?e-o*Math.tan(a):0,d=r?o:e,m=Ze(l,d,1);r?(l+=20,d-=40/1.5):d-=20;var p=new be.a.Text({text:r?m[0]:m[1],x:l,y:d,align:"right",width:40,padding:5,fontFamily:"Calibri",fontSize:12,fill:r?"black":"#787878",drawBorder:!0});G.current.add(p),V.current.push(p),Y.current.batchDraw(),G.current.batchDraw()},Ve=function(){var e,t,n,r,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=parseInt(k.current.attrs.height),c=parseInt(k.current.attrs.width),i=X.current.attrs.rotation*Math.PI/180,u=50/Math.abs(Math.cos(i)),s=c-o*Math.tan(i),l=o+c*Math.tan(i);for(l<o?(e=o+(o-l),n=0):(e=o,n=o-l),s<c?(t=c+(c-s),r=0):(t=c,r=c-s);n<e;)He(n,a),n+=u;for(;r<t;)He(r,a,.5,!0),r+=u},Be=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&H.current.forEach((function(e){e.destroy()})),V.current.forEach((function(e){e.destroy()})),Y.current.batchDraw(),G.current.batchDraw(),e&&(H.current=[]),V.current=[]},Je=function(e){J?(Be(),U(!1)):(Ve(!0),U(!0))},Ue=function(e,t){P.current=new be.a.Label({x:e,y:t,opacity:.75}),P.current.add(new be.a.Tag({fill:"black",pointerDirection:"up",pointerWidth:3,pointerHeight:35,lineJoin:"round"})),P.current.add(new be.a.Text({text:"",fontFamily:"Calibri",fontSize:18,padding:5,fill:"white"})),Y.current.add(P.current)},Ye=function(e){if(P.current){var t=Object(l.a)(P.current.children,2);t[0];t[1].text(e)}},Ge=function(e){var t=e.target.getStage().getPointerPosition();if(P.current){Qe(t.x,t.y);var n=Ze(t.x,t.y),r=Object(l.a)(n,2),a=r[0],o=r[1];Ye("x:".concat(a,",y:").concat(o)),P.current.show(),Y.current.batchDraw()}else{Ue(t.x,t.y);var c=Ze(t.x,t.y),i=Object(l.a)(c,2),u=i[0],s=i[1];Ye("x:".concat(u,",y:").concat(s))}P.current.children[0].pointerWidth(0),je(t.x,t.y,!0)},Xe=function(e){var t=K.current[e],n=t.x,r=t.y,a=t.rotation;if(P.current){var o=Ae(n,r),c=Object(l.a)(o,2),i=c[0],u=c[1];Qe(i,u);var s=ye(n,r),d=Object(l.a)(s,2),m=d[0],p=d[1];Ye("x:".concat(m,",y:").concat(p,",angle:").concat(a)),P.current.show(),Y.current.batchDraw()}else{var f=Ae(n,r),_=Object(l.a)(f,2),h=_[0],b=_[1];Ue(h,b);var g=ye(n,r),v=Object(l.a)(g,2),y=v[0],w=v[1];Ye("x:".concat(y,",y:").concat(w,",angle:").concat(a))}P.current.children[0].pointerWidth(3)},Qe=function(e,t){P.current&&(P.current.x(e),P.current.y(t))},Ze=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=we(e,t),a=Object(l.a)(r,2),o=a[0],c=a[1],i=ye(o,c,n),u=Object(l.a)(i,2),s=u[0],d=u[1];return[s,d]},$e=function(e){var t=e.target.getStage().getPointerPosition();if(P.current){Qe(t.x,t.y);var n=Ze(t.x,t.y),r=Object(l.a)(n,2),a=r[0],o=r[1];Ye("x:".concat(a,",y:").concat(o)),P.current.show(),Y.current.batchDraw()}else{Ue(t.x,t.y);var c=Ze(t.x,t.y),i=Object(l.a)(c,2),u=i[0],s=i[1];Ye("x:".concat(u,",y:").concat(s))}P.current.children[0].pointerWidth(0),je(t.x,t.y,!0)},et=function(){P.current&&(P.current.hide(),Y.current.batchDraw())},tt=function(e){var t=Object(l.a)(Q.current[e].children,2),n=t[0],r=t[1];Q.current[e].on("dragmove.event1",(function(){Xe(e)})),n.on("mouseenter.event1 tap",(function(){Xe(e)})),n.on("mouseout.event1 dragend.event1",et),r.on("mouseenter.event1 tap",(function(){Xe(e)}))},nt=function(){return te.current+=1,te.current},at=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=r||k.current.width()/2,u=a||k.current.height()/2;return(t=new be.a.Circle({x:i,y:u,radius:o,fill:n,stroke:"black",strokeWidth:1,draggable:c,id:e})).on("mousemove",Ge),t},ot=function(){var e=v.current.length;if(e>=4){var t,n=0;for(b.current.cp_ref=[];n<e;)t=at(nt(),"green",v.current[n],v.current[n+1],2),Y.current.add(t),b.current.cp_ref.push(t),n+=2;return Y.current.batchDraw(),!0}return!1},ct=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];a?(t=new be.a.Arrow({points:e,fill:"yellow",stroke:"#EB8F8F",dashEnabled:!0,dash:[12,12],strokeWidth:5,lineCap:"round"}),n=new be.a.Arrow({points:e,fill:"yellow",stroke:r,strokeWidth:0,opacity:0,lineCap:"round"})):o?(t=new be.a.Line({points:e,fill:r,stroke:r,strokeWidth:30,lineCap:"round",tension:2,opacity:.3}),n=it(e)):(t=new be.a.Arrow({points:e,fill:"yellow",stroke:r,strokeWidth:2,lineCap:"round",dashEnabled:c,dash:[12,12]}),n=it(e));var i=new be.a.Group;return i.on("mousemove",Ge),i.add(t,n),Y.current.add(i),Y.current.batchDraw(),i},it=function(e){return new be.a.Line({points:e,fill:"purple",stroke:"purple",strokeWidth:25,opacity:0,lineCap:"round"})},ut=function(){var e=Object(_e.a)(fe.a.mark((function e(){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ce(!ae.current),b.current&&Object.keys(b.current).length>0&&(b.current&&b.current.node&&(b.current.node.forEach((function(e){g.current[e].node.show()})),Y.current.batchDraw()),ne.current&&ne.current.line.show()),At();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),st=function(){var e=Object(_e.a)(fe.a.mark((function e(){var t,n,r,a;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={},b.current&&Object.keys(b.current).length>0?(t=Object(ge.cloneDeep)(b.current),a=ke(g.current||{}),n=Object(ge.cloneDeep)(g.current),r=Object(ge.cloneDeep)(v.current),Dt(),dt(!1)):dt(!0),t&&(b.current=t,v.current=r,g.current=Oe(a,n),b.current&&b.current.node&&(b.current.node.forEach((function(e){g.current[e].node.hide()})),Y.current.batchDraw()),ne.current&&ne.current.line.hide(),Se());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),lt=function(){k.current.on("wheel",Object(ge.throttle)((function(e){e.evt.preventDefault(),ue.current||(ue.current=!0,st());var t=X.current.scaleX(),n=k.current.getPointerPosition(),r=(n.x-X.current.x())/t,a=(n.y-X.current.y())/t,o=e.evt.deltaY>0?1.1*t:t/1.1;if(o>=1&&o<=100){X.current.scale({x:o,y:o});var c={x:n.x-r*o,y:n.y-a*o};X.current.position(c),gt(),et(),Be(!1),L(null),Ve(),Y.current.batchDraw()}}),10)),k.current.on("wheel",Object(ge.debounce)((function(e){ue.current&&(ue.current=!1),_t(X.current).then((function(e){ut()}))}),100))},dt=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object.keys(ee.current).forEach((function(e){yt(e),b.current.line&&b.current.line.destroy()})),e&&Ft()},mt=function(){X.current.draggable(!0),X.current.on("dragmove",function(){var e=Object(_e.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_t(t.target).then((function(e){gt(),et(),Be(!1),Ve()}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),X.current.on("dragstart",st),X.current.on("dragend",ut)},pt=function(){var e,t=Object(ge.cloneDeep)(v.current),n=b.current,a=n.from_station,o=n.to_station,c=ye(K.current[a].x,K.current[a].y),i=ye(K.current[o].x,K.current[o].y);for(e=0;e<t.length;e+=2){var u=Ze(t[e],t[e+1]),s=Object(l.a)(u,2),d=s[0],m=s[1];t[e]=d,t[e+1]=m}var p=function(e,t,n,a,o,c){var i,u=[],s=function(){var s=void 0,d=[t[i],t[i+1]],m=[t[i+2],t[i+3]],p=void 0;0===i?(s=e,p=4===t.length?n:[t[i+4],t[i+5]]):i===t.length-4?(s=[t[i-2],t[i-1]],p=n):(s=[t[i-2],t[i-1]],p=[t[i+4],t[i+5]]);var f=Te(s,d,m,p),_=Object(l.a)(f,4),h=Ne(_[0],_[1],_[2],_[3],500),b=[],g=[];if(h.forEach((function(e,t){t%2===0?b.push(e):g.push(e)})),console.log("pathm",h),Le(b,g,a)){var v,y=[];for(v=0;v<h.length;v+=2){var w=c.apply(void 0,Object(r.a)(o(h[v],h[v+1]))),x=Object(l.a)(w,2),j=x[0],k=x[1];y.push(j,k)}u.push(y)}};for(i=0;i<t.length;i+=4)s();return u}(c,t,i,4/b.current.radius,De,Ae);return p.length>0&&kt(p),p.length>0};function _t(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(_e.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.current.x=t.attrs.x-f.current.x,d.current.y=t.attrs.y-f.current.y,f.current.x=t.attrs.x,f.current.y=t.attrs.y;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(){Object.keys(K.current).forEach((function(e){K.current[e].x+=d.current.x,K.current[e].y+=d.current.y}))}function gt(){Object.keys(Q.current).forEach((function(e){var t=K.current[e],n=t.x,r=t.y,a=Ae(n,r),o=Object(l.a)(a,2);n=o[0],r=o[1],Q.current[e].x(n),Q.current[e].y(r),Q.current[e].rotation(X.current.rotation()-K.current[e].rotation),Z.current[e].x(n),Z.current[e].y(r-50)}))}var vt=function(){for(var e in $.current){var t=$.current[e];t.x+=d.current.x,t.y+=d.current.y}},yt=function(e){!function(e){b.current=Object(me.a)({},ee.current[e]),b.current.node=Object(r.a)(ee.current[e].node),b.current.route=Object(ge.cloneDeep)(ee.current[e].route)}(e),function(e){ee.current[e].node.forEach((function(e){g.current[e]=Object(ge.cloneDeep)($.current[e])}))}(e),function(e){e in h.current&&(v.current=Object(r.a)(h.current[e]))}(e)};function wt(e){for(var t=[],n=0;n<e.length;n+=2){var a=De(e[n],e[n+1]),o=Ae(a[0],a[1]);t.push.apply(t,Object(r.a)(o))}return t}var xt=function(e,t){var n=[],a=e.current,o=t?a.radius:a.radius||1.5;return n.push(Object(r.a)(ye(K.current[a.from_station].x,K.current[a.from_station].y))),t?a.node.forEach((function(e){var t=a.node_ref[e];n.push(Object(r.a)(ye(t.x,t.y)))})):a.node.forEach((function(e){e in g.current&&!g.current[e].post_process&&n.push(Object(r.a)(ye(g.current[e].x,g.current[e].y)))})),n.push(Object(r.a)(ye(K.current[a.to_station].x,K.current[a.to_station].y))),function(e,t){var n=new ve.a(e),r=xe(n,t);return v.current=wt(Object(ge.flatten)(r.to2DArray()).slice(2,-2)),wt(Fe(ze(r)))}(n,o)},jt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=xt(e?ne:b,e);return t},kt=function(e){e.forEach((function(e){var t=ct(e,"#3F50AA",!1,!0);ie.current.push(t)}))},Ot=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black",r=b.current.invalid_route||!1,a=jt(t),o=ct(a,n,t,!1,r);return t&&(re.current=o),e&&ot(),o},Et=function(e){h.current[e]=Object(r.a)(v.current)},Nt=function(e){!function(e){ee.current[e]=Object(ge.cloneDeep)(b.current),ee.current[e].line=y.current,ee.current[e].route_id=e}(e),Object.entries(g.current).forEach((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];$.current[n]=Object(ge.cloneDeep)(r),delete $.current[n].node})),Et(e)},St=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green";"green"!==t&&"orange"!==t||Rt(),Ct(e,t)},Ct=function(e,t){var n=Q.current[e],r=Object(l.a)(n.children,1)[0];r.attrs.fill=t,r.strokeEnabled(!0),r.attrs.stroke="red",r.attrs.strokeWidth=5,r.dashEnabled(!0),r.dash([12,12]),Y.current.batchDraw()},Rt=function(){Object.values(Q.current).forEach((function(e){var t=Object(l.a)(e.children,1)[0];t.attrs.fill="orange",t.strokeEnabled(!1),t.dashEnabled(!1),Y.current.batchDraw()}))},Mt=function(e){Dt(),It(e),e>=0&&(zt(),j((function(e){return e-1})))},It=function(e){(e in ee.current&&"line"in ee.current[e]?ee.current[e].line:y.current).destroy(),e in ee.current&&delete ee.current[e],Object.entries(g.current).forEach((function(e){var t=Object(l.a)(e,2),n=t[0];t[1].node.destroy(),n in $.current&&delete $.current[n]})),Y.current.batchDraw(),Ft()},Dt=function(){v.current.length>0&&(b.current.cp_ref&&b.current.cp_ref.forEach((function(e){e.destroy()})),delete b.current.cp_ref),v.current=[]},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object.values(ee.current).forEach((function(t){"line"in t&&t.route_id!==e&&t.line.children[1].off("click.e1 tap.e1 touch.e1")}))},Ft=function(){b.current={},g.current={},y.current=null},At=function(){Object.values(Q.current).forEach((function(e){e.moveToTop()})),ne.current&&ne.current.line.moveToTop(),y.current&&y.current.moveToTop(),ce.current.forEach((function(e){e.moveToTop()})),Object.values(Z.current).forEach((function(e){e.moveToTop()})),b.current.cp_ref&&b.current.cp_ref.forEach((function(e){e.moveToTop()})),P.current&&P.current.moveToTop(),Object.values(g.current).forEach((function(e){e.node&&e.node.moveToTop()})),q.current&&q.current.parent&&q.current.moveToTop(),Y.current.batchDraw()},Tt=["Align Map","Station","Route"],Lt=function(e){switch(e.target.id){case"Align Map":case"Station":case"Route":D(e.target.id)}},Pt=function(){var e;return o.a.createElement(Ke,(e={map_image:X,station_coord:K,icon_list:Q,icon_name:Z,map_cord:f,stage:k,layer:Y,rotate_point:qe,shift_coord_update_pos:Pe,Y_OFFSET_NAME:50,clear_grid:Be,draw_grid:Ve,grid_state:J,update_icon_pos:gt,node_ref:$,redraw_all_routes:Ce,circle_hide_tool_tip:et,pivot:u,angle_offset:m},Object(de.a)(e,"icon_list",Q),Object(de.a)(e,"is_mounted",p),Object(de.a)(e,"reset_zindex",At),Object(de.a)(e,"pivot_ref",q),e))},qt=function(){ae.current?Ht():Vt()},Ht=function(){oe.current.innerHTML="Routes On",oe.current.style.backgroundColor="#005086",Ce(),At(),ae.current=!1},Vt=function(){oe.current.innerHTML="Routes Off",oe.current.style.backgroundColor="darkred",Ce(!1),At(),ae.current=!0},Wt=function(){X.current.scale({x:1,y:1}),X.current.x((k.current.width()-i.x*_)/2),X.current.y((k.current.height()-i.y*_)/2),_t(X.current).then((function(e){gt(),Ce(!ae.current),et(),Be(!1),Ve(),At()}))};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"map-editor-div"},o.a.createElement("div",{className:"map-div"},o.a.createElement("div",{className:"tools"},b.current&&o.a.createElement("button",{ref:oe,onClick:qt,className:"grid-button-route"},"Routes On"),o.a.createElement("button",{value:J,onClick:Je,style:J?{backgroundColor:"#005086",color:"white"}:{backgroundColor:"darkred",color:"white"},className:"grid-button"},"Grid ",J?"On":"Off"),o.a.createElement("button",{onClick:function(){var e=X.current.scaleX();(e+=.1)<=100&&(X.current.scale({x:e,y:e}),X.current.x(X.current.x()-.1*X.current.width()/2),X.current.y(X.current.y()-.1*X.current.height()/2),_t(X.current).then((function(e){gt(),Ce(!ae.current),et(),Be(!1),Ve(),At()})))}},"+"),o.a.createElement("button",{onClick:function(){var e=X.current.scaleX();(e-=.1)>=1&&(X.current.scale({x:e,y:e}),X.current.x(X.current.x()+.1*X.current.width()/2),X.current.y(X.current.y()+.1*X.current.height()/2),_t(X.current).then((function(e){gt(),Ce(!ae.current),et(),Be(!1),Ve(),At()})))}},"-"),o.a.createElement("button",{onClick:Wt},"x")),o.a.createElement("div",{className:"konva-container",ref:z},o.a.createElement("div",{id:"konva-div-ruler"}),o.a.createElement("div",{id:"konva-div"}))),o.a.createElement("div",{className:"input-div"},o.a.createElement("div",{className:"tab-buttons"},Tt.map((function(e,t){return o.a.createElement("button",{key:t,onClick:Lt,className:"".concat(I===e?"map-editor-button-tabs-active":"map-editor-button-tabs"),id:e},e)}))),S&&o.a.createElement("div",{className:"tab-content"},function(){switch(I){case"Align Map":return Pt();case"Station":return o.a.createElement(rt,{map_image:X,station_coord:K,icon_list:Q,icon_name:Z,map_cord:f,stage:k,layer:Y,route_ref:ee,node_ref:$,delete_all_routes:dt,load_temp_route:yt,draw_route:Ot,line:y,reset_tmp_route_node_path:Ft,tmp_route_details:b,save_temp_route:Nt,get_map_coordinate:ye,get_pixel_coordinate:De,get_untransformed_coordinates:we,get_transformed_coordinates:Ae,Y_OFFSET_NAME:50,highlight_stations:St,unhighlight_stations:Rt,add_tooltip_event_listener_to:tt,tooltip:P,delete_path:Mt,set_current_tab:D,update_tooltip:je,circle_hide_tool_tip:et,is_mounted:p,reset_map_scale:Wt,highlight_current_line:Me,reset_zindex:At});case"Route":return function(){var t;return o.a.createElement(ft,(t={delete_all_routes:dt,map_image:X,station_coord:K,icon_list:Q,icon_name:Z,map_cord:f,stage:k,layer:Y,node_ref:$,route_ref:ee,count:te,load_temp_route:yt,cp_ref:h,tmp_route_details:b,tmp_node_details:g,tmp_cp_details:v,draw_route:Ot,get_circle:at,draw_control_points:ot,get_id:nt,line:y,reset_tmp_route_node_path:Ft,save_temp_route:Nt,get_map_coordinate:ye,highlight_stations:St,unhighlight_stations:Rt,delete_path:Mt,remove_control_points:Dt,remove_path_event_listeners:zt,set_route_added:j},Object(de.a)(t,"map_image",X),Object(de.a)(t,"update_map_corner_pos",_t),Object(de.a)(t,"update_station_panned_pos",bt),Object(de.a)(t,"update_icon_pos",gt),Object(de.a)(t,"update_node_pan_pos",vt),Object(de.a)(t,"redraw_all_routes",Ce),Object(de.a)(t,"clear_grid",Be),Object(de.a)(t,"draw_grid",Ve),Object(de.a)(t,"circle_hide_tool_tip",et),Object(de.a)(t,"origin",n),Object(de.a)(t,"scale",c),Object(de.a)(t,"size",i),Object(de.a)(t,"map_scale",_),Object(de.a)(t,"map_name",e.map_name),Object(de.a)(t,"trip_type",e.trip_type),Object(de.a)(t,"get_untransformed_coordinates",we),Object(de.a)(t,"get_transformed_coordinates",Ae),Object(de.a)(t,"reference_route_ref",ne),Object(de.a)(t,"tooltip",P),Object(de.a)(t,"route_toggle_ref",ae),Object(de.a)(t,"route_toggle_button_ref",oe),Object(de.a)(t,"route_toggle_button_on",Ht),Object(de.a)(t,"is_mounted",p),Object(de.a)(t,"add_delete_mode",T),Object(de.a)(t,"set_add_delete_mode",L),Object(de.a)(t,"draw_line",ct),Object(de.a)(t,"invalid_route_ref",ce),Object(de.a)(t,"remove_invalid_turns",Se),Object(de.a)(t,"check_valid_route",pt),Object(de.a)(t,"highlight_current_line",Me),Object(de.a)(t,"reset_zindex",At),t))}();default:return Pt()}}()))))};var ht=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(l.a)(c,2),u=i[0],d=i[1],m=Object(a.useState)(null),p=Object(l.a)(m,2),f=p[0],_=p[1],h=Object(a.useState)(null),v=Object(l.a)(h,2),y=v[0],w=v[1],x=Object(a.useRef)(!1),j=Q().add_alert,k=Object(s.i)().id;Object(a.useEffect)((function(){return x.current=!0,function(){x.current=!1}}),[]),Object(a.useEffect)((function(){N({request_headers:g()})}),[k]);var O=ae({url:"".concat(b,"/map_editor/").concat(k),method:"post",on_error:function(e){j({message:"Some Unexpected error occurred!",status:"danger"})},on_success:function(e){!function(e){if(console.log(e,"files data"),j({message:"Files are retrieved!",status:"info"}),ct(e.webui_map_json)){if(x.current&&_(e.webui_map_json),x.current&&d(e.webui_map_image),null!==e.waypoints){var t=it(e.waypoints);x.current&&w(t)}x.current&&r(!0)}}(e.data)}}),E=Object(l.a)(O,2),N=E[0];return E[1],n?function(e,t){var n=e.maps[0].scale,r=e.maps[0].size,a=e.maps[0].origin,c=e.map_name,i=e.trip_type||"p2p";return o.a.createElement(_t,{scale:n,size:r,origin:a,map_name:c,image:t,trip_type:i,waypoints_data:y})}(f,u):o.a.createElement("div",{className:"map-editor-api-main-container"},$)},bt=(n(325),n(66)),gt=o.a.createElement(bt.RectShape,{color:"#E0E0E0",style:{minWidth:"7rem",height:"3rem"}}),vt=o.a.createElement(bt.TextBlock,{color:"#E0E0E0",rows:1});function yt(e){var t=e.hide_modal,n=e.add_alert,r=e.select_station_and_set_status,c=Object(a.useState)(null),i=Object(l.a)(c,2),u=i[0],s=i[1],d=Object(a.useRef)(!1),m=ae({url:"".concat(b,"/stations"),method:"get",on_error:function(e){n({message:"Some Unexpected error occurred!",status:"danger"})},on_success:function(e){!function(e){d.current&&s(e.stations)}(e.data)}}),p=Object(l.a)(m,2),f=p[0],_=p[1];Object(a.useEffect)((function(){return d.current=!0,console.log("component mounted"),f({request_headers:g()}),function(){d.current=!1}}),[]);return o.a.createElement("div",{className:"stations-wrapper"},o.a.createElement("span",{"data-testid":"sherpa-station-title",className:"status-text sherpa-status-text"},_?o.a.createElement("span",{className:"text-placeholder-wrapper"},vt):"Which station is the Sherpa at?"),o.a.createElement("div",{className:"stations-container"},_?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"loading-station-button"},gt),o.a.createElement("div",{className:"loading-station-button"},gt),o.a.createElement("div",{className:"loading-station-button"},gt),o.a.createElement("div",{className:"loading-station-button"},gt),o.a.createElement("div",{className:"loading-station-button"},gt)):function(){var e=u&&u.map((function(e,n){return o.a.createElement(ee,{key:n,"data-id":e,className:"station-button","data-testid":"station-button","data-type":"auto",onClick:function(e){return function(e){r({request_body:{action:e.target.dataset.type,station:e.target.dataset.id}}),t()}(e)}},e)}));return o.a.createElement(o.a.Fragment,null,e)}()))}n(328);var wt=o.a.createElement(bt.TextBlock,{color:"#E0E0E0",rows:1});var xt=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Q().add_alert,i=ne(),u=Object(l.a)(i,3),s=u[0],d=u[1],m=u[2],p=Object(a.useState)(null),f=Object(l.a)(p,2),_=f[0],h=f[1],v=Object(a.useRef)(!1),y=function(){return o.a.createElement("div",{className:"spinner-div"},$)};Object(a.useEffect)((function(){return v.current=!0,O({request_headers:g()}),function(){v.current=!1}}),[]);var w=function(e,t){switch(t){case"remote":c({message:"Switched to remote drive",status:"info"}),v.current&&h(t),v.current&&r("Sherpa is in remote drive");break;case"dualshock":c({message:"Switched to manual mode!",status:"info"}),v.current&&h(t),v.current&&r("Sherpa is in manual mode");break;case"shutdown":c({message:"Turned off the vehicle!",status:"info"}),v.current&&h(t),v.current&&r("Sherpa is turned off");break;case"auto":c({message:"Switched to autonomous mode!",status:"info"}),v.current&&h(t),v.current&&r("Sherpa is in autonomous mode at ".concat(e.station));break;default:v.current&&h(""),c({message:"Some Unexpected error occurred!",status:"danger"})}},x=function(e){console.log("err",e),c({message:"Some Unexpected error occurred!",status:"danger"})},j=ae({url:"".concat(b,"/mode"),method:"get",on_error:x,on_success:function(e){!function(e){v.current&&h(e.mode)}(e.data)}}),k=Object(l.a)(j,2),O=k[0],E=k[1],N=ae({url:b,method:"post",on_error:x,on_success:function(e){var t=e.data;w(t,"remote")}}),S=Object(l.a)(N,2),C=S[0],R=S[1],M=ae({url:b,method:"post",on_error:x,on_success:function(e){var t=e.data;w(t,"dualshock")}}),I=Object(l.a)(M,2),D=I[0],z=I[1],F=ae({url:b,method:"post",on_error:x,on_success:function(e){var t=e.data;w(t,"shutdown")}}),A=Object(l.a)(F,2),T=A[0],L=A[1],P=function(){var e=Object(_e.a)(fe.a.mark((function e(t){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=ae({url:b,method:"post",on_error:x,on_success:function(e){var t=e.data;w(t,"auto")}}),H=Object(l.a)(q,2),V=H[0],W=H[1],B=function(){var e=Object(_e.a)(fe.a.mark((function e(t){var n;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.dataset.type,t.target.innerHTML,e.t0=n,e.next="remote"===e.t0?5:"dualshock"===e.t0?8:"shutdown"===e.t0?11:13;break;case 5:return e.next=7,C({request_body:{action:n},request_headers:g()});case 7:return e.abrupt("break",14);case 8:return e.next=10,D({request_body:{action:n},request_headers:g()});case 10:return e.abrupt("break",14);case 11:return T({request_body:{action:n},request_headers:g()}),e.abrupt("break",14);case 13:c({message:"Some Unexpected error occurred!",status:"danger"});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"status-app-wrapper"},o.a.createElement("span",{"data-testid":"sherpa-status-title",className:"status-text"},E||R||z||W||L?o.a.createElement("span",{className:"text-placeholder-wrapper"},wt):n),o.a.createElement("div",{className:"buttons-wrapper"},o.a.createElement(ee,{className:"status-button desaturated-yellow ".concat("remote"===_?"current-mode-disable-button":""),"data-type":"remote",onClick:function(e){!R&&B(e)},"data-testid":"remote-drive-button",disabled:!!(E||L||z||W||"remote"===_)},R?y():"Drive via remote"),o.a.createElement(ee,{className:"status-button desaturated-orange ".concat("dualshock"===_?"current-mode-disable-button":""),"data-type":"dualshock",onClick:function(e){!z&&B(e)},"data-testid":"dual-shock-button",disabled:!!(E||R||L||W||"dualshock"===_)},z?y():"Drive via dualshock 4 controller"),o.a.createElement(ee,{className:"status-button desaturated-green ".concat("auto"===_?"current-mode-disable-button":""),"data-type":"auto",onClick:function(e){!W&&d()},"data-testid":"auto-button",disabled:!!(E||R||z||L||"auto"===_)},W?y():"Switch into autonomous mode"),o.a.createElement(ee,{className:"status-button desaturated-red ".concat("shutdown"===_),"data-type":"shutdown",onClick:function(e){!L&&B(e)},"data-testid":"shutdown-button",disabled:!!(E||R||z||W||"shutdown"===_)},L?y():"Shutdown")),o.a.createElement(s,{"data-testid":"modal"},o.a.createElement(yt,{hide_modal:m,add_alert:c,select_station_and_set_status:P})))};var jt=function(e){var t=e.video_feed,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(null!==t&&n.current){var e=n.current;e&&(e.srcObject=t)}}),[t,n]),o.a.createElement("div",{className:"video-wrapper"},o.a.createElement("video",{autoPlay:!0,playsInline:!0,ref:n,height:"100%"}))},kt=n(153),Ot=n.n(kt);var Et=function(e){var t=e.set_direction,n=Object(a.useRef)(null),r=Object(a.useRef)(null),c=Object(a.useRef)(null),i=Object(a.useRef)(null),u=Object(a.useRef)(null),s=Object(a.useRef)(null),l=Object(a.useRef)({}),d=Object(a.useRef)({}),m=Object(a.useRef)(new Image),p=function(){if(Object.values(l.current).forEach((function(e){e.fill("#52595F")})),console.log("update_buttons_highlight"),s.current&&l.current){console.log("direction_ref.current && buttons_ref.current",l.current[s.current]);var e=s.current;e&&e in l.current&&l.current[e].fill("black")}r.current.batchDraw()},f=function(e){switch(e){case"east":t(90);break;case"west":t(-90);break;case"north-":t(-30);break;case"north":t(0);break;case"north+":t(30);break;case"south-":t(150);break;case"south":t(-180);break;case"south+":t(-150);break;case"north_east":t(60);break;case"north_west":t(-60);break;case"south_east":t(120);break;case"south_west":t(-120)}};return Object(a.useEffect)((function(){var e=n.current;return console.log("joystick_container",e),e&&(r.current=new be.a.Stage({container:"joystick",width:e.offsetWidth,height:e.offsetHeight})),m.current.src=String(Ot.a),m.current.onload=function(){!function(){u.current=new be.a.Layer;var e,n=r.current,a=n.height(),o=n.width(),c=o/2,i=a/2,d=o/2-30,_=o/2-2,h=-105,b=["north","north+","north_east","east","south_east","south-","south","south+","south_west","west","north_west","north-"],g=0;for(e=0;e<12;e++){console.log("loop");var v=Me(h,10),y=[],w=c+d*Math.cos(v),x=i+d*Math.sin(v);y.push(w,x);var j=void 0;for(j=h;j<=h+30;j+=6){var k=Me(j,10);w=c+d*Math.cos(k),x=i+d*Math.sin(k),y.push(w,x)}var O=Me(h+15,10),E=(_-d)/2+d,N=c+E*Math.cos(O),S=i+E*Math.sin(O),C=new be.a.Image({x:N,y:S,id:e,image:m.current,width:20,height:20,rotation:g,offset:{x:10,y:10}});for(g+=30,v=Me(h+=30,10),w=c+_*Math.cos(v),x=i+_*Math.sin(v),y.push(w,x),j=h;j>=h-30;j-=3.75){var R=Me(j,10);w=c+_*Math.cos(R),x=i+_*Math.sin(R),y.push(w,x)}var M=new be.a.Line({points:y,fill:"#52595F",stroke:"#424A4D",strokeWidth:5,closed:!0,id:e}),I=new be.a.Group;if("east"!==b[e]&&"west"!==b[e]){I.add(M,C),I.on("touchstart mousedown",(function(e){console.log("e.target.attrs",e.target.attrs);var t=parseInt(e.target.attrs.id);f(b[t]),s.current=b[t],p()})),I.on("touchend mouseup mouseleave touchmove",(function(e){parseInt(e.target.attrs.id);t(null),s.current=null,p()}));var D=M.attrs.id;console.log(D),l.current[b[D]]=M,u.current.add(I)}}n.add(u.current),n.batchDraw()}(),function(){var e=r.current,n=e.height(),a=e.width(),o=a/2,i=n/2,u=new be.a.Circle({x:n/2,y:a/2,radius:40,fill:"white",draggable:!0,stroke:"#52595F",strokeWidth:5,dragBoundFunc:function(e){var t=a/2,r=n/2,o=(a/2-40-30+15)/Math.sqrt(Math.pow(e.x-t,2)+Math.pow(e.y-r,2));return o<1?{y:Math.round((e.y-r)*o+r),x:Math.round((e.x-t)*o+t)}:e}});c.current=new be.a.Layer,c.current.add(u),e.add(c.current),e.batchDraw(),u.on("dragmove",(function(){var e=0,n=0,r=-(o-u.x()),a=i-u.y(),c=180*Math.atan2(a-n,r-e)/Math.PI;t(c<-90?90-c-360:90-c)})),u.on("dragend",(function(){u.x(a/2),u.y(n/2),t(null)}))}()},function(){var e=r.current,t=e.height(),n=e.width(),a=n/2-30,o=new be.a.Circle({x:t/2,y:n/2,radius:a,fill:"#424A4D"}),c=new be.a.Circle({x:t/2,y:n/2,radius:10,fill:"white"}),u=n/2-2,s=new be.a.Circle({x:t/2,y:n/2,radius:u,fill:"#424A4D"});i.current=new be.a.Layer,i.current.add(o),i.current.add(s),i.current.add(c),e.add(i.current),e.batchDraw()}(),console.log("buttons_ref",l),document.addEventListener("keypress",(function(e){if(console.log("Key: ".concat(e.key," with keycode ").concat(e.keyCode," has been pressed down")),!e.repeat){"w"!==e.key&&"a"!==e.key&&"s"!==e.key&&"d"!==e.key||(d.current[e.key]=!0);var t=d.current;t.w&&t.a?(s.current="north-",f("north-"),p()):t.w&&t.d?(s.current="north+",f("north+"),p()):t.s&&t.d?(s.current="south-",f("south-"),p()):t.s&&t.a?(s.current="south+",f("south+"),p()):t.w?(s.current="north",f("north"),p()):t.a?(s.current="north_west",f("north_west"),p()):t.s?(s.current="south",f("south"),p()):t.d&&(s.current="north_east",f("north_east"),p())}})),document.addEventListener("keyup",(function(e){console.log("Key: ".concat(e.key," with keycode ").concat(e.keyCode," has been pressed up")),"w"!==e.key&&"a"!==e.key&&"s"!==e.key&&"d"!==e.key||(s.current=null,p(),t(null),delete d.current[e.key])})),function(){!1}}),[n]),o.a.createElement("div",{className:"joystick-container",ref:n},o.a.createElement("div",{id:"joystick"}))};var Nt=function(){return o.a.createElement("div",{className:"lidar-view-container"},"Lidar view")};n(329);var St=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(l.a)(c,2),u=i[0],s=i[1],d=Object(a.useState)(null),m=Object(l.a)(d,2),p=m[0],f=m[1],_=Object(a.useState)(!1),h=Object(l.a)(_,2),b=h[0],g=h[1],v=Object(a.useState)(!1),y=Object(l.a)(v,2),w=(y[0],y[1],Object(a.useRef)(null),Object(a.useRef)(null));function x(){return j.apply(this,arguments)}function j(){return(j=Object(_e.a)(fe.a.mark((function e(){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n="https://"===window.location.protocol?"wss":"ws",r=new WebSocket("".concat(n,"://").concat(window.location.hostname,":4000"));r.binaryType="arraybuffer",r.onopen=function(){return e(r)},r.onerror=function(e){return t(e)}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){console.log("video_feed",p)}),[p]);var k=function(){var e=Object(_e.a)(fe.a.mark((function e(){var t,n,r,a;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:return t=e.sent,(n=new RTCPeerConnection({sdpSemantics:"unified-plan",iceServers:[{urls:["stun:stun.l.google.com:19302"]}]})).addEventListener("track",(function(e){"video"===e.track.kind&&f(e.streams[0])})),n.addTransceiver("video",{direction:"recvonly"}),n.onicecandidate=function(e){e.candidate&&t.send(JSON.stringify({message_type:"CANDIDATE",content:JSON.stringify(e.candidate)}))},t.addEventListener("message",function(){var e=Object(_e.a)(fe.a.mark((function e(t){var r,a,o,c;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(t.data),a=r.message_type,o=r.content,"spectator"!==a){e.next=5;break}g(!0),e.next=14;break;case 5:if("CANDIDATE"!==a){e.next=11;break}return c=new RTCIceCandidate(JSON.parse(o)),e.next=9,n.addIceCandidate(c);case 9:e.next=14;break;case 11:if("SDP"!==a){e.next=14;break}return e.next=14,n.setRemoteDescription(o);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(r=n.createDataChannel("data")).binaryType="arraybuffer",r.addEventListener("message",(function(e){console.log("event",e)})),e.next=14,n.createOffer();case 14:return a=e.sent,e.next=17,n.setLocalDescription(a);case 17:return t.send(JSON.stringify({message_type:"SDP",content:a})),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(function(){var e=Object(_e.a)(fe.a.mark((function e(){var t,n;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:return t=e.sent,w.current=t,n=w.current,e.next=7,new Promise((function(e,t){n&&(n.onopen=function(){console.log("Data channel open!!"),e(null)}),n&&(n.onerror=function(e){console.log("err",e),t(e)})}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.useEffect)((function(){s(null!==n?(90-Math.abs(n))/90:null);var e=w.current;console.log("data_channel",e&&e.readyState),e&&e.send(Float32Array.from([12,13]).buffer)}),[n]),o.a.createElement("div",{className:"remote-drive-container"},o.a.createElement(jt,{video_feed:p}),o.a.createElement(Et,{set_direction:r}),o.a.createElement(Nt,null),"angle: ",n," velocity: ",u,JSON.stringify(b))};n(330);var Ct=function(){var e=Object(s.g)(),t=Object(a.useState)({}),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Q().add_alert,u=Object(a.useState)([]),d=Object(l.a)(u,2),m=d[0],p=d[1],f=Object(a.useState)(!1),_=Object(l.a)(f,2),h=_[0],v=_[1],y=Object(a.useState)(!1),w=Object(l.a)(y,2),x=w[0],j=w[1],k=Object(a.useState)(null),O=Object(l.a)(k,2),E=O[0],N=O[1],S=Object(a.useRef)(!1),C=Object(a.useRef)({progress:null,map_id:null}),R=function(e){console.log("err",e),i({message:"Some Unexpected error occurred!",status:"danger"})},M=ae({url:"".concat(b,"/map_creator/dirs"),method:"get",on_error:R,on_success:function(e){var t=e.data;S.current&&p(t.dirs)}}),I=Object(l.a)(M,2),D=I[0],z=I[1],F=ae({url:"".concat(b,"/map_creator/status"),method:"get",on_error:R,on_success:function(e){var t=e.data;console.log(t.progress),"complete"===t.progress&&(S.current&&v(!1),S.current&&j(!0)),C.current=t}}),A=Object(l.a)(F,2),T=A[0],L=(A[1],ae({url:"".concat(b,"/map_creator"),method:"post",on_error:R,on_success:function(e){e.data;S.current&&v(!0)}})),P=Object(l.a)(L,2),q=P[0],H=P[1];Object(a.useEffect)((function(){return S.current=!0,function(){var e=Object(_e.a)(fe.a.mark((function e(){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T({request_headers:g});case 2:if(null===C.current.progress){e.next=6;break}S.current&&v(!0),e.next=8;break;case 6:return e.next=8,D();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){S.current=!1}}),[]),Object(a.useEffect)((function(){h&&V()}),[h]);var V=function(){var e=Object(_e.a)(fe.a.mark((function e(){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("complete"===C.current.progress){e.next=7;break}return console.log(C.current.progress),e.next=4,new Promise((function(e){return setTimeout(e,3e3)}));case 4:T(),e.next=0;break;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(e){var t=e.target;console.log("target",t),S.current&&c((function(e){return Object(me.a)(Object(me.a)({},e),{},Object(de.a)({},t.dataset.key,t.value))})),"map-name"===e.target.id&&S.current&&N(null)},B=function(e){return console.log("dirs",e),e.map((function(e){return{name:e,value:e}}))};return console.log(B(m)),o.a.createElement("div",{className:"map-creator-wrapper"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S.current&&j(!1),q(Object(me.a)(Object(me.a)({},r),{},{request_headers:g}))}},o.a.createElement("fieldset",{disabled:z||H||h,className:"map-creator-container"},o.a.createElement(ue,{id:"map-directory",onChange:W,"data-key":"run_directory",label:"select the run directory",options:B(m)}),o.a.createElement(ie,{id:"map-name","data-key":"map_name",onChange:W,label:"Map name",regex:/^[a-zA-Z]\w*/,minLength:2,onError:function(e){"range_exceeded"===e.key?S.current&&N("The map name should atleast have two characters."):"regex_unmatch"===e.key&&S.current&&N("The map name should not have any spaces and should not start with a number.")},required:!0}),o.a.createElement(ee,{type:"submit",disabled:null!==E},"Generate"),h&&o.a.createElement("section",{className:"progress-div"},o.a.createElement(se,{progress:C.current.progress}),o.a.createElement("span",null,"loading...")),x&&o.a.createElement(ee,{onClick:function(){C.current.map_id&&e.push("/map_editor_/".concat(C.current.map_id))}}," Load Map Editor"),(z||H)&&$,o.a.createElement("span",{className:"error-span"},E))))},Rt=(n(139),n(84)),Mt=["color","className","dimension","directoryName"],It=function(e){var t=e.color,n=void 0===t?"currentColor":t,r=e.className,a=e.dimension,c=e.directoryName,i=Object(Rt.a)(e,Mt);return o.a.createElement("div",{className:r},o.a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:a,height:a,fill:n,className:"bi bi-folder2",viewBox:"0 0 16 16"},i),o.a.createElement("path",{d:"M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v7a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 1 12.5v-9zM2.5 3a.5.5 0 0 0-.5.5V6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5zM14 7H2v5.5a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V7z"})),o.a.createElement("span",{className:"directory-svg-text"},c))};var Dt=function(){var e=Q().add_alert,t=Object(s.g)(),n=Object(a.useState)(null),r=Object(l.a)(n,2),c=r[0],i=r[1],u=Object(a.useRef)(!1),d=ae({url:"".concat(b,"/map_editor/dirs"),method:"get",on_error:function(t){e({message:"Some Unexpected error occurred!",status:"danger"})},on_success:function(t){!function(t){e({message:"Directories are loaded!",status:"info"}),console.log(t,"dir data"),u.current&&i(t.dirs)}(t.data)}}),m=Object(l.a)(d,2),p=m[0],f=m[1];return Object(a.useEffect)((function(){function e(){return(e=Object(_e.a)(fe.a.mark((function e(){return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({request_headers:g()});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return u.current=!0,function(){e.apply(this,arguments)}(),function(){u.current=!1}}),[]),o.a.createElement("div",{className:"map-editor-api-main-container"},f?$:o.a.createElement("div",{className:"show-maps-container"},c&&c.map((function(e,n){return o.a.createElement(It,{className:"directory-svg",key:n,dimension:"100",color:"grey","data-id":e.id,directoryName:e.name,onClick:function(n){t.push("/map_editor_/".concat(e.id))}})}))))};var zt=function(e){var t=e.match.url;return o.a.createElement("div",null,o.a.createElement(le,null),o.a.createElement(s.d,null,o.a.createElement(s.b,{exact:!0,path:t+"/map_creator"},o.a.createElement(Ct,null)),o.a.createElement(s.b,{exact:!0,path:"(".concat(t,"/map_editor_)")},o.a.createElement(Dt,null)),o.a.createElement(s.b,{exact:!0,path:t+"/map_editor_/:id"},o.a.createElement(ht,null)),o.a.createElement(s.b,{exact:!0,path:t+"/webctl"},o.a.createElement(xt,null)),o.a.createElement(s.b,{exact:!0,path:t+"/remote_drive"},o.a.createElement(St,null))))},Ft=(n(331),function(){var e=Q().add_alert,t=Object(s.g)();Object(a.useEffect)((function(){localStorage.getItem("token")&&t.push("/map_creator")}),[]);var n=ae({url:"".concat(b,"/login"),method:"post",on_error:function(t){console.log(t,"error on user login"),e({message:"Error on submit! Please retry!",status:"danger"})},on_success:function(n){var r=n.data;localStorage.setItem("token",r.token),t.push("/map_creator"),e({message:"Login success!",status:"info"})}}),r=Object(l.a)(n,2),c=r[0],i=r[1];return o.a.createElement("div",{className:"login-form-container"},i?$:o.a.createElement(o.a.Fragment,null,o.a.createElement(te,{inputs:[{id:"username",type:"text"},{id:"password",type:"password"}],on_submit:function(e){c({request_body:e,request_headers:g()})}}),o.a.createElement(ee,{className:"direct-map-editor-button",onClick:function(){t.push("/map_editor")}},"Go to Map Editor")))}),At=["Component"],Tt=function(e){var t=e.Component,n=Object(Rt.a)(e,At),r=localStorage.getItem("token");return o.a.createElement(s.b,Object.assign({},n,{render:function(e){return r?o.a.createElement(t,e):o.a.createElement(s.a,{to:"/"})}}))};var Lt=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),i=Object(l.a)(c,2),u=i[0],d=i[1],m=Object(a.useState)(null),p=Object(l.a)(m,2),f=p[0],_=p[1],h=Object(a.useState)(!1),b=Object(l.a)(h,2),g=b[0],v=b[1],y=Object(a.useState)(!1),w=Object(l.a)(y,2),x=w[0],j=w[1],k=Object(a.useState)(!1),O=Object(l.a)(k,2),E=O[0],N=O[1],S=Object(s.g)();Object(a.useEffect)((function(){I()}),[n,u]);var C=function(e){var t=new FileReader;try{t.readAsText(e),t.onload=function(e){var n=JSON.parse(t.result);console.log(n,"reader_result"),ct(n)?d(n):(alert("Please upload valid webui_map.json"),e.target.value="",d(null))}}catch(n){console.log("err",n)}t.onerror=function(){console.log(t.error)}},R=function(e){var t=new FileReader;t.readAsText(e);try{t.onload=function(e){var n=JSON.parse(t.result);if(n.map_editor){var r=it(n.map_editor);_(r)}else alert("please upload a waypoints JSON generated from the webUI map editor"),e.target.value="",_(null)}}catch(n){console.log("err",n)}t.onerror=function(){console.log(t.error)}},M=function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){e.type.match("image.*")?r(t.result):(alert("please upload a valid image"),r(null))},t.onerror=function(){console.log(t.error)}},I=function(){n&&u?E?v(!0):j(!0):v(!1)},D=function(e){var t=e.target.files;Object.entries(t).forEach((function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]),r=n.name.split(".").pop();"png"===r&&"webui_map.png"===n.name?M(n):"json"===r&&"webui_map.json"===n.name?C(n):"json"===r&&"waypoints.json"===n.name&&R(n)}))};return o.a.createElement(o.a.Fragment,null,function(){if(x){var e=u.maps[0].scale,t=u.maps[0].size,r=u.maps[0].origin,a=u.map_name,c=u.trip_type||"p2p";return o.a.createElement(_t,{scale:e,size:t,origin:r,map_name:a,image:n,trip_type:c,waypoints_data:f})}return o.a.createElement("div",{className:"file-upload-main-container"},E?o.a.createElement("div",{className:"directory-upload-container"},o.a.createElement("section",null,o.a.createElement("label",null,"webui_map image:")," ",o.a.createElement("input",{onChange:function(e){return M(e.target.files[0])},type:"file",accept:".png"})),o.a.createElement("section",null,o.a.createElement("label",null,"webui_map json:")," ",o.a.createElement("input",{onChange:function(e){return C(e.target.files[0])},type:"file",accept:".json"})),o.a.createElement("section",null,o.a.createElement("label",null,"waypoints json(optional):")," ",o.a.createElement("small",null,"* load routes and stations from waypoints generated ONLY by the current map editor:"," "),o.a.createElement("input",{onChange:function(e){return R(e.target.files[0])},type:"file",accept:".json"})),o.a.createElement("section",null,o.a.createElement("button",{onClick:function(){g&&j(!0)},disabled:!g,className:"load-map-editor-button",style:g?{}:{cursor:"not-allowed",backgroundColor:"lightgrey",color:"#f2f2f2"}},"Load Map Editor"))):o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"directory-upload-container"},o.a.createElement("label",null,"Select the directory:"),o.a.createElement("input",{type:"file",onChange:D,webkitdirectory:"",mozdirectory:"",directory:""})),o.a.createElement(ee,{className:"direct-map-editor-button",onClick:function(){S.push("/")}},"Back to login")),o.a.createElement("button",{className:"file-upload-text-button",onClick:function(){N(!E),v(!1)}},E?"Return to upload files from directory":"Do you want to upload files individually? click here"))}())};n(332);var Pt=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(u.a,null,o.a.createElement(s.d,null,o.a.createElement(s.b,{exact:!0,path:"/"},o.a.createElement(Ft,null)),o.a.createElement(s.b,{exact:!0,path:"/map_editor"},o.a.createElement(Lt,null)),o.a.createElement(Tt,{path:"(/?[map_editor_|map_editor_/:id|remote_drive|webctl|map_creator]?)",Component:zt}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var qt=n(30),Ht=Object(p.a)({name:"stationInfoReducer",initialState:{value:{}},reducers:{set_station_info:function(e,t){e.value=Object(me.a)({},t.payload)}}}),Vt=(Ht.actions.set_station_info,Ht.reducer),Wt=Object(p.a)({name:"usersReducer",initialState:{users:{}},reducers:{set_users_state:function(e,t){e.users=t.payload.users_object},delete_user:function(e,t){delete e.users[t.payload.deleted_user_id]},add_user:function(e,t){console.log("user_reducer add_user",e,t);var n=t.payload.user_object;e.users[n.id]=n},update_user:function(e,t){var n=e.users[t.payload.userId];if(t.payload.user_info){var r=t.payload.user_info;e.users[r.id]=Object(me.a)(Object(me.a)({},n),r)}else t.payload.user_roles&&(n.roles=t.payload.user_roles,e.users[n.id]=n)}}}),Bt=Wt.actions,Jt=(Bt.set_users_state,Bt.delete_user,Bt.add_user,Bt.update_user,Wt.reducer),Ut=Object(p.a)({name:"confReducer",initialState:{value:{}},reducers:{set_conf_state:function(e,t){e.value=t.payload}}}),Yt=(Ut.actions.set_conf_state,Ut.reducer),Gt=Object(p.a)({name:"rolesReducer",initialState:{roles:{}},reducers:{set_roles_state:function(e,t){e.roles=t.payload.roles_object},delete_role:function(e,t){delete e.roles[t.payload.deleted_role_id]},add_role:function(e,t){var n=t.payload.role_object;e.roles[n.id]=n},update_role:function(e,t){var n=e.roles[t.payload.roleId];if(t.payload.role_info){var r=t.payload.role_info;e.roles[r.id]=Object(me.a)(Object(me.a)({},n),r)}else t.payload.role_functions&&(n.functions=t.payload.role_functions,e.roles[n.id]=n)}}}),Xt=Gt.actions,Kt=(Xt.set_roles_state,Xt.delete_role,Xt.add_role,Xt.update_role,Gt.reducer),Qt=Object(p.a)({name:"functionsReducer",initialState:{functions:{}},reducers:{set_functions_state:function(e,t){e.functions=Object(me.a)({},t.payload)}}}),Zt=(Qt.actions.set_functions_state,Qt.reducer),$t=Object(p.a)({name:"currentUserReducer",initialState:{users:{}},reducers:{set_current_users_state:function(e,t){e.users=t.payload.users_object}}}),en=($t.actions.set_current_users_state,$t.reducer),tn=Object(p.a)({name:"userFunctionReducer",initialState:{value:[]},reducers:{user_function_list:function(e,t){e.value=t.payload}}}),nn=(tn.actions.user_function_list,tn.reducer),rn=Object(qt.b)({stationInfoReducer:Vt,confReducer:Yt,usersReducer:Jt,rolesReducer:Kt,functionsReducer:Zt,currentUserReducer:en,userFunctionReducer:nn,navReducer:h}),an=n(344),on=(an.a.post(b,(function(e,t,n){var r=JSON.stringify(e.body);switch(JSON.parse(r).action){case"remote":return t(n.delay(2e3),n.json({state:"remote drive"}));case"dualshock":return t(n.delay(2e3),n.json({state:"manual drive"}));case"auto":return t(n.delay(2e3),n.json({state:"auto drive",station:"station 111"}));case"shutdown":return t(n.delay(2e3),n.json({state:"shutdown"}));default:return}})),an.a.get("".concat(b,"/stations"),(function(e,t,n){return t(n.delay(2e3),n.json({stations:["station1","station2"]}))})),an.a.get("".concat(b,"/mode"),(function(e,t,n){return t(n.delay(2e3),n.json({mode:"remote"}))})),0),cn=(an.a.get("".concat(b,"/map_creator/dirs"),(function(e,t,n){return t(n.delay(2e3),n.json({dirs:["foo/baar/foo","bar/foo/foo","bar/bar/foo"]}))})),an.a.post("".concat(b,"/map_creator"),(function(e,t,n){var r=Object(e.body);return t(n.delay(2e3),n.json(Object(me.a)({},r)))})),an.a.get("".concat(b,"/map_creator/status"),(function(e,t,n){Object(e.body);return 10===on?(on=0,t(n.delay(2e3),n.json({progress:"complete",map_id:134}))):0===on?(on=1,t(n.delay(2e3),n.json({progress:null}))):(on+=1,t(n.delay(2e3),n.json({progress:on/10*100})))})),n(154)),un=n.n(cn),sn={path:[[500,20],[500,800],[800,800]],mule_data:[{id:1,uid:"dhasdhkhsak",name:"mini1",x:668.75,y:521.75,theta:90,battery_percentage:30},{id:2,uid:"dhasdhdsdkhsak",name:"mini2",x:1337.5,y:1043.5,theta:180,battery_percentage:30}],error_zones:[[750,850],[1100,1100],[1500,400]],obstacle_zones:[[750,1050],[1100,1300],[1500,600]],map_name:"vh",trip_type:"round_trip",maps:{0:{file_name:"webui_map-gf.png",origin:{x:1421,y:1707},scale:{x:56.863616170590845,y:-56.863616170590845},size:{x:2675,y:2087},viewbox:"0 0 2844 2309"},1:{file_name:"webui_map-1f.png",origin:{x:1393,y:863},scale:{x:46.159394157951674,y:-46.159394157951674},size:{x:2848,y:2560},viewbox:"0 0 2848 2560"}},stations:[{id:1,name:"Nursing Station",isStarting:!0,isCharging:!0,x:330,y:330},{id:2,name:"Bed 1",group:"ward A",isCharging:!1,x:1050,y:1050},{id:3,name:"Bed 2",group:"ward A",x:2550,y:660}]};an.a.get("".concat(b,"/map_editor/dirs"),(function(e,t,n){return t(n.delay(2e3),n.json({dirs:[{id:1,name:"IISC"},{id:2,name:"srf"},{id:546,name:"hyundai"},{id:11,name:"qatar"},{id:23,name:"tvs"},{id:5,name:"sf"},{id:8,name:"office"},{id:9,name:"basement"},{id:99,name:"seg"},{id:1,name:"IISC"},{id:2,name:"srf"},{id:546,name:"hyundai"},{id:11,name:"qatar"},{id:23,name:"tvs"},{id:5,name:"sf"},{id:8,name:"office"},{id:9,name:"basement"},{id:99,name:"seg"},{id:1,name:"IISC"},{id:2,name:"srf"},{id:546,name:"hyundai"},{id:11,name:"qatar"},{id:23,name:"tvs"},{id:5,name:"sf"},{id:8,name:"office"},{id:9,name:"basement"},{id:11,name:"qatar"},{id:23,name:"tvs"}]}))})),an.a.post("".concat(b,"/map_editor/upload"),(function(e,t,n){Object(e.body);return t(n.delay(2e3),n.json({message:"upload success"}))})),an.a.post("".concat(b,"/map_editor/:id"),(function(e,t,n){Object(e.body);var r=un.a,a=sn;return t(n.delay(2e3),n.json({webui_map_image:r,webui_map_json:a,waypoints:""}))})),an.a.post("".concat(b,"/login"),(function(e,t,n){Object(e.body);return t(n.delay(2e3),n.json({token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"}))})),an.a.post("".concat(b,"/logout"),(function(e,t,n){return t(n.delay(2e3),n.json({user:"delete"}))})),Object(qt.d)(rn);i.a.render(o.a.createElement(K,null,o.a.createElement(Pt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[158,1,2]]]);
//# sourceMappingURL=main.f45306a9.chunk.js.map